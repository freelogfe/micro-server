(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{432:function(e,t,a){},434:function(e,t,a){"use strict";a.r(t),a.d(t,"RESOURCE_TYPES",function(){return n}),a.d(t,"RESOURCE_STATUS_MAP",function(){return r}),a.d(t,"RESOURCE_STATUS",function(){return i});var s=a(1),n={json:"json",widget:"widget",image:"image",audio:"audio",markdown:"markdown",page_build:"page_build",reveal_slide:"reveal_slide",license:"license",video:"video",catalog:"catalog"},r={unknown:0,unpublished:1,published:2,freeze:3},i=[{desc:s.a.t("config.resource.states[0]"),type:"danger",status:r.unknown},{desc:s.a.t("config.resource.states[1]"),type:"warning",status:r.unpublished},{desc:s.a.t("config.resource.states[2]"),type:"success",status:r.published},{desc:s.a.t("config.resource.states[3]"),type:"danger",status:r.freeze}]},441:function(e,t,a){"use strict";a.r(t),a.d(t,"COMMON_NAME_REGEXP",function(){return s});var s=/^(?!.*(\\|\/|:|\*|\?|"|<|>|\||\s|@|#|\$)).{1,60}$/},443:function(e,t,a){},455:function(e,t,a){"use strict";a.r(t),a.d(t,"CONTRACT_STATUS",function(){return n}),a.d(t,"CONTRACT_STATUS_TIPS",function(){return r}),a.d(t,"CONTRACT_STATUS_COLORS",function(){return i});var s=a(1),n={uncreated:-1,initial:1,running:2,activated:3,userTerminated:4,sysTerminated:5,terminated:6},r={"-1":s.a.t("config.contract.statesTip[0]"),1:s.a.t("config.contract.statesTip[1]"),2:s.a.t("config.contract.statesTip[2]"),3:s.a.t("config.contract.statesTip[3]"),4:s.a.t("config.contract.statesTip[4]"),5:"",6:s.a.t("config.contract.statesTip[6]")},i={"-1":{type:"danger",desc:r[-1]},1:{type:"warning",desc:r[1]},2:{type:"warning",desc:r[2]},3:{type:"info",desc:r[3]},4:{type:"success",desc:r[4]},5:{type:"info",desc:""},6:{type:"info",desc:r[6]}}},456:function(e,t,a){"use strict";var s=a(432);a.n(s).a},459:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fl-pagination"},[a("el-table",e._b({ref:"table",staticStyle:{width:"100%"},attrs:{"empty-text":e.emptyText},on:{"row-click":e.rowClickHandler,"selection-change":e.selectionChangeHandler}},"el-table",e.tableProps,!1),[e._t("list")],2),e._v(" "),0===e.tableProps.data.length?e._t("empty"):e._e(),e._v(" "),e.showFooter?a("div",{staticClass:"fl-pg-ft clearfix"},[e._t("footer"),e._v(" "),a("el-pagination",{staticClass:"fl-pg-info",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],2):e._e()],2)};s._withStripped=!0;var n=a(6),r={name:"fl-pagination",props:{emptyText:{type:String,default:"暂无数据"},pagination:{type:Object,default:function(){return{pageSize:10}}},config:Object,rowClickHandler:{type:Function,default:function(){}},selectionChangeHandler:{type:Function,default:function(e){}},formatHandler:Function,showFooter:{type:Boolean,default:!0}},data:function(){return{total:8,tableProps:{data:[]},currentPage:1,pageSize:parseInt(window.sessionStorage.getItem("".concat(this.$route.fullPath,"_page_size")))||10,loading:!1}},watch:{pagination:{deep:!0,handler:function(){this.reload()}},pageSize:function(){this.reload()}},methods:{loadData:function(){if(!this.pagination.target)throw new Error("need pagination target param");var e={page:this.currentPage,pageSize:this.pageSize};return this.source=n.axios.CancelToken.source(),this.pagination.params&&Object.assign(e,this.pagination.params),this.$axios.get(this.pagination.target,{params:e,cancelToken:this.source.token}).then(function(e){if(e.data){if(0===e.data.ret&&0===e.data.errcode)return e.data.data;throw new Error(e.data.msg)}})},update:function(e){if(e&&e.dataList){this.total=e.totalItem||e.dataList.length;var t="function"==typeof this.formatHandler?this.formatHandler(e.dataList):e.dataList;this.tableProps.data=t}},reload:function(){this.currentPage=1,this.loading&&this.source&&(this.loading=!1,this.source.cancel("cancel")),this.load()},load:function(){var e=this;this.loading||(this.loading=!0,this.loadData().then(this.update.bind(this)).then(function(){e.loading=!1,window.sessionStorage.setItem("".concat(e.$route.fullPath,"_page_size"),e.pageSize)}).catch(function(t){t.message&&"cancel"===t.message||e.$error.showErrorMessage(t),e.loading=!1}))},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e,this.load()}},mounted:function(){Object.assign(this.tableProps,this.config),this.load()}},i=(a(456),a(3)),o=Object(i.a)(r,s,[],!1,null,null,null);o.options.__file="src/components/Pagination/index.vue";t.a=o.exports},495:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fl-search-input-wrap"},[e.showInput?a("el-input",{ref:"input",staticClass:"search-input",style:{width:e.width},attrs:{size:"medium",placeholder:""},on:{blur:e.hideInputHandler},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandler(t)}},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]):a("el-button",{attrs:{type:"text"},on:{click:e.showInputHandler}},[a("i",{staticClass:"el-icon-search"})])],1)};s._withStripped=!0;var n={name:"freelog-search-input",data:function(){return{input:"",showInput:!1}},props:{showInputImmediately:{type:Boolean,default:!1},width:{type:String,default:function(){return"300px"}}},mounted:function(){this.showInput=this.showInputImmediately},methods:{showInputHandler:function(){var e=this;this.showInputImmediately||(this.showInput=!0),this.$nextTick(function(){e.$refs.input.focus()})},hideInputHandler:function(){this.showInputImmediately||(this.showInput=!1)},searchHandler:function(){this.showInputImmediately||(this.showInput=!0),this.$emit("search",this.input)}}},r=(a(497),a(3)),i=Object(r.a)(n,s,[],!1,null,"78583505",null);i.options.__file="src/components/SearchInput/index.vue";t.a=i.exports},497:function(e,t,a){"use strict";var s=a(443);a.n(s).a},547:function(e,t,a){},548:function(e,t,a){},549:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"createBtnText":"创建资源","createNewReleaseText":"创建新发行","list":{"name":"资源名称","type":"资源类型","allTypes":"全部类型","history":"历史发行","status":"发行情况","updateDate":"更新时间","createDate":"创建时间","operate":"操作","querying":"查询中...","noReleases":"暂无发行","releaseBtnText":"发行","editBtnText":"编辑","downloadBtnText":"下载源文件","releasesCount":["等","个发行..."],"messages":["没有符合条件的资源","您还没有创建任何资源。"],"releaseStatus":["未发行","已发行","全部"]}},"en":{"createBtnText":"Create Resource","createNewReleaseText":"Create a New Release","list":{"name":"Resource name","type":"Resource type","allTypes":"All types","history":"Release history","status":"Release status","updateDate":"Update date","createDate":"Create date","operate":"Operate","querying":"Querying...","noReleases":"No releases","releaseBtnText":"Release","editBtnText":"Edit","downloadBtnText":"Download resource file","releasesCount":["There are "," releases..."],"messages":["There are no resources available","You have not created any resources."],"releaseStatus":["Not release","Relased","All"]}}}'),delete e.options._Ctor}},550:function(e,t,a){},551:function(e,t,a){},552:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"createBtnText":"创建资源","createNewReleaseText":"创建新发行","list":{"name":"资源名称","type":"资源类型","allTypes":"全部类型","history":"历史发行","status":"发行情况","updateDate":"更新时间","createDate":"创建时间","operate":"操作","querying":"查询中...","noReleases":"暂无发行","releaseBtnText":"发行","editBtnText":"编辑","downloadBtnText":"下载源文件","releasesCount":["等","个发行..."],"messages":["没有符合条件的资源","您还没有创建任何资源。"],"releaseStatus":["未发行","已发行","全部"]}},"en":{"createBtnText":"Create Resource","createNewReleaseText":"Create a New Release","list":{"name":"Resource name","type":"Resource type","allTypes":"All types","history":"Release history","status":"Release status","updateDate":"Update date","createDate":"Create date","operate":"Operate","querying":"Querying...","noReleases":"No releases","releaseBtnText":"Release","editBtnText":"Edit","downloadBtnText":"Download resource file","releasesCount":["There are "," releases..."],"messages":["There are no resources available","You have not created any resources."],"releaseStatus":["Not release","Relased","All"]}}}'),delete e.options._Ctor}},721:function(e,t,a){"use strict";var s={};a.r(s),a.d(s,"PRESENTABLE_STATUS_TIPS",function(){return u}),a.d(s,"default",function(){return d});var n={};a.r(n),a.d(n,"USER_GROUP_TYPE",function(){return p}),a.d(n,"NODE_GROUP_TYPE",function(){return f}),a.d(n,"GROUP_TYPES",function(){return h});var r=a(86),i=a.n(r),o=a(455),l=a(434),c=a(1),u=[{text:c.a.t("config.presentable.states[0]"),type:"info"},{text:c.a.t("config.presentable.states[1]"),type:"danger"},{text:c.a.t("config.presentable.states[2]"),type:"danger"},{text:c.a.t("config.presentable.states[3]"),type:"success"},{text:c.a.t("config.presentable.states[4]"),type:"info"},{text:c.a.t("config.presentable.states[5]"),type:"info"}],d=u,p=1,f=2,h=[{value:p,label:c.a.t("config.group.user")},{value:f,label:c.a.t("config.group.node")}],g=a(441);t.a=i()({},o,l,s,n,g)},811:function(e,t,a){"use strict";var s=a(547);a.n(s).a},812:function(e,t,a){"use strict";var s=a(548);a.n(s).a},813:function(e,t,a){"use strict";var s=a(549),n=a.n(s);t.default=n.a},814:function(e,t,a){"use strict";var s=a(550);a.n(s).a},815:function(e,t,a){"use strict";var s=a(551);a.n(s).a},816:function(e,t,a){"use strict";var s=a(552),n=a.n(s);t.default=n.a},953:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"my-resources"},[a("div",{staticClass:"m-r-header clearfix"},[a("router-link",{attrs:{to:"/resource/editor"}},[a("el-button",{staticClass:"m-r-create-btn",attrs:{size:"medium",type:"primary"}},[e._v(e._s(e.$t("createBtnText")))])],1),e._v(" "),a("div",{staticClass:"right-tool-bar-wrap"},[a("search-input",{attrs:{showInputImmediately:""},on:{search:e.searchHandler}})],1)],1),e._v(" "),a("resource-items-list",{attrs:{query:e.queryInput},on:{release:e.showReleaseDialog}}),e._v(" "),a("el-dialog",{attrs:{width:"750px",top:"10vh",center:"",visible:e.isShowReleaseSearchDialog},on:{"update:visible":function(t){e.isShowReleaseSearchDialog=t}}},[a("release-search",{attrs:{"release-source":e.targetReleaseResource,tabLayout:["my-release"],historicalReleases:e.targetReleaseResource?e.targetReleaseResource.releaseList:[]},on:{add:e.releaseSearchHandler}}),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"create-release-btn",attrs:{round:"",type:"primary"},on:{click:e.createNewRelease}},[e._v(e._s(e.$t("createNewReleaseText")))])],1)],1)],1)};s._withStripped=!0;var n=a(495),r=a(721),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resource-list"},[a("f-pagination",{ref:"listRef",staticClass:"resource-list-table",attrs:{config:e.tableConfig,formatHandler:e.formatHandler,pagination:e.paginationConfig,"empty-text":e.pagenationEmptyText}},[a("template",{slot:"list"},[a("el-table-column",{attrs:{label:e.$t("list.name")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"r-l-item-name-box"},[a("img",{staticClass:"r-l-item__img",class:{"resource-default-preview":!e.previewImage},attrs:{src:t.row.previewImage}}),e._v(" "),a("div",{staticClass:"r-l-item-name",attrs:{title:t.row.aliasName}},[e._v(e._s(t.row.aliasName))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("list.type"),width:"176"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-dropdown",{staticClass:"r-l-types-select",on:{command:e.handleSelectType}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n              "+e._s(e.$t("list.type"))+" "+e._s(e._f("pageBuildFilter")("all"===e.selectedType?"":""+e.selectedType))),a("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.resourceTypes,function(t){return a("el-dropdown-item",{key:t.value,attrs:{command:t.value}},[e._v(e._s(e._f("pageBuildFilter")(t.label)))])}),1)],1)]}},{key:"default",fn:function(t){return[a("div",{staticClass:"r-l-item-type"},[e._v(" "+e._s(e._f("pageBuildFilter")(t.row.resourceType)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("list.history"),width:"200"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-dropdown",{staticClass:"r-l-types-select",on:{command:e.handleSelectReleaseStatus}},[a("span",{staticClass:"el-dropdown-link"},[e._v("\n              "+e._s(e.$t("list.history"))+" "+e._s(e.releaseStatus[e.selectedReleaseStatus].label)),a("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.releaseStatus,function(t){return a("el-dropdown-item",{key:t.value,attrs:{command:t.value}},[e._v(e._s(t.label))])}),1)],1)]}},{key:"default",fn:function(t){return[a("div",{staticClass:"r-l-item-no-release"},[e._v("\n            "+e._s("fetching"===t.row.releaseStatus?e.$t("list.querying"):t.row.releaseList.length?"":e.$t("list.noReleases"))+"\n          ")]),e._v(" "),t.row.releaseList.length?a("div",{staticStyle:{position:"relative"}},[a("div",{staticClass:"r-l-item-release-row1",on:{click:function(a){return e.goToReleaseDetail(t.row.releaseList[0])}}},[e._v(e._s(t.row.releaseList[0].releaseName))]),e._v(" "),t.row.releaseList.length>1?[a("el-popover",{attrs:{placement:"bottom-start",width:"370",trigger:"hover"}},[a("div",{staticClass:"r-l-item-release-row2",attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(e.$t("list.releasesCount[0]"))+e._s(t.row.releaseList.length)+e._s(e.$t("list.releasesCount[1]")))]),e._v(" "),a("div",{staticClass:"r-l-item-release-floatbox"},e._l(t.row.releaseList,function(t,s){return a("div",{key:"r"+s,staticClass:"release-item"},[a("span",{staticClass:"name",on:{click:function(a){return e.goToReleaseDetail(t)}}},[e._v(e._s(t.releaseName))]),e._v(" "),a("span",{staticClass:"version"},[e._v(e._s(t.resourceVersion.version))]),e._v(" "),a("span",{staticClass:"date"},[e._v(e._s(e._f("fmtDate")(t.resourceVersion.createDate)))])])}),0)])]:e._e()],2):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"updateDate",label:e.$t("list.updateDate"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"r-l-item-updateDate"},[e._v(e._s(e._f("fmtDate")(t.row.updateDate)))]),e._v(" "),a("div",{staticClass:"r-l-item-createDate"},[e._v(e._s(e.$t("list.createDate"))+" "+e._s(e._f("fmtDate")(t.row.createDate)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("list.operate"),width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"r-l-item-release-btn",attrs:{size:"mini"},on:{click:function(a){return e.tapRelease(t.row)}}},[e._v(e._s(e.$t("list.releaseBtnText")))]),e._v(" "),a("router-link",{attrs:{to:t.row._toDetailLink}},[a("el-button",{staticClass:"r-l-item-detail-btn",attrs:{size:"mini"}},[e._v(e._s(e.$t("list.editBtnText")))])],1),e._v(" "),a("a",{attrs:{href:t.row._downloadLink,download:t.row.aliasName}},[a("el-button",{staticClass:"r-l-item-download-btn",attrs:{size:"mini"}},[e._v(e._s(e.$t("list.downloadBtnText")))])],1)]}}])})],1)],2)],1)};i._withStripped=!0;var o=a(87),l=a.n(o),c=a(459),u=a(434),d={name:"resource-items-list",components:{FPagination:c.a},props:{query:String},data:function(){var e=this.$i18n.t("list.messages[1]"),t=this.$i18n,a=this.$route.query.resourceType;return{search:"",loader:null,tableConfig:{rowClassName:"resource-row","cell-class-name":"rel-row-cell","show-header":!0},paginationConfig:{target:"/v1/resources",params:{isSelf:1,resourceType:null!=a?a:void 0,keywords:void 0,isReleased:2}},resourceMapReleases:{},selectedType:null!=a?a:"all",releaseStatus:[{label:t.t("list.releaseStatus[0]"),value:0},{label:t.t("list.releaseStatus[1]"),value:1},{label:t.t("list.releaseStatus[2]"),value:2}],selectedReleaseStatus:2,pagenationEmptyText:e}},computed:{resourceTypes:function(){for(var e=[{label:this.$i18n.t("list.allTypes"),value:"all"}],t=0,a=Object.entries(u.RESOURCE_TYPES);t<a.length;t++){var s=l()(a[t],2),n=s[0],r=s[1];e.push({label:n,value:r})}return e}},watch:{query:function(){var e=[this.$i18n.t("list.messages[0]"),this.$i18n.t("list.messages[1]")],t=e[0],a=e[1];""==this.query?(this.paginationConfig.params.keywords=void 0,this.pagenationEmptyText=a):(this.paginationConfig.params.keywords=this.query,this.pagenationEmptyText=t)},selectedReleaseStatus:function(){this.paginationConfig.params.isReleased=this.selectedReleaseStatus}},mounted:function(){},methods:{formatHandler:function(e){var t=this;return e&&e.length?((e=e.map(function(e){var a=e.resourceId,s=e.previewImages;return e._toDetailLink=a?"/resource/editor/".concat(a):"",e._downloadLink="".concat(window.FreelogApp.Env.qiOrigin,"/v1/resources/").concat(a,"/download"),e.previewImage=s&&s[0]||"",e.releaseStatus="fetching",e.releaseList=[],t.fetchReleaseList(a).then(function(){e.releaseStatus="done",e.releaseList=t.resourceMapReleases[e.resourceId]}),e})).sort(function(e,t){return+new Date(t.updateDate)-+new Date(e.updateDate)}),e):[]},batchFetchReleaseList:function(e){for(var t=[],a=0;a<e.length;a++){var s=e[a].resourceId;this.resourceMapReleases[s]||t.push(this.fetchReleaseList(s))}return Promise.all(t)},fetchReleaseList:function(e){var t=this;return this.resourceMapReleases[e]?Promise.resolve(this.resourceMapReleases[e]):this.$services.ResourceService.get("".concat(e,"/releases")).then(function(e){return e.data}).then(function(a){0===a.errcode&&(t.resourceMapReleases[e]=a.data)})},tapRelease:function(e){this.$emit("release",e)},goToReleaseDetail:function(e){e.releaseId&&this.$router.push("/release/detail/".concat(e.releaseId,"?version=").concat(e.resourceVersion.version))},handleSelectType:function(e){this.selectedType=e,this.$router.push({query:{resourceType:e}}),"all"===this.selectedType?this.paginationConfig.params.resourceType=void 0:this.paginationConfig.params.resourceType=this.selectedType},handleSelectReleaseStatus:function(e){this.selectedReleaseStatus=e,this.paginationConfig.params.isReleased=this.selectedReleaseStatus}}},p=(a(811),a(812),a(3)),f=a(813),h=Object(p.a)(d,i,[],!1,null,"74c18f48",null);"function"==typeof f.default&&Object(f.default)(h),h.options.__file="src/views/resource/list/list.vue";var g=h.exports,m=a(493),_=r.a.RESOURCE_STATUS,v={name:"resource-list",data:function(){return{resourceList:[],RESOURCE_STATUS:_,queryInput:"",isShowReleaseSearchDialog:!1,targetReleaseResource:null}},components:{ResourceItemsList:g,SearchInput:n.a,ReleaseSearch:m.a},mounted:function(){},methods:{searchHandler:function(e){this.queryInput=e},showReleaseDialog:function(e){this.isShowReleaseSearchDialog=!0,this.targetReleaseResource=e},releaseSearchHandler:function(e){this.$router.push("/release/add?releaseId=".concat(e.releaseId,"&resourceId=").concat(this.targetReleaseResource.resourceId))},createNewRelease:function(){this.$router.push("/release/create?resourceId=".concat(this.targetReleaseResource.resourceId))}}},w=(a(814),a(815),a(816)),y=Object(p.a)(v,s,[],!1,null,"3ee4d998",null);"function"==typeof w.default&&Object(w.default)(y),y.options.__file="src/views/resource/list/index.vue";t.default=y.exports}}]);