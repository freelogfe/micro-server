(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{430:function(e,t,s){},434:function(e,t,s){"use strict";s.r(t),s.d(t,"RESOURCE_TYPES",function(){return a}),s.d(t,"RESOURCE_STATUS_MAP",function(){return n}),s.d(t,"RESOURCE_STATUS",function(){return r});var i=s(1),a={json:"json",widget:"widget",image:"image",audio:"audio",markdown:"markdown",page_build:"page_build",reveal_slide:"reveal_slide",license:"license",video:"video",catalog:"catalog"},n={unknown:0,unpublished:1,published:2,freeze:3},r=[{desc:i.a.t("config.resource.states[0]"),type:"danger",status:n.unknown},{desc:i.a.t("config.resource.states[1]"),type:"warning",status:n.unpublished},{desc:i.a.t("config.resource.states[2]"),type:"success",status:n.published},{desc:i.a.t("config.resource.states[3]"),type:"danger",status:n.freeze}]},442:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"listView",staticClass:"fl-lazy-list-view"},[e.previewList.length?s("ul",{style:{paddingTop:e.lineTopHeight+"px",paddingBottom:e.lineBottomHeight+"px"}},[e._l(e.previewList,function(t,i){return s("li",{key:i,staticClass:"show-up",class:[e.itemClass]},[e._t("default",null,{data:t})],2)}),e._v(" "),e._t("append")],2):e._e(),e._v(" "),e.isLoading||0!==e.previewList.length?e._e():e._t("empty",[s("div",{staticStyle:{"font-size":"20px","text-align":"center"}},[e._v(e._s(e.$t("components.lazyListView.noContentTip")))])]),e._v(" "),e._t("loading",[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading>0,expression:"isLoading > 0"}],ref:"loading",staticClass:"load-more-gif",attrs:{"element-loading-text":e.$t("components.lazyListView.loadingTip"),"element-loading-background":"rgba(0,0,0,0)"}})])],2)};i._withStripped=!0;var a=s(444),n=s.n(a),r=window.innerHeight||document.documentElement.clientHeight;function o(e,t){var s,i,a,n=e.getBoundingClientRect(),o={top:0,left:0,bottom:r,right:window.innerWidth||document.documentElement.clientWidth};return t&&(o.top-=t.top||0,o.left-=t.left||0,o.bottom+=t.bottom||0,o.right+=t.right||0),s=n,i=o,(a={}).top=Math.max(s.top,i.top),a.bottom=Math.min(s.bottom,i.bottom),a.left=Math.max(s.left,i.left),a.right=Math.min(s.right,i.right),a.bottom>=a.top&&a.right>=a.left}var c={name:"fl-lazy-list-view",props:{list:{type:Array,required:!0,default:[],twoWays:!0},itemClass:{type:String,default:""},fetch:{type:Function}},data:function(){return{lastScrollTop:null,lineTopHeight:0,lineBottomHeight:0,previewList:[],displayCount:0,canLoadMore:!0,index:1,isLoading:0}},mounted:function(){this.initView(),this.$on("reload",this.refresh.bind(this))},beforeDestroy:function(){this.disconnect()},methods:{initView:function(){var e=this,t=this.$refs.loading,s=parseInt(r,10);this.reset();var i=function(){t.classList.add("hide")};this.observer=n()(t,{loaded:function(a){if(!1===e.canLoadMore)return i();var n=o(t,{bottom:s}),r=function(){e.isLoading+=1,e.load().then(function(){e.isLoading-=1,!1===e.canLoadMore?i():(a.dataset.loaded=!1,e.observer.observe(a))}).catch(function(t){console.log(t),e.isLoading-=1,i()})};n?r():e.canLoadMore&&e.index<2&&r()},rootMargin:"".concat(s,"px ").concat(s,"px"),threshold:.1}),this.observer.observe()},load:function(){var e=this,t=e.index;return e.index+=1,e.fetch(t).then(function(t){if(e.canLoadMore=t.canLoadMore,e.scrollHandler(t.dataList||[]),!1===e.canLoadMore)return Promise.reject()})},disconnect:function(){var e=this.observer&&this.observer.observer;e&&e.disconnect&&e.disconnect()},reset:function(){var e=this.$refs.loading;this.canLoadMore=!0,this.previewList=[],this.index=1,this.isLoading=0,e.classList.remove("hide"),e.dataset.loaded=!1},refresh:function(){var e=this.$refs.loading;this.reset(),this.observer.observe(e),this.observer.triggerLoad(e)},scrollHandler:function(e){this.previewList=this.previewList.concat(e)}},components:{}},l=(s(445),s(3)),u=Object(l.a)(c,i,[],!1,null,"f929dc2c",null);u.options.__file="src/components/LazyListView/index.vue";t.a=u.exports},445:function(e,t,s){"use strict";var i=s(430);s.n(i).a},536:function(e,t,s){},537:function(e,t,s){},538:function(e,t,s){},539:function(e,t,s){},799:function(e,t,s){"use strict";var i=s(536);s.n(i).a},800:function(e,t,s){"use strict";var i=s(537);s.n(i).a},801:function(e,t,s){"use strict";var i=s(538);s.n(i).a},805:function(e,t,s){"use strict";var i=s(539);s.n(i).a},949:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"index-main-container"},[s("div",{staticClass:"main-content-wrap"},[s("lazy-list-view",{ref:"resourceList",staticClass:"resource-list",attrs:{itemClass:"resource-list-item",list:e.resourceList,height:275,fetch:e.fetchReleaseData},scopedSlots:e._u([{key:"default",fn:function(e){return[s("list-item",{attrs:{release:e.data}})]}}])},[e._v(" "),s("template",{slot:"append"},[s("div",{staticClass:"res-placeholder-item"}),e._v(" "),s("div",{staticClass:"res-placeholder-item"}),e._v(" "),s("div",{staticClass:"res-placeholder-item"}),e._v(" "),s("div",{staticClass:"res-placeholder-item"}),e._v(" "),s("div",{staticClass:"res-placeholder-item"}),e._v(" "),s("div",{staticClass:"res-placeholder-item"})])],2)],1)])};i._withStripped=!0;var a=s(132),n=s.n(a),r=s(442),o=s(149),c=s.n(o),l=s(763),u=s.n(l),d=s(37),h={},p={};function f(e){var t=[];return e.resourceIds&&e.resourceIds.length&&(e.resourceIds.forEach(function(e){t.push(e),h[e]||(h[e]=[])}),e.resourceIds=t.join(",")),e.authSchemeIds&&e.authSchemeIds.length&&(e.authSchemeIds=e.authSchemeIds.join(",")),d.a.get("/v1/resources/authSchemes",{params:e}).then(function(s){if(0===s.data.errcode){var i=s.getData();return i.forEach(function(t){p[t.authSchemeId]||(p[t.authSchemeId]=t),e.resourceIds&&h[t.resourceId].push(t)}),t.length&&t.forEach(function(e){h[e]=u()(h[e],"authSchemeId")}),c()(i)}return Promise.reject(s.data.msg)})}function m(e,t){return(t=t||{}).resourceIds=[e],function(e){return f(e)}(t)}var v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main-resource-item-wrap",on:{click:e.gotoDetail}},[s("div",{staticClass:"res-poster-wrap"},[s("img",{class:{"resource-default-preview":!e.postImgUrl},attrs:{src:e._f("padImage")(e.postImgUrl),alt:""}})]),e._v(" "),s("div",{staticClass:"res-digest-info"},[s("p",{staticClass:"res-name"},[e._v(e._s(e.release.releaseName))]),e._v(" "),s("p",{staticClass:"res-author-name"},[s("span",[e._v(e._s(e._f("pageBuildFilter")(e.release.resourceType)))]),e._v(e._s(e.release.username)+"\n    ")])]),e._v(" "),e.schemes.length?s("ul",{staticClass:"res-policies-list"},e._l(e.schemes,function(t){return s("li",{key:t.authSchemeId,staticClass:"res-p-item",class:e.resSchemeStatusCls(t)},[e._v("\n      "+e._s(t.authSchemeName[0])+"\n      "),s("div",{staticClass:"res-scheme-info-wrap"},[s("h4",[e._v(e._s(t.authSchemeName))]),e._v(" "),s("div",{staticClass:"res-scheme-item"},[s("p",[e._v(e._s(e.$t("policy.authTarget"))+"：")]),e._v(" "),s("ul",{staticClass:"res-scheme-item res-scheme-auth-targets"},e._l(t.targets,function(t,i){return s("li",{key:i},[e._v(e._s(t))])}),0)]),e._v(" "),s("div",{staticClass:"res-scheme-item"},[s("p",[e._v(e._s(e.$t("release.throwUp"))+"：")]),e._v(" "),s("div",[s("i",{staticClass:"res-scheme-status-icon"}),e._v(e._s(t.isBubbled?e.$t("common.yes"):e.$t("common.no")))])])])])}),0):e._e()])};v._withStripped=!0;var g=s(434),_={name:"main-list-resource-item",data:function(){return{schemes:[]}},props:{release:{type:Object,default:function(){return{}}},type:{type:String,default:"list"}},computed:{postImgUrl:function(){return this.release.previewImages.length?this.release.previewImages[0]:""}},mounted:function(){this.format(this.resource)},methods:{resSchemeStatusCls:function(e){return e.bubbleResources.length?"status-1":"status-0"},format:function(e){var t=this;this.release.resourceId&&(e._statusInfo=g.RESOURCE_STATUS[e.status],e.schemes?this.schemes=e.schemes.map(this.resolveScheme):m(e.resourceId).then(function(e){t.schemes=e.map(t.resolveScheme)}))},resolveScheme:function(e){var t=new Set;return e.policy.forEach(function(e){e.authorizedObjects.forEach(function(e){e.users.forEach(function(e){t.add(e)})})}),e.targets=Array.from(t),e.isBubbled=e.bubbleResources.length>0,e},gotoDetail:function(){this.$router.push("/release/detail/".concat(this.release.releaseId,"?version=").concat(this.release.latestVersion.version))}}},w=(s(799),s(3)),y=Object(w.a)(_,v,[],!1,null,"ac2be36a",null);y.options.__file="src/views/main/release.vue";var S={name:"index-main-view",data:function(){return{resourceList:[],query:""}},components:{ListItem:y.exports,LazyListView:r.a},watch:{"$route.query":function(){this.query=this.$route.query.q||"",this.queryHandler()}},mounted:function(){var e=this.$route.query;e.q&&(this.query=e.q)},methods:{autoQueryHandler:function(){var e=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){e.queryHandler()},800)},queryHandler:function(){this.timer&&clearTimeout(this.timer),this.$refs.resourceList.$emit("reload",{keywords:encodeURIComponent(this.query)})},fetchReleaseData:function(e){var t={page:e,pageSize:30};return this.query&&(t.keywords=this.query),this.loader(t).then(function(e){e.canLoadMore=!(e.dataList<e.pageSize),e.dataList=e.dataList.filter(function(e){return e.policies.length>0&&1===e.status});var t=e.dataList;if(t&&t.length){var s={};t.map(function(e){return s[e.resourceId]=e,e.resourceId})}return e})},loader:function(e){return"object"===n()(e)&&(e.keywords&&(this.query=e.keywords),e={params:e}),this.$services.ReleaseService.get(e||{}).then(function(e){return e.getData()})}}},b=(s(800),s(801),Object(w.a)(S,i,[],!1,null,"567ae6d4",null));b.options.__file="src/views/main/index.vue";t.default=b.exports},951:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{display:"flex","justify-content":"center"}},[t("div",{staticStyle:{padding:"0 50px",display:"flex","justify-content":"center","flex-wrap":"wrap","padding-top":"20px"}},[this._l(this.sourceData,function(e){return t("Card",{attrs:{imgSrc:e.previewImages[0],title:e.releaseName,user:e.username,type:e.resourceType}})}),this._v(" "),this.dataEnd?this._e():t("div",{directives:[{name:"loading",rawName:"v-loading",value:!0,expression:"true"}],ref:"loadingRef",staticStyle:{width:"220px",height:"234px",background:"#fff",margin:"0 10px 20px"}}),this._v(" "),this._l(Array(20),function(e){return t("div",{staticStyle:{width:"220px",margin:"0 10px"}})})],2)])};i._withStripped=!0;var a=s(428),n=s.n(a),r=s(427),o=s.n(r),c=s(429),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wrapItem",staticStyle:{width:"220px",background:"#fff",margin:"0 10px 20px",cursor:"pointer"},on:{click:function(t){return e.$emit("click")}}},[s("img",{staticStyle:{display:"block",width:"100%",height:"165px"},attrs:{src:e.imgSrc}}),e._v(" "),s("div",{staticStyle:{padding:"10px"}},[s("div",{staticClass:"ellipsis",staticStyle:{color:"#222","font-size":"14px"}},[e._v(e._s(e.title)+"\n        ")]),e._v(" "),s("div",{staticStyle:{height:"10px"}}),e._v(" "),s("div",{staticStyle:{color:"#333",display:"flex","justify-content":"space-between","font-size":"12px"}},[s("span",{staticClass:"ellipsis",staticStyle:{display:"inline-block",width:"45%"}},[e._v(e._s(e.user))]),e._v(" "),s("span",{staticClass:"ellipsis",staticStyle:{display:"inline-block",width:"45%","text-align":"right"}},[e._v(e._s(e.type))])])])])};l._withStripped=!0;var u={name:"Card",props:{imgSrc:{type:String,default:void 0},title:{type:String,default:""},user:{type:String,default:""},type:{type:String,default:""}}},d=(s(805),s(3)),h=Object(d.a)(u,l,[],!1,null,"3a9f0779",null);h.options.__file="src/views/market/Card.vue";var p={name:"index",components:{Card:h.exports},data:function(){return{page:1,sourceData:[],dataEnd:!1,isLoading:!1}},mounted:function(){window.onscroll=this.loadingControl,this.loadingControl()},methods:{handleData:function(){var e=this;return Object(c.coroutine)(n.a.mark(function t(){var s,i;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/v1/releases",{params:{page:e.page,pageSize:3}});case 2:s=t.sent,i=s.data.data,console.log(s,"resresres"),e.sourceData=[].concat(o()(e.sourceData),o()(i.dataList)),e.dataEnd=i.page*i.pageSize>=i.totalItem;case 7:case"end":return t.stop()}},t)}))()},loadingControl:function(){var e=this;return Object(c.coroutine)(n.a.mark(function t(){var s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isLoading){t.next=2;break}return t.abrupt("return");case 2:s=e.$refs.loadingRef.getBoundingClientRect().top;case 3:if(!(s<window.innerHeight)||e.dataEnd){t.next=11;break}return e.isLoading=!0,e.page++,t.next=8,e.handleData();case 8:s=e.$refs.loadingRef.getBoundingClientRect().top,t.next=3;break;case 11:e.isLoading=!1;case 12:case"end":return t.stop()}},t)}))()}}},f=Object(d.a)(p,i,[],!1,null,"fa2d4a4e",null);f.options.__file="src/views/market/index.vue";t.default=f.exports}}]);