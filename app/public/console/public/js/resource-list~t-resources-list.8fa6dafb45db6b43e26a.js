(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{430:function(e,t,a){},443:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"listView",staticClass:"fl-lazy-list-view"},[e.previewList.length?a("ul",{style:{paddingTop:e.lineTopHeight+"px",paddingBottom:e.lineBottomHeight+"px"}},[e._l(e.previewList,function(t,r){return a("li",{key:r,staticClass:"show-up",class:[e.itemClass]},[e._t("default",null,{data:t})],2)}),e._v(" "),e._t("append")],2):e._e(),e._v(" "),e.isLoading||0!==e.previewList.length?e._e():e._t("empty",[a("div",{staticStyle:{"font-size":"20px","text-align":"center"}},[e._v(e._s(e.$t("components.lazyListView.noContentTip")))])]),e._v(" "),e._t("loading",[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading>0,expression:"isLoading > 0"}],ref:"loading",staticClass:"load-more-gif",attrs:{"element-loading-text":e.$t("components.lazyListView.loadingTip"),"element-loading-background":"rgba(0,0,0,0)"}})])],2)};r._withStripped=!0;var s=a(444),n=a.n(s),i=window.innerHeight||document.documentElement.clientHeight;function o(e,t){var a,r,s,n=e.getBoundingClientRect(),o={top:0,left:0,bottom:i,right:window.innerWidth||document.documentElement.clientWidth};return t&&(o.top-=t.top||0,o.left-=t.left||0,o.bottom+=t.bottom||0,o.right+=t.right||0),a=n,r=o,(s={}).top=Math.max(a.top,r.top),s.bottom=Math.min(a.bottom,r.bottom),s.left=Math.max(a.left,r.left),s.right=Math.min(a.right,r.right),s.bottom>=s.top&&s.right>=s.left}var c={name:"fl-lazy-list-view",props:{list:{type:Array,required:!0,default:[],twoWays:!0},itemClass:{type:String,default:""},fetch:{type:Function}},data:function(){return{lastScrollTop:null,lineTopHeight:0,lineBottomHeight:0,previewList:[],displayCount:0,canLoadMore:!0,index:1,isLoading:0}},mounted:function(){this.initView(),this.$on("reload",this.refresh.bind(this))},beforeDestroy:function(){this.disconnect()},methods:{initView:function(){var e=this,t=this.$refs.loading,a=parseInt(i,10);this.reset();var r=function(){t.classList.add("hide")};this.observer=n()(t,{loaded:function(s){if(!1===e.canLoadMore)return r();var n=o(t,{bottom:a}),i=function(){e.isLoading+=1,e.load().then(function(){e.isLoading-=1,!1===e.canLoadMore?r():(s.dataset.loaded=!1,e.observer.observe(s))}).catch(function(t){console.log(t),e.isLoading-=1,r()})};n?i():e.canLoadMore&&e.index<2&&i()},rootMargin:"".concat(a,"px ").concat(a,"px"),threshold:.1}),this.observer.observe()},load:function(){var e=this,t=e.index;return e.index+=1,e.fetch(t).then(function(t){if(e.canLoadMore=t.canLoadMore,e.scrollHandler(t.dataList||[]),!1===e.canLoadMore)return Promise.reject()})},disconnect:function(){var e=this.observer&&this.observer.observer;e&&e.disconnect&&e.disconnect()},reset:function(){var e=this.$refs.loading;this.canLoadMore=!0,this.previewList=[],this.index=1,this.isLoading=0,e.classList.remove("hide"),e.dataset.loaded=!1},refresh:function(){var e=this.$refs.loading;this.reset(),this.observer.observe(e),this.observer.triggerLoad(e)},scrollHandler:function(e){this.previewList=this.previewList.concat(e)}},components:{}},l=(a(445),a(3)),d=Object(l.a)(c,r,[],!1,null,"f929dc2c",null);d.options.__file="src/components/LazyListView/index.vue";t.a=d.exports},444:function(e,t,a){
/*! lozad.js - v1.9.0 - 2019-02-09
* https://github.com/ApoorvSaxena/lozad.js
* Copyright (c) 2019 Apoorv Saxena; Licensed MIT */
e.exports=function(){"use strict";var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},t="undefined"!=typeof document&&document.documentMode,a={rootMargin:"0px",threshold:0,load:function(e){if("picture"===e.nodeName.toLowerCase()){var a=document.createElement("img");t&&e.getAttribute("data-iesrc")&&(a.src=e.getAttribute("data-iesrc")),e.getAttribute("data-alt")&&(a.alt=e.getAttribute("data-alt")),e.appendChild(a)}if("video"===e.nodeName.toLowerCase()&&!e.getAttribute("data-src")&&e.children){for(var r=e.children,s=void 0,n=0;n<=r.length-1;n++)(s=r[n].getAttribute("data-src"))&&(r[n].src=s);e.load()}e.getAttribute("data-src")&&(e.src=e.getAttribute("data-src")),e.getAttribute("data-srcset")&&e.setAttribute("srcset",e.getAttribute("data-srcset")),e.getAttribute("data-background-image")&&(e.style.backgroundImage="url('"+e.getAttribute("data-background-image")+"')"),e.getAttribute("data-toggle-class")&&e.classList.toggle(e.getAttribute("data-toggle-class"))},loaded:function(){}};function r(e){e.setAttribute("data-loaded",!0)}var s=function(e){return"true"===e.getAttribute("data-loaded")};return function(){var t,n,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c=e({},a,o),l=c.root,d=c.rootMargin,u=c.threshold,h=c.load,f=c.loaded,p=void 0;return window.IntersectionObserver&&(p=new IntersectionObserver((t=h,n=f,function(e,a){e.forEach(function(e){(0<e.intersectionRatio||e.isIntersecting)&&(a.unobserve(e.target),s(e.target)||(t(e.target),r(e.target),n(e.target)))})}),{root:l,rootMargin:d,threshold:u})),{observe:function(){for(var e=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return e instanceof Element?[e]:e instanceof NodeList?e:t.querySelectorAll(e)}(i,l),t=0;t<e.length;t++)s(e[t])||(p?p.observe(e[t]):(h(e[t]),r(e[t]),f(e[t])))},triggerLoad:function(e){s(e)||(h(e),r(e),f(e))},observer:p}}}()},445:function(e,t,a){"use strict";var r=a(430);a.n(r).a},447:function(e,t,a){},448:function(e,t,a){},490:function(e,t,a){"use strict";t.decode=t.parse=a(501),t.encode=t.stringify=a(502)},496:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"releases-search-wrapper"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[-1!==e.tabLayout.indexOf("search")?a("el-tab-pane",{attrs:{label:e.$t("search.searchTitle"),name:"search"}},[a("div",{staticClass:"search-input-area"},[a("el-input",{ref:"searchInputRef",staticClass:"search-release-input",attrs:{clearable:"",placeholder:e.$t("search.placeholder")},on:{clear:e.clearSearchInputHandler},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandler(t)}},model:{value:e.searchInput,callback:function(t){e.searchInput=t},expression:"searchInput"}})],1),e._v(" "),a("lazy-list-view",{ref:"searchView",staticClass:"search-release-list",attrs:{list:e.searchReleases,height:60,fetch:e.searchDataHandler},scopedSlots:e._u([{key:"default",fn:function(t){return[a("release-item",{attrs:{type:"search",historicalReleaseIds:e.historicalReleaseIds,release:t.data},on:{add:e.addToReleaseHandler}})]}}],null,!1,2459864818)})],1):e._e(),e._v(" "),-1!==e.tabLayout.indexOf("my-release")?a("el-tab-pane",{attrs:{label:e.$t("search.myRelease"),name:"my-release"}},[a("lazy-list-view",{staticClass:"search-release-list",attrs:{list:e.myReleases,height:60,fetch:e.fetchMyData},scopedSlots:e._u([{key:"default",fn:function(t){return[a("release-item",{attrs:{type:"search",historicalReleaseIds:e.historicalReleaseIds,release:t.data},on:{add:e.addToReleaseHandler}})]}}],null,!1,2459864818)},[e._v(" "),a("div",{staticClass:"no-release-items",attrs:{slot:"empty"},slot:"empty"},[e._v("暂无相同类型发行")])])],1):e._e(),e._v(" "),-1!==e.tabLayout.indexOf("favor")?a("el-tab-pane",{attrs:{label:e.$t("search.favorTitle"),name:"favor"}},[a("lazy-list-view",{staticClass:"search-release-list",attrs:{list:e.favorReleases,height:60,fetch:e.fetchFavorData},scopedSlots:e._u([{key:"default",fn:function(t){return[a("release-item",{attrs:{type:"search",historicalReleaseIds:e.historicalReleaseIds,release:t.data},on:{add:e.addToReleaseHandler}})]}}],null,!1,2459864818)},[e._v(" "),a("div",{staticClass:"no-release-items",attrs:{slot:"empty"},slot:"empty"},[e._v(e._s(e.$t("search.noFavorReleases")))])])],1):e._e(),e._v(" "),-1!==e.tabLayout.indexOf("mock-search")?a("el-tab-pane",{attrs:{label:"我的mock资源",name:"mock-search"}},[a("div",{staticClass:"search-input-area"},[a("el-input",{ref:"mockSearchInputRef",staticClass:"search-release-input",attrs:{clearable:"",placeholder:e.$t("search.placeholder")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.mockSearchHandler(t)}},model:{value:e.mockSearchInput,callback:function(t){e.mockSearchInput=t},expression:"mockSearchInput"}})],1),e._v(" "),a("lazy-list-view",{ref:"mockSearchView",staticClass:"search-release-list",attrs:{list:e.mockSearchReleases,height:60,fetch:e.mockSearchDataHandler},scopedSlots:e._u([{key:"default",fn:function(t){return[a("release-item",{attrs:{type:"search",historicalReleaseIds:e.historicalReleaseIds,release:t.data},on:{add:e.addToMockReleaseHandler}})]}}],null,!1,4276864856)})],1):e._e()],1)],1)};r._withStripped=!0;var s=a(86),n=a.n(s),i=a(132),o=a.n(i),c=a(443),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"release-item"},[a("div",{staticClass:"r-i-name"},[e._v(e._s(e.release.releaseName))]),e._v(" "),a("div",{staticClass:"r-i-row"},[a("span",{staticClass:"r-i-type"},[e._v(e._s(e._f("pageBuildFilter")(e.release.resourceType)))]),e._v(" "),e.release.latestVersion?a("span",{staticClass:"r-i-version"},[e._v(e._s(e.release.latestVersion&&e.release.latestVersion.version))]):e._e(),e._v(" "),a("span",{staticClass:"r-i-date"},[e._v(e._s(e._f("fmtDate")(e.release.updateDate)))]),e._v(" "),e.isHistoricalRelease?a("strong",[e._v(e._s(e.$t("search.historicVersion")))]):e._e()]),e._v(" "),a("el-button",{staticClass:"add-release-btn",class:{disabled:e.isHistoricalRelease},on:{click:e.addToRelease}},[e._v(e._s(e.$t("search.addBtn")))])],1)};l._withStripped=!0;var d={name:"release-item",props:{release:{type:Object,default:function(){return{}}},type:String,historicalReleaseIds:{type:Array,default:function(){return[]}}},computed:{isHistoricalRelease:function(){return-1!==this.historicalReleaseIds.indexOf(this.release.releaseId)}},methods:{addToRelease:function(){this.isHistoricalRelease||this.$emit("add",this.release)}}},u=(a(500),a(3)),h=Object(u.a)(d,l,[],!1,null,"4a5d2fee",null);h.options.__file="src/views/release/search/release-item.vue";var f=h.exports,p=a(4),v=a(490),m=a.n(v),g={name:"releases-search",components:{LazyListView:c.a,ReleaseItem:f},props:{type:{type:String,default:"release"},releaseSource:{type:Object},historicalReleases:{type:Array,default:function(){return[]}},mockTab:{type:Boolean},tabLayout:{type:Array,default:["search","my-release","favor"]}},data:function(){return{activeName:this.tabLayout[0],searchInput:"",mockSearchInput:"",myReleases:[],favorReleases:[],searchReleases:[],mockSearchReleases:[]}},computed:{historicalReleaseIds:function(){return this.historicalReleases.map(function(e){return e.releaseId})}},mounted:function(){this.$refs.searchInputRef&&this.$refs.searchInputRef.focus(),this.myLoader=this.getMyReleasesLoader(),this.favorLoader=this.getFavorReleasesLoader()},methods:{addToReleaseHandler:function(e){this.$emit("add",e)},addToMockReleaseHandler:function(e){this.$emit("add",e)},clearSearchInputHandler:function(){},getMyReleasesLoader:function(){var e=this;return this.createReleaseLoader(function(t){return e.$services.ReleaseService.get(t||{}).then(function(e){return e.getData()})})},getFavorReleasesLoader:function(){var e=this;return this.createReleaseLoader(function(t){return e.$services.collections.get(t||{}).then(function(e){return e.getData()})})},createReleaseLoader:function(e){return function(t){return t=t||{pageSize:10,page:1},"object"===o()(t)&&(t={params:Object.assign({pageSize:10,page:1},t)}),e(t)}},fetchMyData:function(e){var t=this;if(!this.myLoader)return Promise.resolve({canLoadMore:!1,dataList:[]});var a=Object.assign({page:e,isSelf:1},{resourceType:this.releaseSource?this.releaseSource.resourceType:null});return this.myLoader(a).then(function(e){return t.myReleases=t.myReleases.concat(e.dataList),e.dataList.length<10&&(e.canLoadMore=!1),e})},fetchFavorData:function(e){var t=this;return this.favorLoader?this.favorLoader({page:e}).then(function(e){return t.favorReleases=t.favorReleases.concat(e.dataList),e.dataList.length<10&&(e.canLoadMore=!1),e}):Promise.resolve({canLoadMore:!1,dataList:[]})},searchDataHandler:function(e){var t=this;return this.searchInput?this.$services.ReleaseService.get({params:Object.assign({keywords:encodeURIComponent(this.searchInput),page:e,pageSize:10},this.searchScope)}).then(function(e){var a=e.getData()||{};return 0===e.data.errcode?(t.searchReleases=t.searchReleases.concat(a.dataList),a.dataList.length<10&&(a.canLoadMore=!1)):a.canLoadMore=!1,a}):Promise.resolve({canLoadMore:!1})},searchHandler:function(){this.activeName="search",this.searchReleases=[],this.$refs.searchView.refresh()},mockSearchDataHandler:function(e){var t=this;if(!this.mockSearchInput)return Promise.resolve({canLoadMore:!1});var a=n()({page:e,pageSize:10,keywords:encodeURIComponent(this.mockSearchInput)},this.searchScope),r=m.a.stringify(a);return p.a.get("/v1/resources/mocks?".concat(r)).then(function(e){console.log(e,"CASEFRWWFEA");var a=e.getData()||{};return 0===e.data.errcode?(a.dataList=a.dataList.map(function(e){return{releaseName:e.name,resourceType:e.resourceType,updateDate:e.updateDate,releaseId:e.mockResourceId}}),t.mockSearchReleases=t.mockSearchReleases.concat(a.dataList),a.dataList.length<10&&(a.canLoadMore=!1)):a.canLoadMore=!1,a})},mockSearchHandler:function(){this.activeName="mock-search",this.mockSearchReleases=[],this.$refs.mockSearchView.refresh()}}},y=(a(503),Object(u.a)(g,r,[],!1,null,null,null));y.options.__file="src/views/release/search/index.vue";t.a=y.exports},500:function(e,t,a){"use strict";var r=a(447);a.n(r).a},501:function(e,t,a){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,a,n){t=t||"&",a=a||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var c=1e3;n&&"number"==typeof n.maxKeys&&(c=n.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var d=0;d<l;++d){var u,h,f,p,v=e[d].replace(o,"%20"),m=v.indexOf(a);m>=0?(u=v.substr(0,m),h=v.substr(m+1)):(u=v,h=""),f=decodeURIComponent(u),p=decodeURIComponent(h),r(i,f)?s(i[f])?i[f].push(p):i[f]=[i[f],p]:i[f]=p}return i};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},502:function(e,t,a){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,a,o){return t=t||"&",a=a||"=",null===e&&(e=void 0),"object"==typeof e?n(i(e),function(i){var o=encodeURIComponent(r(i))+a;return s(e[i])?n(e[i],function(e){return o+encodeURIComponent(r(e))}).join(t):o+encodeURIComponent(r(e[i]))}).join(t):o?encodeURIComponent(r(o))+a+encodeURIComponent(r(e)):""};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function n(e,t){if(e.map)return e.map(t);for(var a=[],r=0;r<e.length;r++)a.push(t(e[r],r));return a}var i=Object.keys||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return t}},503:function(e,t,a){"use strict";var r=a(448);a.n(r).a}}]);