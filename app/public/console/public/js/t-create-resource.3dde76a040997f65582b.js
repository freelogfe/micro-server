(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{432:function(e,t,s){"use strict";s.r(t),s.d(t,"RESOURCE_TYPES",function(){return i}),s.d(t,"RESOURCE_STATUS_MAP",function(){return r}),s.d(t,"RESOURCE_STATUS",function(){return n});var a=s(2),i={json:"json",widget:"widget",image:"image",audio:"audio",markdown:"markdown",page_build:"page_build",reveal_slide:"reveal_slide",license:"license",video:"video",catalog:"catalog"},r={unknown:0,unpublished:1,published:2,freeze:3},n=[{desc:a.a.t("config.resource.states[0]"),type:"danger",status:r.unknown},{desc:a.a.t("config.resource.states[1]"),type:"warning",status:r.unpublished},{desc:a.a.t("config.resource.states[2]"),type:"success",status:r.published},{desc:a.a.t("config.resource.states[3]"),type:"danger",status:r.freeze}]},703:function(e,t,s){},704:function(e,t,s){},936:function(e,t,s){"use strict";var a=s(703);s.n(a).a},937:function(e,t,s){"use strict";var a=s(704);s.n(a).a},971:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"fo-upload-wrapper"},[s("div",{staticClass:"upload-operation-box"},[s("el-select",{staticClass:"fo-upload-select",attrs:{"allow-create":"",filterable:"",placeholder:"请选择资源类型"},model:{value:e.selectType,callback:function(t){e.selectType=t},expression:"selectType"}},e._l(e.resourceTypes,function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})}),1),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.uploadResources}},[e._v("上传并创建资源")]),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:e.clearFileList}},[e._v("清空")])],1),e._v(" "),s("el-upload",{ref:"foUpload",staticClass:"upload-box",attrs:{drag:"",multiple:"","with-credentials":"",action:e.uploadActionUrl,data:e.uploadData,"file-list":e.fileList,"on-change":e.fileChangeHandler,"on-success":e.fileSuccessHandler,"on-error":e.fileErrorHandler,"auto-upload":!1}},[s("i",{staticClass:"el-icon-upload"}),e._v(" "),s("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),s("em",[e._v("点击上传")])])])],1)])};a._withStripped=!0;var i=s(432),r={name:"batch-operation",data:function(){return{selectType:"",fileList:[],existedFilesSet:new Set,errorFilesSet:new Set,uploadData:{resourceType:""}}},computed:{uploadActionUrl:function(){return"".concat(window.window.FreelogApp.Env.qiOrigin,"/v1/resources/temporaryFiles/uploadResourceFile")},resourceTypes:function(){return Object.values(i.RESOURCE_TYPES)}},watch:{selectType:function(){this.uploadData.resourceType=this.selectType}},methods:{fileChangeHandler:function(e,t){this.fileList=t},fileSuccessHandler:function(e,t,s){var a=this,i=t.name,r=e.errcode,n=e.data,o=e.msg;if(0===r){var c=n.uploadFileId;n.isExistResource?(this.$message.warning("“".concat(i,"”已存在！")),this.existedFilesSet.add(i)):this.$services.resource.post({uploadFileId:c,aliasName:i.replace(/\.(\w+)$/,""),description:"",dependencies:[]}).then(function(e){return e.data}).then(function(e){0===e.errcode?a.$message.success("“".concat(i,"创建成功！")):(a.$message.error("“".concat(i,"”:").concat(e.msg)),a.errorFilesSet.add(i),a.fileList=s.map(function(e){var t=e.name;return a.errorFilesSet.has(t)&&(e.name="".concat(t," (出错喇！！！)")),e}))})}else this.$message.error("".concat(i,": ").concat(o)),this.errorFilesSet.add(i);this.fileList=s.map(function(e){var t=e.name;return a.existedFilesSet.has(t)&&(e.name="".concat(t," (已存在！！！)")),e})},fileErrorHandler:function(e,t,s){var a=this;this.errorFilesSet.add(t.name),this.fileList=s.map(function(e){var s=e.name;return a.errorFilesSet.has(s)&&(t.name="".concat(s," (出错喇！！！)")),e})},uploadResources:function(){var e=this,t=this.selectType;if(""!==t)return 0===this.fileList.length?(console.log(JSON.parse(JSON.stringify(this.fileList))),void this.$message.error("请先添加文件")):void this.$confirm("资源类型为".concat(t,", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$refs.foUpload.submit()});this.$message.error("请先选择资源类型！！！")},clearFileList:function(){this.$refs.foUpload.clearFiles(),this.fileList=[]}}},n=(s(936),s(937),s(3)),o=Object(n.a)(r,a,[],!1,null,"c62dc33e",null);o.options.__file="src/views/tools/create-resource.vue";t.default=o.exports}}]);