(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{435:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"boxRef",staticStyle:{height:"100%","overflow-y":"auto"}},[e._t("default"),e._v(" "),a("div",{ref:"loadingRef",staticStyle:{"font-size":"14px",color:"#999","text-align":"center","line-height":"40px","padding-top":"10px"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!e.end,expression:"!end"}]},[e._v(e._s(e.$t("loading")))]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.end,expression:"end"}]},[e._v(e._s(e.endText||e.$t("end")))])])],2)};n._withStripped=!0;var i={name:"LazyLoadingBox",i18n:{messages:{en:{loading:"Loading...",end:"End"},"zh-CN":{loading:"加载中......",end:"加载完毕"}}},props:{end:{type:Boolean,default:!1},endText:String},data:function(){return{func:null}},mounted:function(){var e=this;this.$refs.boxRef.onscroll=function(){e.end||e.$refs.boxRef.getBoundingClientRect().bottom>=e.$refs.loadingRef.getBoundingClientRect().top&&(e.func=e.handleEvent,setTimeout(function(){e.func&&(e.func(),e.func=null)},1e3))}},methods:{handleEvent:function(){this.$emit("toBottom")}}},s=a(3),r=Object(s.a)(i,n,[],!1,null,"f1de9078",null);r.options.__file="src/components/DependentReleaseList/DepDialog/LazyLoadingBox.vue";t.a=r.exports},442:function(e,t,a){"use strict";a.r(t),a.d(t,"COMMON_NAME_REGEXP",function(){return n});var n=/^(?!.*(\\|\/|:|\*|\?|"|<|>|\||\s|@|#|\$)).{1,60}$/},446:function(e,t,a){},450:function(e,t,a){},451:function(e,t,a){},458:function(e,t,a){"use strict";a.r(t),a.d(t,"CONTRACT_STATUS",function(){return i}),a.d(t,"CONTRACT_STATUS_TIPS",function(){return s}),a.d(t,"CONTRACT_STATUS_COLORS",function(){return r});var n=a(2),i={uncreated:-1,initial:1,running:2,activated:3,userTerminated:4,sysTerminated:5,terminated:6},s={"-1":n.a.t("config.contract.statesTip[0]"),1:n.a.t("config.contract.statesTip[1]"),2:n.a.t("config.contract.statesTip[2]"),3:n.a.t("config.contract.statesTip[3]"),4:n.a.t("config.contract.statesTip[4]"),5:"",6:n.a.t("config.contract.statesTip[6]")},r={"-1":{type:"danger",desc:s[-1]},1:{type:"warning",desc:s[1]},2:{type:"warning",desc:s[2]},3:{type:"info",desc:s[3]},4:{type:"success",desc:s[4]},5:{type:"info",desc:""},6:{type:"info",desc:s[6]}}},471:function(e,t,a){},472:function(e,t,a){},473:function(e,t,a){},474:function(e,t,a){},475:function(e,t,a){},476:function(e,t,a){},477:function(e,t,a){"use strict";a.d(t,"c",function(){return i}),a.d(t,"b",function(){return s});var n=a(2),i=[{type:"free",template:"for public:\n  initial:\n    active\n    terminate\n  ",name:n.a.t("components.policyEditor.defaultPolicyNames.free")},{type:"charge",template:"for public:\n  escrow account acct\n  custom event acceptor.customEvent\n\n  initial:\n    recontractable\n    proceed to auth on acct exceed 1 feather\n  auth:\n    presentable\n    recontractable\n    active\n    proceed to refund on acct.confiscated\n  refund:\n    recontractable\n    proceed to finish on acct.refunded\n  finish:\n    recontractable\n    terminate\n  ",name:n.a.t("components.policyEditor.defaultPolicyNames.charge")}],s=[{type:"free",template:"for public:\n  initial:\n    active\n    terminate\n  ",name:n.a.t("components.policyEditor.defaultPolicyNames.free")},{type:"charge",template:"\n    for public:\n      escrow account acct\n      custom event acceptor.customEvent\n\n      initial:\n        proceed to auth on acct exceed 1 feather\n      auth:\n        presentable\n        active\n        proceed to refund on acct.confiscated\n      refund:\n        proceed to finish on acct.refunded\n      finish:\n        terminate",name:n.a.t("components.policyEditor.defaultPolicyNames.charge")}];t.a={release:i,presentable:s}},478:function(e,t,a){},479:function(e,t,a){},480:function(e,t,a){},481:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"enableBtnText":"启用","disableBtnText":"停用","status":["已置顶","已停用","已启用"]},"en":{"enableBtnText":"enable","disableBtnText":"disable","status":["Already topped","Already disabled","Already enabled"]}}'),delete e.options._Ctor}},482:function(e,t,a){},483:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"enableBtnText":"启用","disableBtnText":"停用","status":["已置顶","已停用","已启用"]},"en":{"enableBtnText":"enable","disableBtnText":"disable","status":["Already topped","Already disabled","Already enabled"]}}'),delete e.options._Ctor}},487:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.policies.length>0?a("el-tabs",e._l(e.policies,function(t){return a("el-tab-pane",{attrs:{label:t.policyName}},[a("div",{staticStyle:{height:"200px","overflow-y":"auto"}},[a("pre",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(t.policyText))])])])}),1):e._e(),e._v(" "),0===e.policies.length?a("div",{staticStyle:{"min-height":"200px",display:"flex","align-items":"center","justify-content":"center"}},[a("span",[e._v("暂无策略......")])]):e._e()],1)};n._withStripped=!0;var i={name:"PolicyTabs",props:{policies:{type:Array,validator:function(e){return e.every(function(e){return e.hasOwnProperty("policyId")&&e.hasOwnProperty("policyName")})},default:[]}},methods:{},mounted:function(){}},s=a(3),r=Object(s.a)(i,n,[],!1,null,"183c1c83",null);r.options.__file="src/components/PolicyTabs/index.vue";t.a=r.exports},489:function(e,t,a){"use strict";a.d(t,"b",function(){return u}),a.d(t,"a",function(){return d});var n,i=a(5),s=a.n(i),r=1,o=2,c=(n={},s()(n,r,{value:r,desc:"资源策略模板"}),s()(n,o,{value:o,desc:"用户策略模板"}),n),l={0:{value:0,desc:"正常"},1:{value:1,desc:"已删除"}};function u(e){return c[e]?c[e].desc:"策略模板"}function d(e){return l[e]?l[e].desc:"未知"}},497:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticClass:"table-view-wrapper"},[a("el-table",{staticClass:"table",attrs:{data:e.tableData,stripe:"",border:""}},[e._t("default")],2),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.showPagination,expression:"showPagination"}],staticClass:"pagination",attrs:{background:!0,"current-page":e.pageMeta.page,"page-sizes":[10,20,30,50],"page-size":e.pageMeta.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)};n._withStripped=!0;var i=a(4),s={name:"table-view",data:function(){return{loading:!1,tableData:[],total:0}},props:{data:{type:Array,default:function(){return[]}},showPagination:{type:Boolean,default:!0},formatHandler:{type:Function,default:null},paginationOptions:{type:Object,default:function(){return{pageSizes:[10,20,30,50]}}},loader:Function,pageMeta:{type:Object,default:function(){var e=i.d.get("PAGE_".concat(this.$route.fullPath,"_index"))||{};return Object.assign({pageSize:10,page:1},e)}}},beforeDestroy:function(){this.pageMeta&&this.pageMeta.keyWords&&delete this.pageMeta.keyWords,i.d.set("PAGE_".concat(this.pageUrl,"_index"),this.pageMeta)},mounted:function(){this.pageUrl=this.$route.fullPath,this.tableData=this.data,this.total=this.tableData.length,this.load(),this.$on("reload",this.reload.bind(this))},methods:{reload:function(e){this.load(e)},load:function(e){var t=this;Object.assign(this.pageMeta,e||{}),this.loader&&(this.loading=!0,this.loader(this.pageMeta).then(function(e){var a=e.getData();if(t.loading=!1,a){var n=a.dataList||a;t.formatHandler&&(n=t.formatHandler(n)),t.tableData=n,a.dataList?(t.total=a.totalItem,t.pageMeta.page=a.page||1):t.total=n.length}else t.$message.error(a.msg)}).catch(function(){console.warn("加载失败"),t.loading=!1}))},handleSizeChange:function(e){var t={pageSize:e};this.load(t),this.$emit("sizeChange",t)},handleCurrentChange:function(e){var t={page:e};this.load(t),this.$emit("pageChange",t)}}},r=(a(499),a(3)),o=Object(r.a)(s,n,[],!1,null,"83529354",null);o.options.__file="src/components/TableView/index.vue";t.a=o.exports},498:function(e,t,a){"use strict";var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{on:{click:this.copyHandler}},[t("textarea",{ref:"copyText",staticClass:"clip-text",domProps:{value:this.value}}),this._v(" "),this._t("default")],2)};n._withStripped=!0;var i={name:"clip-board",data:function(){return{}},props:{value:String},mounted:function(){},methods:{copyHandler:function(){this.$refs.copyText.select();try{var e=document.execCommand("copy");this.$emit("copyDone",e)}catch(e){this.$emit("copyDone",!1)}}}},s=(a(609),a(3)),r=Object(s.a)(i,n,[],!1,null,"46e3de8e",null);r.options.__file="src/components/clipboard/index.vue";t.a=r.exports},499:function(e,t,a){"use strict";var n=a(446);a.n(n).a},507:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(492);a.d(t,"b",function(){return n.codemirror});a(588),a(589),a(590),a(591),a(516),a(592),a(593),a(594),a(595),a(596),a(597),a(517),a(598);var i={tabSize:4,mode:"text/html",theme:"dracula",lineNumbers:!0,line:!0,extraKeys:{Ctrl:"autocomplete"},lineWrapping:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],styleSelectedText:!0,highlightSelectionMatches:{showToken:/\w/,annotateScrollbar:!0}}},508:function(e,t,a){"use strict";var n=a(450);a.n(n).a},509:function(e,t,a){"use strict";var n=a(451);a.n(n).a},512:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dep-dialog"},[a("div",{staticClass:"dep-dialog__box"},[a("div",{staticClass:"dep-dialog__box__header"},[a("div",{staticClass:"dep-dialog__box__header__tabs"},[a("a",{staticStyle:{display:"inline-block",padding:"0 5px","margin-left":"30px",color:"#409eff","border-bottom":"1px solid #409eff"},style:{color:"search"===e.activeTab?"#409eff":"inherit","border-bottom":"search"===e.activeTab?"1px solid #409eff":"none"},on:{click:function(t){return e.onChangeTab("search")}}},[e._v(e._s(e.$t("globalSearching")))]),e._v(" "),a("a",{staticStyle:{display:"inline-block",padding:"0 5px","margin-left":"40px"},style:{color:"release"===e.activeTab?"#409eff":"inherit","border-bottom":"release"===e.activeTab?"1px solid #409eff":"none"},on:{click:function(t){return e.onChangeTab("release")}}},[e._v(e._s(e.$t("myReleases")))]),e._v(" "),a("a",{staticStyle:{display:"inline-block",padding:"0 5px","margin-left":"40px"},style:{color:"collection"===e.activeTab?"#409eff":"inherit","border-bottom":"collection"===e.activeTab?"1px solid #409eff":"none"},on:{click:function(t){return e.onChangeTab("collection")}}},[e._v(e._s(e.$t("myCollections")))]),e._v(" "),e.showMock?a("a",{staticStyle:{display:"inline-block",padding:"0 5px","margin-left":"40px"},style:{color:"mock"===e.activeTab?"#409eff":"inherit","border-bottom":"mock"===e.activeTab?"1px solid #409eff":"none"},on:{click:function(t){return e.onChangeTab("mock")}}},[e._v(e._s(e.$t("myMocks")))]):e._e()]),e._v(" "),a("i",{staticClass:"el-icon-close",staticStyle:{"font-size":"20px",color:"#666","margin-right":"30px"},on:{click:function(t){return e.$emit("onClose")}}})]),e._v(" "),a("div",{staticStyle:{"flex-shrink":"1",height:"100%",overflow:"hidden"}},["search"===e.activeTab?a("Search",{attrs:{exists:e.exists,currentID:e.currentID},on:{add:function(t){return e.$emit("addARelease",t)},remove:function(t){return e.$emit("removeARelease",t)}}}):e._e(),e._v(" "),"release"===e.activeTab?a("Release",{attrs:{exists:e.exists,currentID:e.currentID},on:{add:function(t){return e.$emit("addARelease",t)},remove:function(t){return e.$emit("removeARelease",t)}}}):e._e(),e._v(" "),"collection"===e.activeTab?a("Collection",{attrs:{exists:e.exists,currentID:e.currentID},on:{add:function(t){return e.$emit("addARelease",t)},remove:function(t){return e.$emit("removeARelease",t)}}}):e._e(),e._v(" "),"mock"===e.activeTab?a("Mock",{attrs:{exists:e.existMocks,currentID:e.currentID},on:{add:function(t){return e.$emit("addAMock",t)},remove:function(t){return e.$emit("removeAMock",t)}}}):e._e()],1),e._v(" "),a("div",{staticStyle:{height:"20px"}})])])};n._withStripped=!0;var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("LazyLoadingBox",{attrs:{end:e.dataEnd,endText:e.data&&0===e.data.length?e.$t("noConditions"):""},on:{toBottom:e.toBottom}},[a("div",{staticStyle:{padding:"0 90px"}},[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("el-input",{attrs:{placeholder:e.$t("pleaseEnter")},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("div",{staticStyle:{height:"30px"}}),e._v(" "),e._l(e.data,function(t){return a("DepItem",{attrs:{name:t.name,isOnline:t.isOnline,type:t.type,version:t.version,date:t.date,showRemove:e.exists.includes(t.id)},on:{click:function(a){return e.$emit("add",t)},remove:function(a){return e.$emit("remove",t)}}})})],2)])};i._withStripped=!0;var s=a(428),r=a.n(s),o=a(426),c=a.n(o),l=a(429),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"border-bottom":"1px solid #e1e1e1",height:"68px",display:"flex","justify-content":"space-between","align-items":"center"}},[a("div",[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("span",{staticClass:"ellipsis",staticStyle:{"padding-right":"20px","font-size":"20px",color:"#333","max-width":"500px",display:"inline-block"}},[e._v(e._s(e.name))]),e._v(" "),e.isOnline?e._e():a("span",{staticStyle:{"background-color":"#cdcdcd","border-radius":"2px",color:"#fff","font-size":"12px",padding:"2px 9px"}},[e._v(e._s(e.$t("noOnline")))])]),e._v(" "),a("div",{staticStyle:{"font-size":"14px",color:"#999"}},[a("span",[e._v(e._s(e._f("pageBuildFilter")(e.type)))]),e._v(" "),e.version?a("span",[e._v(" | v"+e._s(e.version))]):e._e(),e._v(" "),a("span",[e._v(" | "+e._s(e.date))])])]),e._v(" "),e.showRemove?a("el-button",{staticStyle:{width:"70px","padding-left":"0","padding-right":"0"},attrs:{type:"danger",round:"",size:"small",disabled:e.disabled},on:{click:function(t){return e.$emit("remove")}}},[e._v(e._s(e.$t("remove"))+"\n    ")]):a("el-button",{staticStyle:{width:"70px","padding-left":"0","padding-right":"0"},attrs:{type:"primary",round:"",size:"small",disabled:e.disabled},on:{click:function(t){return e.$emit("click")}}},[e._v(e._s(e.disabled?e.$t("added"):e.$t("add"))+"\n    ")])],1)};u._withStripped=!0;var d={name:"DepItem",i18n:{messages:{en:{noOnline:"No Online",added:"Added",add:"Add",remove:"Remove"},"zh-CN":{noOnline:"未上线",added:"已添加",add:"加入",remove:"移除"}}},props:{name:{type:String,default:""},isOnline:{type:Boolean,default:!0},type:{type:String,default:""},version:{type:String,default:""},date:{type:String,default:""},disabled:{type:Boolean,default:!1},showRemove:{type:Boolean,default:!1}}},p=(a(508),a(3)),f=Object(p.a)(d,u,[],!1,null,"1d6d5c51",null);f.options.__file="src/components/DependentReleaseList/DepDialog/DepItem.vue";var v=f.exports,h=a(435),m={name:"Search",i18n:{messages:{en:{pleaseEnter:"Please enter",noConditions:"Does not meet the conditions of release"},"zh-CN":{pleaseEnter:"请输入内容",noConditions:"没有符合条件的发行"}}},components:{DepItem:v,LazyLoadingBox:h.a},props:{exists:{type:Array,default:function(){return[]}},currentID:{type:String,default:""}},data:function(){return{input:"",page:1,data:[],dataEnd:!1,searchTimeout:null}},mounted:function(){this.search()},methods:{search:function(){var e=this;return Object(l.coroutine)(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={page:e.page,keywords:e.input,pageSize:20},t.next=3,e.$axios.get("/v1/releases",{params:a});case 3:n=t.sent,i=n.data.data,e.dataEnd=i.page*i.pageSize>=i.totalItem,e.data=[].concat(c()(e.data),c()(i.dataList.map(function(e){return{id:e.releaseId,name:e.releaseName,isOnline:1===e.status,type:e.latestVersion.resourceInfo.resourceType,version:e.latestVersion.version,date:e.updateDate.split("T")[0],versions:e.resourceVersions.map(function(e){return e.version})}}))).filter(function(t){return t.id!==e.currentID&&t.isOnline});case 7:case"end":return t.stop()}},t)}))()},toBottom:function(){this.page++,this.search()}},watch:{input:function(){var e=this;this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){e.page=1,e.data=[],e.search()},1e3)}}},g=Object(p.a)(m,i,[],!1,null,"5e6d7b2e",null);g.options.__file="src/components/DependentReleaseList/DepDialog/Search.vue";var _=g.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[!1===e.noData?a("LazyLoadingBox",{attrs:{end:e.dataEnd,endText:e.data&&0===e.data.length?e.$t("noConditions"):""},on:{toBottom:e.toBottom}},[a("div",{staticStyle:{padding:"0 90px"}},[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("el-input",{attrs:{placeholder:e.$t("pleaseEnter")},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("div",{staticStyle:{height:"30px"}}),e._v(" "),e._l(e.data,function(t){return a("DepItem",{attrs:{name:t.name,isOnline:t.isOnline,type:t.type,version:t.version,date:t.date,showRemove:e.exists.includes(t.id)},on:{click:function(a){return e.$emit("add",t)},remove:function(a){return e.$emit("remove",t)}}})})],2)]):e._e(),e._v(" "),!0===e.noData?a("div",{staticStyle:{"line-height":"300px","font-size":"16px",color:"#333","text-align":"center"}},[e._v("\n        "+e._s(e.$t("noRelease"))+"\n    ")]):e._e()],1)};y._withStripped=!0;var x={name:"Release",i18n:{messages:{en:{pleaseEnter:"Please enter",noRelease:"You have not created any issue",noConditions:"Does not meet the conditions of release"},"zh-CN":{pleaseEnter:"请输入内容",noRelease:"您还没有创建任何发行",noConditions:"没有符合条件的发行"}}},components:{DepItem:v,LazyLoadingBox:h.a},props:{exists:{type:Array,default:function(){return[]}},currentID:{type:String,default:""}},mounted:function(){this.search()},data:function(){return{input:"",page:1,data:[],dataEnd:!1,noData:null}},methods:{search:function(){var e=this;return Object(l.coroutine)(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={isSelf:1,page:e.page,keywords:e.input,pageSize:10},t.next=3,e.$axios.get("/v1/releases",{params:a});case 3:n=t.sent,i=n.data.data,e.dataEnd=i.page*i.pageSize>=i.totalItem,e.data=[].concat(c()(e.data),c()(i.dataList.map(function(e){return{id:e.releaseId,name:e.releaseName,isOnline:1===e.status,type:e.latestVersion.resourceInfo.resourceType,version:e.latestVersion.version,date:e.updateDate.split("T")[0],versions:e.resourceVersions.map(function(e){return e.version})}}))).filter(function(t){return t.id!==e.currentID}),e.noData=null===e.noData&&0===e.data.length;case 8:case"end":return t.stop()}},t)}))()},toBottom:function(){this.page++,this.search()}},watch:{input:function(){this.page=1,this.data=[],this.search()}}},b=Object(p.a)(x,y,[],!1,null,"77db0616",null);b.options.__file="src/components/DependentReleaseList/DepDialog/Release.vue";var w=b.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[!1===e.noData?a("LazyLoadingBox",{attrs:{end:e.dataEnd,endText:e.data&&0===e.data.length?e.$t("noConditions"):""},on:{toBottom:e.toBottom}},[a("div",{staticStyle:{padding:"0 90px"}},[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("el-input",{attrs:{placeholder:e.$t("pleaseEnter")},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("div",{staticStyle:{height:"30px"}}),e._v(" "),e._l(e.data,function(t){return a("DepItem",{attrs:{name:t.name,isOnline:t.isOnline,type:t.type,version:t.version,date:t.date,showRemove:e.exists.includes(t.id)},on:{click:function(a){return e.$emit("add",t)},remove:function(a){return e.$emit("remove",t)}}})})],2)]):e._e(),e._v(" "),!0===e.noData?a("div",{staticStyle:{"line-height":"300px","font-size":"16px",color:"#333","text-align":"center"}},[e._v("\n        "+e._s(e.$t("noCollection"))+"\n    ")]):e._e()],1)};S._withStripped=!0;var T={name:"Collection",i18n:{messages:{en:{noCollection:"You are not collecting any issue you in the market after the release of the collection will show up here",pleaseEnter:"Please enter",noConditions:"Does not meet the conditions of release"},"zh-CN":{noCollection:"您还没有收藏任何发行，您在发行市场收藏的发行之后将会出现在这里",pleaseEnter:"请输入内容",noConditions:"没有符合条件的发行"}}},components:{DepItem:v,LazyLoadingBox:h.a},props:{exists:{type:Array,default:function(){return[]}},currentID:{type:String,default:""}},mounted:function(){this.search()},data:function(){return{input:"",page:1,data:[],dataEnd:!1,noData:null}},methods:{search:function(){var e=this;return Object(l.coroutine)(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={page:e.page,keywords:e.input,pageSize:10},t.next=3,e.$axios.get("/v1/collections/releases",{params:a});case 3:n=t.sent,i=n.data.data,e.dataEnd=i.page*i.pageSize>=i.totalItem,e.data=[].concat(c()(e.data),c()(i.dataList.map(function(e){return{id:e.releaseId,name:e.releaseName,isOnline:1===e.releaseStatus,type:e.resourceType,version:e.latestVersion.version,date:e.releaseUpdateDate.split("T")[0],versions:e.resourceVersions.map(function(e){return e.version})}}))).filter(function(t){return t.id!==e.currentID}),e.noData=null===e.noData&&0===e.data.length;case 8:case"end":return t.stop()}},t)}))()},toBottom:function(){this.page++,this.search()}},watch:{input:function(){this.page=1,this.data=[],this.search()}}},C=Object(p.a)(T,S,[],!1,null,"afc43842",null);C.options.__file="src/components/DependentReleaseList/DepDialog/Collection.vue";var I=C.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[!1===e.noData?a("LazyLoadingBox",{attrs:{end:e.dataEnd,endText:e.data&&0===e.data.length?e.$t("noConditions"):""},on:{toBottom:e.toBottom}},[a("div",{staticStyle:{padding:"0 90px"}},[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("el-input",{attrs:{placeholder:e.$t("pleaseEnter")},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("div",{staticStyle:{height:"30px"}}),e._v(" "),e._l(e.data,function(t){return a("DepItem",{attrs:{name:t.name,type:t.type,date:t.date,showRemove:e.exists.includes(t.id)},on:{click:function(a){return e.$emit("add",t)},remove:function(a){return e.$emit("remove",t)}}})})],2)]):e._e(),e._v(" "),!0===e.noData?a("div",{staticStyle:{"line-height":"300px","font-size":"16px",color:"#333","text-align":"center"}},[e._v(e._s(e.$t("noMock")))]):e._e()],1)};k._withStripped=!0;var R={name:"Mock",i18n:{messages:{en:{pleaseEnter:"Please enter",noMock:"You have not created any mock",noConditions:"Does not meet the conditions of resources"},"zh-CN":{pleaseEnter:"请输入内容",noMock:"您还没有创建任何mock",noConditions:"没有符合条件的资源"}}},components:{DepItem:v,LazyLoadingBox:h.a},props:{exists:{type:Array,default:function(){return[]}},currentID:{type:String,default:""}},mounted:function(){this.search()},data:function(){return{input:"",page:1,data:[],dataEnd:!1,noData:null}},methods:{search:function(){var e=this;return Object(l.coroutine)(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={page:e.page,keywords:e.input,pageSize:10},t.next=3,e.$axios.get("/v1/resources/mocks",{params:a});case 3:n=t.sent,i=n.data.data,e.dataEnd=i.page*i.pageSize>=i.totalItem,e.data=[].concat(c()(e.data),c()(i.dataList.map(function(e){return{id:e.mockResourceId,name:e.fullName,type:e.resourceType,date:e.updateDate.split("T")[0]}}))).filter(function(t){return t.id!==e.currentID}),e.noData=null===e.noData&&0===e.data.length;case 8:case"end":return t.stop()}},t)}))()},toBottom:function(){this.page++,this.search()}},watch:{input:function(){this.page=1,this.data=[],this.search()}}},$=Object(p.a)(R,k,[],!1,null,"c4a668ea",null);$.options.__file="src/components/DependentReleaseList/DepDialog/Mock.vue";var D={name:"DepDialog",i18n:{messages:{en:{globalSearching:"Global Searching",myReleases:"My Releases",myCollections:"My Collections",myMocks:"My Mocks"},"zh-CN":{globalSearching:"全局搜索",myReleases:"我的发行",myCollections:"我的收藏",myMocks:"Mock资源"}}},components:{Search:_,Release:w,Collection:I,Mock:$.exports},props:{exists:{type:Array,default:function(){return[]}},existMocks:{type:Array,default:function(){return[]}},showMock:{type:Boolean,default:!1},currentID:{type:String,default:""}},data:function(){return{visible:!0,activeTab:"search"}},methods:{onChangeTab:function(e){this.activeTab=e}}},N=(a(509),Object(p.a)(D,n,[],!1,null,"1622db41",null));N.options.__file="src/components/DependentReleaseList/DepDialog/index.vue";t.a=N.exports},513:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isloading,expression:"isloading"}],staticClass:"release-editor-contract-wrapper"},[e._m(0),e._v(" "),e.cTreeData&&e.contracts.length?a("div",{staticClass:"r-e-c-tree"},[a("div",{staticClass:"r-e-c-btn"},[e._v(e._s(e.release.releaseName))]),e._v(" "),a("div",{staticClass:"r-e-c-tree-cont"},e._l(e.cTreeData,function(t){return a("contract-tree",{staticClass:"first-level",attrs:{data:t,activeKey:e.activeKey},on:{"update:activeKey":function(t){e.activeKey=t},"update:active-key":function(t){e.activeKey=t},activate:e.showDetailContract,inactivate:e.hideDetailContract}})}),1)]):a("div",{staticClass:"r-e-c-empty-box"},[e._v("\n    未获取到有效的合同信息\n  ")]),e._v(" "),a("transition",{attrs:{name:"fade"}},[e.contractDetail?a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowDetailContract,expression:"isShowDetailContract"}],staticClass:"release-editor-box"},[a("i",{staticClass:"el-icon-close",on:{click:e.hideDetailContract}}),e._v(" "),a("el-tabs",{staticClass:"rec-tab",attrs:{type:"border-card"},on:{"tab-click":e.exchangeContractTab},model:{value:e.activeContractTab,callback:function(t){e.activeContractTab=t},expression:"activeContractTab"}},e._l(e.targetData.policies,function(t,n){return a("el-tab-pane",{key:"p"+n,attrs:{label:t.policyName,name:t.policyName}},[a("div",{staticClass:"r-e-info"},[a("h4",[e._v("合约详情")]),e._v(" "),a("div",{staticClass:"r-e-info-row"},[a("span",{staticClass:"r-e-i-label"},[e._v("发行名称")]),e._v(e._s(e.targetData.label)+"\n            ")]),e._v(" "),a("div",{staticClass:"r-e-info-row"},[a("span",{staticClass:"r-e-i-label"},[e._v("资源类型")]),e._v(e._s(e._f("pageBuildFilter")(e.targetData.resourceType))+"\n            ")]),e._v(" "),a("div",{staticClass:"r-e-info-row"},[a("span",{staticClass:"r-e-i-label"},[e._v("创建日期")]),e._v(e._s(e._f("fmtDate")(e.contractDetail.createDate))+"\n            ")]),e._v(" "),a("div",{staticClass:"r-e-info-row"},[a("span",{staticClass:"r-e-i-label"},[e._v("合同ID")]),e._v(e._s(e.contractDetail.contractId)+"\n            ")]),e._v(" "),a("div",{staticClass:"r-e-info-row"},[a("span",{staticClass:"r-e-i-label"},[e._v("甲方")]),e._v(e._s(e.contractDetail.partyOne)+"\n            ")]),e._v(" "),a("div",{staticClass:"r-e-info-row"},[a("span",{staticClass:"r-e-i-label"},[e._v("乙方")]),e._v(e._s(e.contractDetail.partyTwo)+"\n            ")])]),e._v(" "),a("div",{staticClass:"r-e-c-detail"},[a("h4",[e._v("合同信息")]),e._v(" "),a("div",{staticClass:"r-e-c-cont"},[a("contract-detail",{staticClass:"contract-policy-content",attrs:{contract:e.contractDetail,policyText:e.contractDetail.contractClause.policyText},on:{"update:contract":function(t){e.contractDetail=t},"update-contract":e.updateContractAfterEvent}})],1)])])}),1)],1):e._e()])],1)};n._withStripped=!0;var i=a(130),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tree-node",class:[]},[a("div",{staticClass:"node-content",class:[e.data.contractType]},[a("div",{staticClass:"node-key",class:{active:e.data.key===e.activeKey},on:{click:function(t){return e.tapNodeKey(e.data)}}},[e._m(0)]),e._v(" "),a("div",{staticClass:"node-label",on:{click:function(t){return e.tapNodeContent(e.data)}}},[e._v(e._s(e.data.label))])]),e._v(" "),a("transition",{attrs:{name:"fade"}},[e.data.children&&e.data.isShowChildren?a("div",{staticClass:"children-box"},e._l(e.data.children,function(t){return a("contract-tree",{attrs:{data:t,activeKey:e.childActiveKey},on:{"update:activeKey":function(t){e.childActiveKey=t},"update:active-key":function(t){e.childActiveKey=t},activate:e.showContract,inactivate:e.hideContract}})}),1):e._e()])],1)};s._withStripped=!0;var r={name:"contract-tree",props:{data:Object,activeKey:String},data:function(){return{childActiveKey:""}},watch:{activeKey:function(){this.childActiveKey=this.activeKey},childActiveKey:function(){this.$emit("update:activeKey",this.childActiveKey)}},methods:{tapNodeKey:function(e){this.activeKey!==e.key?(this.$emit("activate",e),this.$emit("update:activeKey",e.key)):(this.$emit("inactivate",e),this.$emit("update:activeKey",""))},showContract:function(e){this.$emit("activate",e)},hideContract:function(e){this.$emit("inactivate",e)},tapNodeContent:function(){}}},o=(a(613),a(3)),c=Object(o.a)(r,s,[function(){var e=this.$createElement,t=this._self._c||e;return t("i",{staticClass:"el-icon-tickets"},[t("i",{staticClass:"el-icon-setting"})])}],!1,null,"26bdc244",null);c.options.__file="src/views/release/contract/contract-tree.vue";var l=c.exports,u=a(458),d={name:"release-editor-contract",components:{ContractDetail:i.a,ContractTree:l},props:{release:Object,contracts:{type:Array,default:[]},depReleasesDetailList:{type:Array,default:[]}},data:function(){return{isShowDetailContract:!1,isloading:!1,cTreeData:[],contractDetail:null,targetData:null,activeContractTab:"",activeContractTabIndex:0,activeKey:"",activeRelease:null,releaseIdNameMap:{}}},computed:{contractsMap:function(){var e={};return this.contracts.forEach(function(t){e[t.contractId]=t}),e}},watch:{contracts:function(){this.reResolveTreeData()},depReleasesDetailList:function(){this.reResolveTreeData()}},methods:{reResolveTreeData:function(){for(var e=this,t=[],a=this.depReleasesDetailList,n="tree-node-i-",i=-1,s=0,r=function(r){var o=a[r],c=o.contracts,l=o.baseUpcastReleases,u=o.releaseId,d=o.releaseName,p=c&&c.length>0;p&&(s=0,t[++i]=e.getTreeNode(a[r],n+r)),e.releaseIdNameMap[u]=d,l.forEach(function(a){if(a.contracts&&a.contracts.length>0){var o=e.getTreeNode(a,n+r);p?(o.key=o.key+"-"+s,s++,t[i].children.push(o)):(s=0,t[++i]=o)}})},o=0;o<a.length;o++)r(o);this.cTreeData=t},getTreeNode:function(e,t){try{var a={key:t,isShowChildren:!0,children:[],label:e.releaseName,resourceType:e.resourceType,contracts:e.contracts,contractType:this.getNodeContractType(e.contracts),policies:e.policies}}catch(e){console.log("e --",e)}return a},getNodeContractType:function(e){var t=!1,a="";if(e&&e.length)for(var n=0;n<e.length;n++){var i=e[n].contractId,s=this.contractsMap[i];if(s){if("success"===(a=u.CONTRACT_STATUS_COLORS[s.status]?u.CONTRACT_STATUS_COLORS[s.status].type:""))return a;"warning"===a&&(t=!0)}}return t?"warning":a},updateContractAfterEvent:function(){},exchangeContractTab:function(e){this.activeContractTabIndex=+e.index,this.handlerContract(this.targetData)},showDetailContract:function(e){var t=this;e.contracts.length&&(this.activeContractTabIndex=0,this.targetData!==e&&this.isShowDetailContract?(this.isShowDetailContract=!1,setTimeout(function(){t.handlerContract(e)},300)):this.handlerContract(e))},handlerContract:function(e){var t=e.contracts[this.activeContractTabIndex].contractId;this.activeContractTab=e.policies[this.activeContractTabIndex].policyName;var a=this.contractsMap[t],n=a.partyOne,i=a.partyTwo;this.contractDetail=this.contractsMap[t],this.contractDetail.partyOne=this.releaseIdNameMap[n]||n,this.contractDetail.partyTwo=this.releaseIdNameMap[i]||i,this.isShowDetailContract=!0,this.targetData=e},hideDetailContract:function(){this.activeKey="",this.isShowDetailContract=!1}},created:function(){this.release&&this.release.releaseId&&(this.releaseIdNameMap[this.release.releaseId]=this.release.releaseName)}},p=(a(614),a(615),Object(o.a)(d,n,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"r-e-c-tags"},[t("i",{staticClass:"el-icon-setting success"}),this._v(" "),t("i",{staticClass:"el-icon-setting error"}),this._v(" "),t("i",{staticClass:"el-icon-setting warning"})])}],!1,null,"97cd9e92",null));p.options.__file="src/views/release/contract/index.vue";t.a=p.exports},523:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"custom-tags",staticStyle:{display:"flex","align-items":"center","flex-wrap":"wrap"}},[e._l(e.tags,function(t){return a("div",{key:t,staticClass:"user-defined-tag"},[a("el-tag",{attrs:{closable:e.isCanCURD,size:"small","disable-transitions":!1},on:{close:function(a){return e.handleClose(t)}}},[a("span",{staticStyle:{color:"#666"}},[e._v(e._s(t))])])],1)}),e._v(" "),e.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"mini"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}):e._e(),e._v(" "),e.inputVisible?e._e():a("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"12px",color:"#666","background-color":"#f1f1f1","border-radius":"50%",padding:"5px",cursor:"pointer","margin-bottom":"10px"},on:{click:e.showInput}})],2)};n._withStripped=!0;var i=a(426),s=a.n(i),r=a(442),o={name:"freelog-tags",data:function(){return{tags:[],inputVisible:!1,inputValue:""}},props:{value:{type:Array,default:function(){return[]}},actionText:{type:String,default:function(){return"New Tag"}},isCanCURD:{type:Boolean,default:!0}},watch:{value:function(e){this.setCurrentValue(e)}},mounted:function(){this.setCurrentValue(this.value)},methods:{setCurrentValue:function(e){this.tags=e},handleClose:function(e){this.tags=this.tags.filter(function(t){return t!==e}),this.$emit("input",this.tags)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(){e.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var e=this.inputValue;if(e){if(!r.COMMON_NAME_REGEXP.test(this.inputValue))return this.$message.error('标签的名称不能包含空格和以下字符：\\ / : * ? " < > |');var t=[].concat(s()(this.tags),[e]);this.tags=Array.from(new Set(t)),this.$emit("input",this.tags)}this.inputVisible=!1,this.inputValue=""}}},c=(a(620),a(621),a(3)),l=Object(c.a)(o,n,[],!1,null,"11dff78c",null);l.options.__file="src/components/Tags/index.vue";t.a=l.exports},607:function(e,t,a){},608:function(e,t,a){},609:function(e,t,a){"use strict";var n=a(471);a.n(n).a},610:function(e,t,a){},611:function(e,t,a){},612:function(e,t,a){},613:function(e,t,a){"use strict";var n=a(472);a.n(n).a},614:function(e,t,a){"use strict";var n=a(473);a.n(n).a},615:function(e,t,a){"use strict";var n=a(474);a.n(n).a},616:function(e,t,a){},617:function(e,t,a){},618:function(e,t,a){},619:function(e,t,a){},620:function(e,t,a){"use strict";var n=a(475);a.n(n).a},621:function(e,t,a){"use strict";var n=a(476);a.n(n).a},622:function(e,t,a){"use strict";var n=a(478);a.n(n).a},623:function(e,t,a){"use strict";var n=a(479);a.n(n).a},624:function(e,t,a){"use strict";var n=a(480);a.n(n).a},625:function(e,t,a){"use strict";var n=a(481),i=a.n(n);t.default=i.a},626:function(e,t,a){"use strict";var n=a(482);a.n(n).a},627:function(e,t,a){"use strict";var n=a(483),i=a.n(n);t.default=i.a},628:function(e,t,a){},629:function(e,t,a){},630:function(e,t,a){},631:function(e,t,a){},632:function(e,t,a){},633:function(e,t,a){},634:function(e,t,a){},635:function(e,t,a){"use strict";(function(e){var n=a(426),i=a.n(n),s=a(428),r=a.n(s),o=a(429),c=a(510),l=a(512),u=a(948),d=a(949);function p(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i()(a.testRules),s=a.ruleText,r=new Set,o=!0,l=!1,u=void 0;try{for(var d,p=function(){var a=d.value.split("->"),i=a.shift(),s=a.map(function(e){return function(e){var t=e.split(/[:@]/);return{name:t[1],versionRange:"#"===t[0]?void 0:t[2]||"*",type:"$"===t[0]?"release":"mock"}}(e)});r.add(i);var o=n.find(function(e){return e.presentableName===i});o?function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i={name:e.name,versionRange:e.version,type:e.version?"release":"mock"},s={name:t.name,type:"boolean"==typeof t.customer?"release":"mock",versionRange:t.customer?t.inputVersion:t.selectedVersion},r=a.replaces.find(function(e){return f(i,e.replaced)&&f(s,e.replacer)});if(r)return r.scopes.push(n[0]);a.replaces.push({replaced:i,replacer:s,scopes:n})}(e,t,o,s.length>0?[s]:[]):n.push(function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return{text:"",tags:null,replaces:[{replaced:{name:e.name,versionRange:e.version,type:e.version?"release":"mock"},replacer:{name:t.name,type:"boolean"==typeof t.customer?"release":"mock",versionRange:t.customer?t.inputVersion:t.selectedVersion},scopes:n}],online:null,operation:"alter",presentableName:a}}(e,t,i,s.length>0?[s]:[]))},v=e.scope[Symbol.iterator]();!(o=(d=v.next()).done);o=!0)p()}catch(e){l=!0,u=e}finally{try{o||null==v.return||v.return()}finally{if(l)throw u}}var h=!0,m=!1,g=void 0;try{for(var _,y=function(){var e=_.value,t=n.find(function(t){return t.presentableName===e}),a=t.text;console.log(JSON.stringify(t),"rulerulerulerulerule");var i=Object(c.decompile)([t]);console.log(i,"newTextnewText"),a?s=s.replace(a,i):s+="\n"+i},x=r[Symbol.iterator]();!(h=(_=x.next()).done);h=!0)y()}catch(e){m=!0,g=e}finally{try{h||null==x.return||x.return()}finally{if(m)throw g}}return s}function f(e,t){return console.log(e,t,"obj1, obj2"),e.name===t.name&&e.type===t.type&&e.versionRange===t.versionRange}t.a={name:"index",components:{DepDialog:l.a,Replacer:u.a,Replaced:d.a},props:{matchTestResult:{type:Object,default:function(){return{}}}},data:function(){return{elDialogVisible:!1,dialogVisible:!1,replacer:null,replaced:null,controlShowHide:!0}},methods:{addARelease:function(t){var a=this;return Object(o.coroutine)(r.a.mark(function n(){var i,s,o,l;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i={tags:null,replaces:[],online:null,operation:"add",candidate:{name:t.name,type:"release",versionRange:t.version},presentableName:t.name.replace(/^(.*)\//,"")+"_"+Array(4).fill(null).map(function(e){return Math.floor(36*Math.random()).toString(36)}).join("")},s=Object(c.decompile)([i])+"\n",o=a.$route.params.nodeId,n.next=5,a.$axios.put("/v1/testNodes/".concat(o,"/additionalTestRule"),{testRuleText:e.from(s).toString("base64")});case 5:if(0===(l=n.sent).data.errcode&&0===l.data.ret){n.next=8;break}return n.abrupt("return",a.$message.error(JSON.stringify(l.data.data.errors)));case 8:a.pushRuleSuccess(l.data.data);case 9:case"end":return n.stop()}},n)}))()},addAMock:function(t){var a=this;return Object(o.coroutine)(r.a.mark(function n(){var i,s,o,l;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i={tags:null,replaces:[],online:null,operation:"add",candidate:{name:t.name,type:"mock"},presentableName:t.name.replace(/^(.*)\//,"")+"_"+Array(4).fill(null).map(function(e){return Math.floor(36*Math.random()).toString(36)}).join("")},s=a.$route.params.nodeId,o=Object(c.decompile)([i])+"\n",n.next=5,a.$axios.put("/v1/testNodes/".concat(s,"/additionalTestRule"),{testRuleText:e.from(o).toString("base64")});case 5:if(0===(l=n.sent).data.errcode&&0===l.data.ret){n.next=8;break}return n.abrupt("return",a.$message.error(JSON.stringify(l.data.data.errors)));case 8:a.pushRuleSuccess(l.data.data);case 9:case"end":return n.stop()}},n)}))()},removeARelease:function(){},removeAMock:function(){},replacerChange:function(e){this.replacer=e},replacedChange:function(e){this.replaced=e},confirmReplace:function(){var t=this;return Object(o.coroutine)(r.a.mark(function a(){var n,i,s;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.$route.params.nodeId,i=p(t.replaced,t.replacer,t.matchTestResult),a.next=4,t.$axios.post("/v1/testNodes",{nodeId:n,testRuleText:e.from(i).toString("base64")});case 4:if(0===(s=a.sent).data.errcode&&0===s.data.ret){a.next=7;break}return a.abrupt("return",t.$message.error(JSON.stringify(s.data.msg)));case 7:t.controlShowHide=!1,setTimeout(function(){t.controlShowHide=!0},30),t.pushRuleSuccess(s.data.data);case 10:case"end":return a.stop()}},a)}))()},pushRuleSuccess:function(e){this.$message.success("添加规则成功"),this.$emit("success",e),this.elDialogVisible=!1,this.dialogVisible=!1,this.replacer=null,this.replaced=null}}}}).call(this,a(491).Buffer)},638:function(e,t,a){},639:function(e,t,a){},640:function(e,t,a){},641:function(e,t,a){},642:function(e,t,a){},643:function(e,t,a){},644:function(e,t,a){},645:function(e,t,a){},646:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"ruleType":"规则类型","mappingRuleContent":"映射规则内容","matchResult":"匹配结果","release":"发行","presentable":"展品","operation":"操作","editMappingRules":"编辑映射规则","inputPlaceHolder":"请输入规则","imortBtnText":"导入","batchExportBtnText":"批量导出","exportAllBtnText":"全部导出","batchDeletionBtnText":"批量删除","editBtnText":"编辑","enterBtnText":"进入编辑模式","exitBtnText":"退出编辑模式","saveBtnText":"校验并保存","onlineBtnText":"上线","offlineBtnText":"下线","deleteBtnText":"删除","sureBtnText":"确定","cancalBtnText":"取消","operationsTexts":["新增","；来源","，展示版本 ","设置标签 ","展品状态 上线","展品状态 下线","替换","激活主题","变更","作用域"],"confirmTexts":["是否导出所选的规则？","是否导出全部的规则？","此操作将删除规则","是否继续？","提示","此操作将删除所选中的","条规则","上线规则","下线规则","成功"],"messages":["映射规则保存成功！","映射规则删除成功!"],"errors":["映射规则编译失败：存在语法错误！","映射规则内容存在语法错误：","校验失败，请检查更正后提交:","校验成功，但规则中存在预执行错误:","语句","错误"],"matchResultsTexts":["替换执行结果","替换指令","匹配数量"]},"en":{"ruleType":"Rule type","mappingRuleContent":"Mapping rule content","matchResult":"Match result","release":"release","presentable":"presentable","operation":"Operation","editBtnText":"Edit","enterBtnText":"Enter mapping rules","editMappingRules":"Edit mapping rules","exitBtnText":"Exit edit mode","inputPlaceHolder":"Please enter a rule","imortBtnText":"Import","batchExportBtnText":"Batch export","exportAllBtnText":"Export all","batchDeletionBtnText":"Batch deletion","saveBtnText":"Verify and save","onlineBtnText":"Online","offlineBtnText":"Offline","deleteBtnText":"Delete","sureBtnText":"Sure","cancalBtnText":"Cancel","operationsTexts":["Add","Source","Display version ","Set label ","online","offline","replace","Activate theme","Change","scopes"],"confirmTexts":["Whether to export the selected rule?","Whether to export all rules?","This action will delete the rule","Whether to continue?","Prompt","This will delete the "," rules selected","Online rules","Offline rules"," are successful"],"messages":["The mapping rules are saved successfully!","The mapping rule was deleted successfully!"],"errors":["Mapping rule compilation failed: there is a syntax error！","There is a syntax error in the mapping rule content: ","Validation failed, please check and submit:","Validation succeeded, but there were pre-execution errors in the rule:","statement","error"],"matchResultsTexts":["替换执行结果","替换指令","匹配数量"]}}'),delete e.options._Ctor}},647:function(e,t,a){},648:function(e,t,a){},649:function(e,t,a){},650:function(e,t,a){},651:function(e,t,a){"use strict";(function(e){var n=a(426),i=a.n(n),s=a(87),r=a.n(s),o=a(5),c=a.n(o),l=a(510),u=a(725),d=a(724),p=a(507);a(599);a(604),t.a={name:"MappingRules",data:function(){var e;return{rulesTableData:[],testRulesData:[],editorVisible:!1,lastRulesText:"",rulesText:"",themeId:"",syntaxErrorsText:"",matchErrorsText:"",matchResultsText:"",rulesTextDownloadUrl:"",rulesTextDownloadName:"",selectedRules:[],selectedRuleType:"all",rulesInputRowsCount:18,editorOptions:Object.assign((e={viewportMargin:50},c()(e,"viewportMargin",1/0),c()(e,"theme","idea"),c()(e,"gutters",[]),e),p.a)}},components:{RuleText:d.a,RulesBar:u.a,codemirror:p.b},computed:{rulesOperationConfig:function(){return[{operation:"set",icon:"el-icon-price-tag",desc:"添加标签"},{operation:"online",icon:"el-icon-top",desc:"上线"},{operation:"replace",icon:"el-icon-set-up",desc:"替换"},{operation:"add",icon:"el-icon-plus",desc:"添加"},{operation:"offline",icon:"el-icon-bottom",desc:"下线"},{operation:"all",desc:"全部"}]},nodeId:function(){return this.$route.params.nodeId},targetRulesTableData:function(){var e=this;return"all"===this.selectedRuleType?this.rulesTableData:this.rulesTableData.filter(function(t){return t.operation===e.selectedRuleType})}},watch:{syntaxErrorsText:function(){""===this.syntaxErrorsText?this.rulesInputRowsCount=18:this.rulesInputRowsCount=13},matchErrorsText:function(){""===this.matchErrorsText?this.rulesInputRowsCount=18:this.rulesInputRowsCount=13}},mounted:function(){this.loadMappingRulesTable()},methods:{createFetcher:function(e){var t=this;return e.then(function(e){return e.data}).catch(function(e){return t.$error.showErrorMessage(e)}).then(function(e){return 0!==e.errcode?Promise.reject(e.msg):Promise.resolve(e.data)})},fetchMappingRules:function(){return this.createFetcher(this.$services.TestNodesService.get(this.nodeId))},loadMappingRulesTable:function(){var e=this;return this.fetchMappingRules().then(function(t){e.refreshMappingRules(t)})},resolveTestRules:function(e){for(var t=[],a=["set_tags","alter","add","show","hide","replace"],n=(this.$i18n.t("operationsTexts"),0);n<e.length;n++){var i=e[n],s=i.matchErrors,r=i.ruleInfo,o=i.text,c=i.id,l=r.operation,u=r.online,d=(r.presentableName,{text:o,id:c,ruleInfo:r,matchErrors:s,iconArr:[],online:u});switch(l){case"add":var p=r.tags,f=r.replaces;d.iconArr.push(a[2]),f.length>0&&d.iconArr.push(a[5]),null!=p&&p.length>0&&d.iconArr.push(a[0]),!0===u?d.iconArr.push(a[3]):!1===u&&d.iconArr.push(a[4]);break;case"alter":r.presentableName;var v=r.replaces,h=(r.tags,r.online);d.iconArr.push(a[1]),v.length>0&&d.iconArr.push(a[5]),!0===h?d.iconArr.push(a[3]):!1===h&&d.iconArr.push(a[4])}t.push(d)}this.lastRulesText=this.rulesText,this.rulesTableData=t},refreshMappingRules:function(e){if(null!=e){var t=e.testRules,a=e.ruleText,n=e.themeId;this.testRulesData=t,this.rulesText=a,this.themeId=n,this.resolveTestRules(t)}this.$refs.mrTable.clearSelection()},updateMappingRules:function(t,a){var n=this;try{return t=""===t?t:e.from(t).toString("base64"),this.createFetcher(this.$services.TestNodesService.post({nodeId:this.nodeId,testRuleText:t})).then(function(e){return a&&""!==a&&n.$message({type:"success",message:a}),e})}catch(e){this.$message.error(e)}},rulesSelectionHandler:function(e){this.selectedRules=e},tapEditBtn:function(){this.editorVisible=!0},tapExportBtn:function(){var e=this,t="",a=this.$i18n,n=a.t("confirmTexts");if(this.selectedRules.length>0){t=n[0];var i=this.getRulesDownloadUrl(this.selectedRules),s=r()(i,2),o=s[0],c=s[1];this.rulesTextDownloadUrl=o,this.rulesTextDownloadName=c}else{t=n[1];var l=this.getRulesDownloadUrl(this.rulesTableData),u=r()(l,2),d=u[0],p=u[1];this.rulesTextDownloadUrl=d,this.rulesTextDownloadName=p}this.$confirm(t,n[4],{confirmButtonText:a.t("sureBtnText"),cancelButtonText:a.t("cancalBtnText"),type:"warning"}).then(function(){e.$refs.rulesDownload.click()}).catch(function(){})},tapBatchDeleteBtn:function(){var e=this,t=this.$i18n,a=t.t("confirmTexts");this.selectedRules.map(function(e){return e.content}).join(", ");this.$confirm("".concat(a[5]).concat(this.selectedRules.length).concat(a[6],", ").concat(a[3]),a[4],{dangerouslyUseHTMLString:!0,confirmButtonText:t.t("sureBtnText"),cancelButtonText:t.t("cancalBtnText"),type:"warning"}).then(function(){e.deleteMappingRules(e.selectedRules)}).catch(function(){})},tapDeleteBtn:function(e){var t=this,a=this.$i18n,n=a.t("confirmTexts");this.$confirm("".concat(n[2]," “").concat(e.content,"”，").concat(n[3]),n[4],{dangerouslyUseHTMLString:!0,confirmButtonText:a.t("sureBtnText"),cancelButtonText:a.t("cancalBtnText"),type:"warning"}).then(function(){t.deleteMappingRules([e])}).catch(function(){})},deleteMappingRules:function(e){var t=this,a=new Set(e.map(function(e){return e.id})),n=this.rulesTableData.filter(function(e){return!a.has(e.id)}).map(function(e){return e.text}).join("\n");this.updateMappingRules(n,this.$i18n.t("messages[1]")).then(function(e){t.refreshMappingRules(e)})},exchangeOnlineStatus:function(e,t){var a=this,n=this.$i18n,i=n.t("confirmTexts"),s=t?i[7]:i[8];this.$confirm("".concat(s," “").concat(e.content,"”, ").concat(i[3]),i[4],{dangerouslyUseHTMLString:!0,confirmButtonText:n.t("sureBtnText"),cancelButtonText:n.t("cancalBtnText"),type:"warning"}).then(function(){var n=a.rulesTableData.map(function(a){return a.id===e.id?(a.ruleInfo.online=t,Object(l.decompile)([a.ruleInfo])):a.text}).join("\n");return a.updateMappingRules(n,"".concat(s).concat(i[9],"！")).then(function(e){a.refreshMappingRules(e)})}).catch(function(e){return console.warn(e)})},getRulesDownloadUrl:function(e){var t=e.map(function(e){return e.text}).join("\n"),a="测试节点.映射规则.".concat(this.nodeId,".txt"),n=new File([t],a,{type:"text/plain"});return[window.URL.createObjectURL(n),a]},tapBackBtn:function(){this.editorVisible=!1,this.rulesText=this.lastRulesText,this.syntaxErrorsText="",this.matchErrorsText=""},tapSaveBtn:function(){var e=this;try{var t=Object(l.compile)(this.rulesText);console.log(t)}catch(e){console.error(e)}return null==t?(this.syntaxErrorsText='<li class="mr-syntax-error">'.concat(this.$i18n.t("errors[0]"),"</li>"),void(this.matchErrorsText="")):null!=t.errors?(this.syntaxErrorsText=t.errorObjects.map(function(t){var a=t.lineText,n=void 0===a?"":a,i=t.line,s=void 0===i?-1:i,r=t.col,o=void 0===r?-1:r,c=t.msg,l=void 0===c?"":c;return'<li class="mr-syntax-error">'+(-1===s||-1===o?"":"<p>".concat(e.$i18n.t("errors[4]"),": line ").concat(s,", col ").concat(o," ").concat(n,"</p>"))+"<p>".concat(e.$i18n.t("errors[5]"),": ").concat(l,"</p>")+"</li>"}).join(""),void(this.matchErrorsText="")):(this.syntaxErrorsText="",void this.updateMappingRules(this.rulesText).then(function(t){var a=t.testRules;e.resolveMatchErrors(a),e.resolveMatchResults(a),""===e.matchErrorsText&&e.$message.success(e.$i18n.t("messages[0]")),e.refreshMappingRules(t)}))},resolveMatchErrors:function(e){var t=this,a="",n=[];e.forEach(function(e){e.matchErrors.length>0&&(n=[].concat(i()(n),[{text:e.text,error:e.matchErrors.join(", ")}]))}),n.length>0&&(a=n.map(function(e){return'<li class="mr-match-error">\n\t\t\t\t\t\t\t\t\t\t<p>'.concat(t.$i18n.t("errors[4]"),": ").concat(e.text,"</p>\n\t\t\t\t\t\t\t\t\t\t<p>").concat(t.$i18n.t("errors[5]"),": ").concat(e.error,"</p>\t\n\t\t\t\t\t\t\t\t\t</li>")}).join("")),this.matchErrorsText=a},resolveMatchResults:function(e){var t="",a="zh-CN"===this.$i18n.locale?"，":", ",n=this.$i18n.t("operationsTexts"),i=this.$i18n.t("matchResultsTexts"),s=!0,r=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var u=c.value.ruleInfo.replaces;u&&u.length>0&&(t+=u.map(function(e){var t,s,r=e.replaced,o=e.replacer,c=e.scopes,l=void 0===c?[]:c,u=e.efficientCount,d=void 0===u?0:u,p="";return l.length>0&&(p="".concat(a,"<span>").concat(n[9],"</span> ")+l.flat(1/0).map(function(e){return"<strong>".concat(e.name,"</strong>")}).join("-")),t=o.name+("*"===o.versionRange?"":"@".concat(o.versionRange)),s=r.name+("*"===r.versionRange?"":"@".concat(r.versionRange)),'<li class="mr-match-result">\n\t\t\t\t\t\t\t\t\t\t<p>'.concat(i[1],": ").concat(t," ").concat(n[6]," ").concat(s).concat(p,"</p>\n\t\t\t\t\t\t\t\t\t\t<p>").concat(i[2],": ").concat(d,"</p>\t\n\t\t\t\t\t\t\t\t\t</li>")}).join(""))}}catch(e){r=!0,o=e}finally{try{s||null==l.return||l.return()}finally{if(r)throw o}}this.matchResultsText=t},handleSelectType:function(e){this.selectedRuleType=e},rulesImportHandler:function(e){var t=this,a=new FileReader;a.readAsText(e.raw),a.onload=function(e){var a=e.target.result,n=Object(l.compile)(a);null!=n.errors?t.$message.error({dangerouslyUseHTMLString:!0,duration:5e3,message:t.$i18n.t("errors[1]")+"<br/>"+n.errors.join("<br/>")}):(t.rulesText=t.rulesText+"\n"+a,t.editorVisible=!0)},a.onerror=function(e){console.log("evt --",e)}},onCodeChange:function(e){this.rulesText=e}}}}).call(this,a(491).Buffer)},652:function(e,t,a){},653:function(e,t,a){},654:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"ruleType":"规则类型","mappingRuleContent":"映射规则内容","matchResult":"匹配结果","release":"发行","presentable":"展品","operation":"操作","editMappingRules":"编辑映射规则","inputPlaceHolder":"请输入规则","imortBtnText":"导入","batchExportBtnText":"批量导出","exportAllBtnText":"全部导出","batchDeletionBtnText":"批量删除","editBtnText":"编辑","enterBtnText":"进入编辑模式","exitBtnText":"退出编辑模式","saveBtnText":"校验并保存","onlineBtnText":"上线","offlineBtnText":"下线","deleteBtnText":"删除","sureBtnText":"确定","cancalBtnText":"取消","operationsTexts":["新增","；来源","，展示版本 ","设置标签 ","展品状态 上线","展品状态 下线","替换","激活主题","变更","作用域"],"confirmTexts":["是否导出所选的规则？","是否导出全部的规则？","此操作将删除规则","是否继续？","提示","此操作将删除所选中的","条规则","上线规则","下线规则","成功"],"messages":["映射规则保存成功！","映射规则删除成功!"],"errors":["映射规则编译失败：存在语法错误！","映射规则内容存在语法错误：","校验失败，请检查更正后提交:","校验成功，但规则中存在预执行错误:","语句","错误"],"matchResultsTexts":["替换执行结果","替换指令","匹配数量"]},"en":{"ruleType":"Rule type","mappingRuleContent":"Mapping rule content","matchResult":"Match result","release":"release","presentable":"presentable","operation":"Operation","editBtnText":"Edit","enterBtnText":"Enter mapping rules","editMappingRules":"Edit mapping rules","exitBtnText":"Exit edit mode","inputPlaceHolder":"Please enter a rule","imortBtnText":"Import","batchExportBtnText":"Batch export","exportAllBtnText":"Export all","batchDeletionBtnText":"Batch deletion","saveBtnText":"Verify and save","onlineBtnText":"Online","offlineBtnText":"Offline","deleteBtnText":"Delete","sureBtnText":"Sure","cancalBtnText":"Cancel","operationsTexts":["Add","Source","Display version ","Set label ","online","offline","replace","Activate theme","Change","scopes"],"confirmTexts":["Whether to export the selected rule?","Whether to export all rules?","This action will delete the rule","Whether to continue?","Prompt","This will delete the "," rules selected","Online rules","Offline rules"," are successful"],"messages":["The mapping rules are saved successfully!","The mapping rule was deleted successfully!"],"errors":["Mapping rule compilation failed: there is a syntax error！","There is a syntax error in the mapping rule content: ","Validation failed, please check and submit:","Validation succeeded, but there were pre-execution errors in the rule:","statement","error"],"matchResultsTexts":["替换执行结果","替换指令","匹配数量"]}}'),delete e.options._Ctor}},655:function(e,t,a){},656:function(e,t,a){},657:function(e,t,a){},658:function(e,t,a){},659:function(e,t,a){},714:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"policy-input-item",class:[{"disabled-policy":e.disabledPolicy,"published-policy":!!e.policy.segmentId},e.mode+"-mode"]},[a("div",{staticClass:"policy-name-input-item clearfix"},[a("div",{staticClass:"policy-name-input-placeholder"},[a("pre",{staticClass:"policy-name-pre"},[e._v(e._s(e.policy.policyName))]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.policy.policyName,expression:"policy.policyName"}],staticClass:"policy-name-input",attrs:{type:"text",maxlength:"19",disabled:e.disabledPolicy},domProps:{value:e.policy.policyName},on:{blur:e.changePolicyNameHandler,input:function(t){t.target.composing||e.$set(e.policy,"policyName",t.target.value)}}})]),e._v(" "),a("div",{staticClass:"policy-actions-btn"},[!1===e.disabledPolicy?a("el-button",{staticClass:"off-line-btn",attrs:{round:"",size:"mini"},on:{click:function(t){return e.switchPolicyStatusHandler(!0)}}},[e._v(e._s(e.$t("components.policyEditor.offline"))+"\n        ")]):e._e(),e._v(" "),!0===e.disabledPolicy?a("el-button",{staticClass:"on-line-btn",attrs:{round:"",size:"mini"},on:{click:function(t){return e.switchPolicyStatusHandler(!1)}}},[e._v(e._s(e.$t("components.policyEditor.online"))+"\n        ")]):e._e()],1),e._v(" "),a("div",{staticClass:"policy-toolbar"},[a("ul",{staticClass:"tool-list"},[a("li",[a("el-button",{staticClass:"op-btn",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.showToolHandler("policy-template-selector")}}},[a("i",{staticClass:"el-icon-tickets"}),e._v(e._s(e.$t("components.policyEditor.template"))+"\n            ")])],1),e._v(" "),a("li",[a("el-button",{staticClass:"op-btn",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.showToolHandler("query-policy-license")}}},[a("i",{staticClass:"el-icon-search"}),e._v("license\n            ")])],1)])])]),e._v(" "),a("div",{staticClass:"policy-content-input-wrap policy-editing clearfix"},[a("div",{staticClass:"policy-content-input-padding"},[e.policy.policyId?a("div",{staticClass:"policy-text",domProps:{innerHTML:e._s(e.policy.policyText)}}):[a("div",{staticClass:"policy-input-area"},[a("div",{staticClass:"input-placeholder"},[e._v(e._s(e.policy.policyText))]),e._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.policy.policyText,expression:"policy.policyText"}],staticClass:"policy-content-input",attrs:{spellcheck:"false",placeholder:e.$t("components.policyEditor.policyPlaceholder")},domProps:{value:e.policy.policyText},on:{change:function(t){return e.changePolicyText(e.policy)},input:function(t){t.target.composing||e.$set(e.policy,"policyText",t.target.value)}}})])]],2),e._v(" "),e.showFooterBtns&&"preview"!==e.mode?a("div",{staticClass:"policy-content-input-ft"},[a("el-button",{attrs:{round:"",size:"mini"},on:{click:e.cancelPolicyHandler}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),!1===e.autoSave?a("el-button",{attrs:{round:"",size:"mini",type:"primary"},on:{click:e.savePolicyHandler}},[e._v(e._s(e.$t("common.save")))]):e._e()],1):e._e()])]),e._v(" "),a("el-dialog",{attrs:{title:e.$t("components.policyEditor.selectPolicyTitle"),visible:e.showCustomPolicyTplDialog,width:"50%"},on:{"update:visible":function(t){e.showCustomPolicyTplDialog=t}}},[a("keep-alive",[a(e.currentTool,{tag:"component",attrs:{callback:e.operationCallback}})],1)],1)],1)};n._withStripped=!0;var i=a(90),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"margin-bottom":"15px"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:e.$t("components.policyEditor.inputPlaceholder")},model:{value:e.queryPolicyTpl,callback:function(t){e.queryPolicyTpl=t},expression:"queryPolicyTpl"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.tabClickHandler},model:{value:e.currentTabName,callback:function(t){e.currentTabName=t},expression:"currentTabName"}},[a("el-tab-pane",{attrs:{label:e.$t("components.policyEditor.demoTpl"),name:"official"}},[a("policy-tpl-list",{attrs:{list:e.defaultPolicyTpls,filter:e.filterHandler},on:{select:e.selectPolicyTplHandler}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.$t("components.policyEditor.myTpl"),name:"mine"}},[a("policy-tpl-list",{attrs:{list:e.policyTpls,filter:e.filterHandler},on:{select:e.selectPolicyTplHandler}})],1)],1)],1)};s._withStripped=!0;var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-table",{attrs:{data:e.tplList,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"name",label:e.$t("components.policyTplSelector.name")}}),e._v(" "),a("el-table-column",{attrs:{label:"",align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(a){return e.handleSelect(t.row)}}},[e._v(e._s(e.$t("components.policyTplSelector.operation"))+"\n        ")])]}}])})],1)],1)};r._withStripped=!0;var o=a(86),c=a.n(o),l=a(497),u=a(489),d={name:"policy-tpl-select-list",data:function(){return{}},props:{list:{type:Array,default:function(){return[]}},filter:{type:Function}},components:{TableView:l.a},computed:{tplList:function(){return this.filter?this.filter(this.list):this.list}},mounted:function(){},methods:{resolveType:function(e){return u.b(e)},resolveStatus:function(e){return u.a(e)},handleSelect:function(e){this.$emit("select",c()({},e))}}},p=a(3),f=Object(p.a)(d,r,[],!1,null,null,null);f.options.__file="src/components/policyTplSelector/index.vue";var v=f.exports,h=a(4),m=a(477),g={name:"policy-template-selector",data:function(){return{currentTabName:h.e.get("POLICY_TPL_ACTIVE_TAB_NAME")||"official",policyTpls:[],queryPolicyTpl:"",defaultPolicyTpls:"node"===this.$route.meta.type?m.b:m.c}},props:{callback:{type:Function}},components:{PolicyTplList:v},mounted:function(){var e=this;this.loadCustomPolicyTpl().then(function(t){e.policyTpls=t})},methods:{loadCustomPolicyTpl:function(){return this.$services.policyTemplate.get({params:{templateType:1,pageSize:100}}).then(function(e){var t=e.getData();if(t)return t.dataList;throw new Error(e.data.msg)})},selectPolicyTplHandler:function(e){"function"==typeof this.callback&&this.callback({name:"selectPolicyTemplate",data:e})},filterHandler:function(e){var t=this;return e.filter(function(e){return!t.queryPolicyTpl||e.name.indexOf(t.queryPolicyTpl)>-1})},tabClickHandler:function(e){h.e.set("POLICY_TPL_ACTIVE_TAB_NAME",e.name)}}},_=Object(p.a)(g,s,[],!1,null,null,null);_.options.__file="src/components/PolicyEditor/tool/policyTpl.vue";var y=_.exports,x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-autocomplete",{staticClass:"search-input",attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:e.$t("components.policyEditor.licensePlaceholder")},on:{select:e.handleSelect},model:{value:e.queryInput,callback:function(t){e.queryInput=t},expression:"queryInput"}},[a("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"prefix"},slot:"prefix"}),e._v(" "),a("clip-board",{staticStyle:{display:"inline-block","margin-left":"-8px"},attrs:{slot:"append",value:e.selectedLicenseId},on:{copyDone:e.copyDoneHandler},slot:"append"},[a("el-button",{attrs:{type:"primary",plain:"",disabled:!e.selectedLicenseId}},[a("i",{staticClass:"el-icon-fa-clipboard"})])],1)],1),e._v(" "),a("pre",{staticClass:"license-content"},[e._v("    "+e._s(e.licenseContent)+"\n  ")])],1)};x._withStripped=!0;var b={name:"query-policy-license",data:function(){return{licenses:[],queryInput:"",licenseContent:"",selectedLicenseId:"",licenseMap:{}}},components:{ClipBoard:a(498).a},props:{callback:{type:Function}},mounted:function(){this.licenses=this.loadAll()},methods:{copyDoneHandler:function(){this.selectedLicenseId&&(this.$message.success(this.$t("components.policyEditor.copyDone")),"function"==typeof this.callback&&this.callback({name:"selectLicenseId",data:{licenseId:this.selectedLicenseId}}))},loadAll:function(){var e=this;this.$axios.get("/v1/resources/warehouse?resourceType=license").then(function(t){e.licenses=t.data.data.dataList.map(function(e){return{value:e.resourceName,id:e.resourceId}})})},querySearchAsync:function(e,t){var a=this.licenses;t(e?a.filter(this.createStateFilter(e)):a)},createStateFilter:function(e){var t=e.toLowerCase(),a=new RegExp(t,"i");return function(e){return a.test(e.value)||a.test(e.id)}},handleSelect:function(e){this.selectedLicenseId=e.id,this.showLicenseContent(e)},showLicenseContent:function(e){var t=this,a=e.id;this.licenseMap[a]?this.licenseContent=this.licenseMap[a]:this.$axios.get("/v1/auths/resource/".concat(a,".data")).then(function(e){e.getData()?(t.licenseContent=e.getData(),t.licenseMap[a]=t.licenseContent):t.$message.error(e.data.msg)})}}},w=(a(622),Object(p.a)(b,x,[],!1,null,"849fd260",null));w.options.__file="src/components/PolicyEditor/tool/queryLicense.vue";var S=w.exports,T={name:"policy-editor",data:function(){return{showCustomPolicyTplDialog:!1,currentTool:"",mode:"edit"}},props:{policy:{type:Object,default:function(){return{}}},showValidate:{type:Boolean,default:function(){return!0}},autoSave:{type:Boolean,default:!1},showFooterBtns:{type:Boolean,default:!0}},computed:{disabledPolicy:function(){return 0===this.policy.status}},components:{PolicyTemplateSelector:y,QueryPolicyLicense:S},watch:{policy:function(){this.resolvePolicy(this.policy)}},mounted:function(){this.resolvePolicy(this.policy)},methods:{resolvePolicy:function(e){if(e.policyId){this.mode="preview";var t=e.policyText;Object(i.b)(t).errorMsg||(t=Object(i.c)(t)),Object.assign(this.policy,{policyName:e.policyName||"",policyText:t,policySegmentId:e.policyId,disabled:0===e.status})}},validate:function(){var e=Object(i.b)(this.policyText);e.errorMsg?(this.$emit("validate",{done:!1,error:{message:e.errorMsg}}),this.$message.error(e.errorMsg)):(this.policyText=Object(i.c)(this.policyText),this.$emit("input",this.policyText),this.$emit("validate",{done:!0}))},showToolHandler:function(e){this.currentTool=e,this.showCustomPolicyTplDialog=!0},operationCallback:function(e){if(this.showCustomPolicyTplDialog=!1,e&&e.name){var t="".concat(e.name,"Callback");"function"==typeof this[t]&&this[t](e.data),this.$emit("input",this.policyText)}},selectPolicyTemplateCallback:function(e){this.policy.policyText=e.template,this.policy.policyName=e.name},selectLicenseIdCallback:function(e){this.policy.policyText+=" ".concat(e.licenseId)},changePolicyText:function(e){this.autoSave&&this.savePolicyHandler()},switchPolicyStatusHandler:function(){var e=this,t=this.policy;t.policySegmentId&&this.$confirm(this.$t("components.policyEditor.switchTip",{statusText:t.disabled?"上":"下",policyName:t.policyName})).then(function(){t.disabled=!e.disabledPolicy,e.$emit("save",e.policy)}).catch(function(){})},changePolicyNameHandler:function(){this.policy.policySegmentId&&this.$emit("save",this.policy)},cancelPolicyHandler:function(){this.$emit("cancel",this.policy)},savePolicyHandler:function(){this.$emit("save",this.policy)}}},C=(a(623),Object(p.a)(T,n,[],!1,null,"84870d9c",null));C.options.__file="src/components/PolicyEditor/index.vue";t.a=C.exports},716:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"policy-list"},[a("div",{staticClass:"policy-list-wrapper"},[a("div",{staticClass:"p-l-main-content clearfix",class:{"no-overflow":e.formatedPolicyList.length<4}},[a("div",{staticStyle:{position:"relative",display:"inline-block",transition:"all .3s","white-space":"nowrap"},style:{transform:"translateX(-"+e.policyTranslateX+"px)"}},[e._l(e.formatedPolicyList,function(t,n){return a("div",{key:t.policyId,staticClass:"p-l-item"},[a("div",{staticClass:"p-l-item-head"}),e._v(" "),a("div",{staticClass:"p-l-card",class:{disabled:0==t.status}},[a("h5",[a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"p-l-status p-l-s-top"},[a("i",{staticClass:"el-icon-download"})]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.status,expression:"policy.status == 0"}],staticClass:"p-l-status p-l-s-disabled"},[a("i",{staticClass:"el-icon-error"})]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.status,expression:"policy.status == 1"}],staticClass:"p-l-status p-l-s-active"},[a("i",{staticClass:"el-icon-success"})]),e._v("\n\t\t\t\t\t\t\t\t"+e._s(t.policyName)+"\n\t\t\t\t\t\t\t")]),e._v(" "),t.policyId?a("pre",{staticClass:"policy-text",domProps:{innerHTML:e._s(t.policyText)}}):e._e()]),e._v(" "),a("el-dropdown",{attrs:{size:"small"},on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-more"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[0==t.status?a("el-dropdown-item",{attrs:{command:n+"-1"}},[e._v(e._s(e.$t("enableBtnText")))]):e._e(),e._v(" "),1==t.status?a("el-dropdown-item",{attrs:{command:n+"-0"}},[e._v(e._s(e.$t("disableBtnText")))]):e._e()],1)],1),e._v(" "),a("i",{staticClass:"p-l-expand-btn el-icon-full-screen",on:{click:function(t){return e.expandPolicyHandler(n,t)}}})],1)}),e._v(" "),e.formatedPolicyList.length<=e.visibleCardCount?a("div",{staticClass:"policy-item-add-tbn pia-btn1",on:{click:e.addPolicy}},[a("i",{staticClass:"el-icon-circle-plus"})]):e._e()],2)]),e._v(" "),e.navItems.length>1?a("ul",{staticClass:"p-l-list-nav-bar"},[a("span",{directives:[{name:"show",rawName:"v-show",value:0!==e.navActiveIndex,expression:"navActiveIndex !== 0"}],staticClass:"pll-nav-btn",on:{click:e.tapPrevBtn}},[e._v("上一页")]),e._v(" "),e._l(e.navItems,function(t,n){return a("li",{key:n,class:{active:e.navActiveIndex===n},on:{click:function(t){return e.exchangeNacActiveIndex(n)}}})}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.navActiveIndex!==e.navItems.length-1,expression:"navActiveIndex !== (navItems.length - 1)"}],staticClass:"pll-nav-btn",on:{click:e.tapNextBtn}},[e._v("下一页")]),e._v(" "),a("span",[e._v("（共"+e._s(e.formatedPolicyList.length)+"条策略）")])],2):e._e(),e._v(" "),e.formatedPolicyList.length>e.visibleCardCount?a("div",{staticClass:"policy-item-add-tbn pia-btn2",on:{click:e.addPolicy}},[a("i",{staticClass:"el-icon-circle-plus"})]):e._e()]),e._v(" "),e.isExpandPolicy?a("div",{staticStyle:{position:"fixed",top:"0",right:"0",bottom:"0",left:"0","background-color":"rgba(0,0,0,.5)","z-index":"99"}}):e._e(),e._v(" "),e.isExpandPolicy?a("div",{staticStyle:{position:"fixed","font-size":"14px",color:"#333","background-color":"#fff",transition:"top 1s, width 1s , height 1s, left 1s","z-index":"100"},style:e.enlargedDisplayBox},[a("div",{staticStyle:{"font-weight":"600","line-height":"35px",padding:"0 20px",display:"flex","justify-content":"space-between","align-items":"center"}},[a("span",[e._v(e._s(e.formatedPolicyList[e.expandedPolicyIndex].policyName))]),e._v(" "),a("i",{staticClass:"el-icon-circle-close",staticStyle:{"font-size":"16px"},on:{click:function(t){e.isExpandPolicy=!1}}})]),e._v(" "),a("pre",{staticStyle:{padding:"0 20px","white-space":"pre-wrap"}},[e._v(e._s(e.formatedPolicyList[e.expandedPolicyIndex].policyText))])]):e._e()])};n._withStripped=!0;var i=a(87),s=a.n(i),r=a(90),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"p-l-item"},[a("div",{staticClass:"p-l-item-head"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"p-l-status p-l-s-top"},[a("i",{staticClass:"el-icon-download"}),e._v("\n      "+e._s(e.$t("status[0]"))+"\n    ")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.policy.status,expression:"policy.status == 0"}],staticClass:"p-l-status p-l-s-disabled"},[a("i",{staticClass:"el-icon-error"}),e._v("\n      "+e._s(e.$t("status[1]"))+"\n    ")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.policy.status,expression:"policy.status == 1"}],staticClass:"p-l-status p-l-s-active"},[a("i",{staticClass:"el-icon-success"}),e._v("\n      "+e._s(e.$t("status[2]"))+"\n    ")])]),e._v(" "),a("div",{staticClass:"p-l-card",staticStyle:{transition:"width 2s, height 2s"},style:{width:(e.show?800:230)+"px",height:(e.show?185:300)+e.px}},[a("h5",[e._v(e._s(e.policy.policyName))]),e._v(" "),e.policy.policyId?a("pre",{staticClass:"policy-text",domProps:{innerHTML:e._s(e.policy.policyText)}}):e._e()]),e._v(" "),a("el-dropdown",{attrs:{size:"small"},on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-more"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[0==e.policy.status?a("el-dropdown-item",{attrs:{command:1}},[e._v(e._s(e.$t("enableBtnText")))]):e._e(),e._v(" "),1==e.policy.status?a("el-dropdown-item",{attrs:{command:0}},[e._v(e._s(e.$t("disableBtnText")))]):e._e()],1)],1),e._v(" "),a("i",{staticClass:"p-l-expand-btn el-icon-rank",on:{click:e.expandPolicyHandler}})],1)};o._withStripped=!0;var c={name:"Item",props:{show:{type:Boolean,default:!1},policy:{type:Object,status:0,policyName:"",policyId:"",policyText:""},handleCommand:{type:Function,default:function(){}},expandPolicyHandler:{type:Function,default:function(){}}}},l=(a(624),a(3)),u=a(625),d=Object(l.a)(c,o,[],!1,null,"c9c3f2b8",null);"function"==typeof u.default&&Object(u.default)(d),d.options.__file="src/components/PolicyList/list/PolicyCard.vue";var p={name:"policy-list",components:{PolicyCard:d.exports},props:{policyList:{type:Array,default:function(){return[]}}},data:function(){return{visibleCardCount:3,cardActiveIndex:0,navActiveIndex:0,expandedPolicyIndex:0,isExpandPolicy:!1,enlargedDisplayBox:{top:0,left:0,width:0,height:0}}},computed:{navItems:function(){var e=Math.ceil(this.formatedPolicyList.length/this.visibleCardCount);return console.log(new Array(e).fill(1)),new Array(e).fill(1)},formatedPolicyList:function(){return this.policyList.filter(function(e){return e.policyId}).map(function(e){return e.policyText=Object(r.a)(e.policyText),e})},policyTranslateX:function(){return 301*this.cardActiveIndex},expandedPolicy:function(){return this.formatedPolicyList[this.expandedPolicyIndex]}},methods:{exchangeNacActiveIndex:function(e){this.navActiveIndex=e,this.cardActiveIndex=e*this.visibleCardCount},tapPrevBtn:function(){this.navActiveIndex=this.navActiveIndex-1,this.navActiveIndex=this.navActiveIndex<0?0:this.navActiveIndex,this.cardActiveIndex=this.navActiveIndex*this.visibleCardCount},tapNextBtn:function(){this.navActiveIndex=this.navActiveIndex+1,this.navActiveIndex=this.navActiveIndex===this.navItems.length?this.navItems.length-1:this.navActiveIndex,this.cardActiveIndex=this.navActiveIndex*this.visibleCardCount},addPolicy:function(){this.$emit("add-policy")},expandPolicyHandler:function(e,t){var a=this;this.isExpandPolicy=!0,this.expandedPolicyIndex=e;var n=t.target.parentNode.getBoundingClientRect(),i=n.top,s=n.width,r=n.height,o=n.left;this.enlargedDisplayBox={top:i+"px",width:s+"px",height:r+"px",left:o+"px"},setTimeout(function(){a.enlargedDisplayBox={top:window.innerHeight/2-300+"px",left:window.innerWidth/2-200+"px",width:"400px",height:"600px"}},30)},handleCommand:function(e){console.log(e,"commandcommandcommand");var t=e.split("-"),a=s()(t,2),n=a[0],i=a[1];0!==(i=+i)&&1!==i||this.updatePolicyStatus(this.policyList[n],i)},updatePolicyStatus:function(e,t){this.$emit("update-policies",{policyName:e.policyName,status:t,policyId:e.policyId})}},created:function(){},watch:{isExpandPolicy:function(e){window.document.body.style.overflowY=e?"hidden":"auto"}}},f=(a(626),a(627)),v=Object(l.a)(p,n,[],!1,null,null,null);"function"==typeof f.default&&Object(f.default)(v),v.options.__file="src/components/PolicyList/list/index.vue";t.a=v.exports},721:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a",{staticStyle:{width:"14px",height:"14px","border-radius":"50%",border:"1px solid #c8c8c8",display:"flex","align-items":"center","justify-content":"center",cursor:"pointer"},on:{click:function(t){return e.$emit("click")}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"selected"}],staticStyle:{width:"8px",height:"8px","background-color":"#409eff","border-radius":"50%"}})])};n._withStripped=!0;var i={name:"Radio",props:{selected:{type:Boolean,default:!1}}},s=a(3),r=Object(s.a)(i,n,[],!1,null,"e3fc20c6",null);r.options.__file="src/views/node/test-manager/AddAndReplace/components/Radio.vue";t.a=r.exports},724:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"node-mapping-rule-text",class:{disabled:e.matchErrors.length},domProps:{innerHTML:e._s(e.content)}}),e._v(" "),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{staticClass:"node-mapping-rt-tip",attrs:{slot:"content"},domProps:{innerHTML:e._s(e.matchErrorsText)},slot:"content"}),e._v(" "),e.matchErrors.length?a("i",{staticClass:"el-icon-warning"}):e._e()])],1)};n._withStripped=!0;var i={name:"rule-text",props:{textRule:Object},data:function(){return{content:"",tagsMap:{mock:'<span class="t-rule-tag-mock">mock</span>',release:'<span class="t-rule-tag-release">'.concat(this.$i18n.t("release"),"</span>"),presentable:'<span class="t-rule-tag-presentable">'.concat(this.$i18n.t("presentable"),"</span>")}}},computed:{matchErrors:function(){return null!=this.textRule?this.textRule.matchErrors:[]},matchErrorsText:function(){return this.matchErrors.filter(function(e){return""!==e}).map(function(e,t){return"".concat(t+1,". ").concat(e)}).join("<br/>")},ruleInfo:function(){return this.textRule.ruleInfo}},watch:{textRule:function(){this.resolveTextRule()}},mounted:function(){this.resolveTextRule()},methods:{resolveTextRule:function(){var e=this.ruleInfo,t=e.operation,a=e.replaces,n=[];switch(t){case"add":n.push(this.resolveAddRule()),a&&a.length>0&&n.push(this.resolveReplaceRule()),n.push(this.resolveSetTagRule());break;case"alter":n.push(this.resolveAlterRule()),n.push(this.resolveReplaceRule()),n.push(this.resolveSetTagRule());break;case"activate_theme":n.push(this.resolveActivateTheme())}n.push(this.resolveOnlineRule());var i="zh-CN"===this.$i18n.locale?"；":"; ";this.content=n.filter(function(e){return""!==e}).join(i)},resolveAddRule:function(){var e=this.ruleInfo,t=e.presentableName,a=e.candidate,n=a.name,i=a.type,s=this.$i18n.t("operationsTexts"),r=this.resolveSetVersionRule();return"".concat(s[0]).concat(this.tagsMap.presentable,"<strong>").concat(t,"</strong>").concat(s[1]).concat(this.tagsMap[i],"<strong>").concat(n,"</strong>").concat(r)},resolveSetVersionRule:function(){var e=this.ruleInfo.candidate.versionRange,t=void 0===e?"":e,a=this.$i18n.t("operationsTexts");return""!==t&&"latest"!==t?"".concat(a[2]," ").concat(t):""},resolveAlterRule:function(){var e=this.$i18n.t("operationsTexts"),t=this.ruleInfo.presentableName;return"".concat(e[8]).concat(this.tagsMap.presentable,"<strong>").concat(t,"</strong>")},resolveReplaceRule:function(){var e=this,t=this.ruleInfo.replaces;if(t.length>0){var a=this.$i18n.t("operationsTexts"),n="zh-CN"===this.$i18n.locale?"，":", ";return t.map(function(t){var i=t.replacer,s=i.name,r=i.type,o=i.versionRange,c=t.replaced,l=c.name,u=c.type,d=c.versionRange,p=null==o||"*"===o?"":"@".concat(o),f=null==d||"*"===d?"":"@".concat(d),v="<strong>".concat(e.tagsMap[r]).concat(s).concat(p,"</strong> ").concat(a[6]," <strong>").concat(e.tagsMap[u]).concat(l).concat(f,"</strong>");return t.scopes.length>0&&(v+="".concat(n,"<span>").concat(a[9],"</span> ")+t.scopes.flat(1/0).map(function(t){var a=t.name,n=t.type;return"".concat(e.tagsMap[n],"<strong>").concat(a,"</strong>")}).join("-")),v}).join(n)}return""},resolveSetTagRule:function(){var e=this.ruleInfo.tags;if(null!=e&&e.length>0){var t=this.$i18n.t("operationsTexts"),a="zh-CN"===this.$i18n.locale?"，":", ";return"".concat(t[3])+e.map(function(e){return"<strong>".concat(e,"</strong>")}).join(a)}return""},resolveOnlineRule:function(){var e=this.ruleInfo,t=e.online,a=(e.presentableName,this.$i18n.t("operationsTexts"));return!0===t?a[4]:!1===t?a[5]:""},resolveActivateTheme:function(){var e=this.ruleInfo.themeName,t=this.$i18n.t("operationsTexts");return"".concat(t[7]).concat(this.tagsMap.presentable,"<strong>").concat(e,"</strong>")}}},s=(a(879),a(880),a(3)),r=a(881),o=Object(s.a)(i,n,[],!1,null,"5d498de8",null);"function"==typeof r.default&&Object(r.default)(o),o.options.__file="src/views/node/components/rule-text.vue";t.a=o.exports},725:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rules-bar"},[e._l(e.rules,function(t){return a("i",{staticClass:"freelog",class:e.getIconClass(t)})}),e._v(" "),0===e.rules.length?a("div"):e._e()],2)};n._withStripped=!0;var i={name:"RulesBar",props:{rules:{type:Array,default:function(){return[]}}},methods:{getIconClass:function(e){switch(e){case"add":return"fl-icon-add";case"alter":return"fl-icon-edit";case"replace":return"fl-icon-replace";case"hide":return"fl-icon-outline";case"show":return"fl-icon-online";case"set_tags":return"fl-icon-tag";default:return""}}}},s=(a(878),a(3)),r=Object(s.a)(i,n,[],!1,null,"f906edbc",null);r.options.__file="src/views/node/components/RulesBar.vue";t.a=r.exports},748:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"overview-header",staticStyle:{padding:"20px",display:"flex","box-sizing":"border-box","box-shadow":"0 3px 8px 0 rgba(0,0,0,0.2)","border-radius":"10px"}},[a("img",{staticClass:"resource-default-preview",staticStyle:{width:"88px",height:"66px","flex-shrink":"0"},attrs:{src:e.previewSrc||void 0}}),e._v(" "),a("div",{staticStyle:{display:"flex","flex-shrink":"1",width:"100%","flex-direction":"column","justify-content":"space-between","box-sizing":"border-box","padding-left":"20px"}},[a("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[a("a",{staticStyle:{"align-items":"center",display:"flex"},attrs:{target:"_blank",href:"release"===e.type?"/release/detail/"+e.theID+"?version="+e.version:"/mock/update/"+e.theID}},[a("span",{staticStyle:{"font-size":"18px",color:"#222","line-height":"1"}},[e._v(e._s(e.title))]),e._v(" "),"release"===e.type?a("label",{staticStyle:{"background-color":"#72bb1f","font-size":"12px","font-weight":"600",color:"#fff","text-align":"center","line-height":"18px",padding:"0 8px","margin-left":"5px","border-radius":"2px",display:"inline-block"}},[e._v("发行")]):e._e(),e._v(" "),"mock"===e.type?a("label",{staticStyle:{"background-color":"#f5a623","font-size":"12px","font-weight":"600",color:"#fff","text-align":"center","line-height":"18px",padding:"0 8px","margin-left":"5px","border-radius":"2px",display:"inline-block"}},[e._v("mock")]):e._e()]),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#999"}},[a("span",[e._v("类型 "+e._s(e.resourceType))]),e._v(" "),e.datetime?a("span",[e._v(" | 签约时间 "+e._s(e.datetime))]):e._e(),e._v(" "),e.version?a("span",[e._v(" | 最新版本 "+e._s(e.version))]):e._e()])]),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#333"}},[e._v("\n            "+e._s(e.content)+"\n        ")])])])};n._withStripped=!0;var i={name:"OverviewHeader",props:{theID:String,previewSrc:String,title:String,type:String,resourceType:String,datetime:String,version:{type:String,default:""},content:String}},s=(a(845),a(3)),r=Object(s.a)(i,n,[],!1,null,"15c8910f",null);r.options.__file="src/views/node/test-manager-resource/OverviewHeader.vue";t.a=r.exports},749:function(e,t,a){"use strict";var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{"min-height":"40px",padding:"10px 0",display:"flex",width:"100%"}},[t("div",{staticStyle:{"font-size":"14px",color:"#333",width:"110px","flex-shrink":"0","font-weight":"600","line-height":"40px"}},[this._v("\n        "+this._s(this.label)+"\n    ")]),this._v(" "),t("div",{staticStyle:{"flex-shrink":"1",width:"100%",display:"flex","align-items":"center",overflow:"hidden"}},[t("div",{staticStyle:{width:"100%"}},[this._t("default")],2)])])};n._withStripped=!0;var i={name:"BlockItem",props:{label:String}},s=a(3),r=Object(s.a)(i,n,[],!1,null,"2d41ad27",null);r.options.__file="src/views/node/test-manager-resource/BlockItem.vue";t.a=r.exports},750:function(e,t,a){"use strict";var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticStyle:{height:"50px"}}),this._v(" "),t("div",{staticStyle:{color:"#333","font-size":"18px"}},[this._v("节点相关")]),this._v(" "),t("div",{staticStyle:{height:"20px"}}),this._v(" "),this._t("default")],2)};n._withStripped=!0;var i={name:"ModuleBlock"},s=a(3),r=Object(s.a)(i,n,[],!1,null,"baaf8db0",null);r.options.__file="src/views/node/test-manager-resource/ModuleBlock.vue";t.a=r.exports},751:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"40px",width:"700px"}},[e.disabled?a("el-tooltip",{attrs:{content:"正式节点导入，不能修改名称",placement:"top"}},[a("a",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!isEdit"}],staticStyle:{width:"100%",height:"100%",display:"flex","align-items":"center","justify-content":"space-between","background-color":"#fafbfb","border-radius":"2px",padding:"0 15px","box-sizing":"border-box",border:"1px solid #fafbfb"},style:{cursor:"not-allowed"},on:{click:e.clickEdit}},[a("span",{staticStyle:{"font-weight":"600","font-size":"14px",color:"#333"}},[e._v(e._s(e.value))]),e._v(" "),a("i",{staticClass:"el-icon-edit",staticStyle:{color:"#888","font-size":"16px"}})])]):e._e(),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!isEdit"}],staticStyle:{width:"100%",height:"100%",display:"flex","align-items":"center","justify-content":"space-between","background-color":"#fafbfb","border-radius":"2px",padding:"0 15px","box-sizing":"border-box",border:"1px solid #fafbfb"},style:{cursor:"pointer"},on:{click:e.clickEdit}},[a("span",{staticStyle:{"font-weight":"600","font-size":"14px",color:"#333"}},[e._v(e._s(e.value))]),e._v(" "),a("i",{staticClass:"el-icon-edit",staticStyle:{color:"#888","font-size":"16px"}})]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"isEdit"}],staticStyle:{width:"100%",height:"100%",display:"flex",border:"1px solid #c7c7c7","border-radius":"2px","box-sizing":"border-box"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],ref:"input",staticStyle:{padding:"0 15px",color:"#333","line-height":"20px","font-size":"14px",display:"block",width:"100%",border:"none",outline:"none","flex-shrink":"1","font-weight":"600"},domProps:{value:e.inputValue},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.confirmChange(t)},input:function(t){t.target.composing||(e.inputValue=t.target.value)}}}),e._v(" "),a("div",{staticStyle:{display:"flex","align-items":"center",padding:"0 10px"}},[a("a",{staticStyle:{"font-size":"12px",color:"#999","line-height":"24px",width:"50px","text-align":"center",cursor:"pointer"},on:{click:function(t){e.isEdit=!1}}},[e._v("取消")]),e._v(" "),a("a",{staticStyle:{display:"inline-block","line-height":"24px","background-color":"#409eff",color:"#fff",width:"50px","text-align":"center","border-radius":"12px","font-weight":"600",cursor:"pointer"},on:{click:e.confirmChange}},[e._v("保存")])])])],1)};n._withStripped=!0;var i=a(442),s={name:"ConfirmInput",props:{value:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{isEdit:!1,inputValue:this.value}},methods:{clickEdit:function(){var e=this;this.disabled||(this.isEdit=!0,this.inputValue=this.value,setTimeout(function(){e.$refs.input.focus()},10))},confirmChange:function(){if(!i.COMMON_NAME_REGEXP.test(this.inputValue))return this.$message.error('资源的名称不能包含空格和以下字符：\\ / : * ? " < > | @ # $');this.isEdit=!1,this.$emit("confirmChange",this.inputValue)}}},r=a(3),o=Object(r.a)(s,n,[],!1,null,"53c5bad3",null);o.options.__file="src/views/node/test-manager-resource/ConfirmInput.vue";t.a=o.exports},753:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"aside__url"},[a("div",[a("div",{staticClass:"aside__url__name"},[e.isTestNode?a("label",[e._v("T")]):e._e(),e._v(" "),a("span",[e._v(e._s(e.nodeName))])]),e._v(" "),a("div",{staticStyle:{height:"10px"}}),e._v(" "),a("div",{staticClass:"aside__url__link"},[a("a",{staticClass:"aside__url__link__a",staticStyle:{"font-size":"14px",color:"#333","text-decoration":"underline","margin-right":"5px"},attrs:{target:"_blank",href:"//"+e.nodeHref}},[e._v(e._s(e.nodeHref))]),e._v(" "),a("clipboard",{staticStyle:{display:"inline-block"},attrs:{value:e.nodeHref},on:{copyDone:function(t){e.$message.success(e.$t("复制成功"))}}},[a("el-button",{staticClass:"aside__url__link__button",attrs:{type:"primary",plain:"",size:"mini"}},[e._v("copy\n                ")])],1)],1),e._v(" "),a("div",{staticStyle:{height:"25px"}}),e._v(" "),a("a",{staticClass:"aside__url__origin-link",attrs:{target:"_blank",href:e.enterNode}},[e._v(e._s(e.btnText))]),e._v(" "),a("div",{staticStyle:{height:"25px"}})])])};n._withStripped=!0;var i={name:"NodeHeader",components:{clipboard:a(498).a},props:{nodeName:String,nodeHref:String,isTestNode:{type:Boolean,default:!1},enterNode:String,btnText:String}},s=(a(834),a(3)),r=Object(s.a)(i,n,[],!1,null,"1f4f1896",null);r.options.__file="src/views/node/components/NodeHeader.vue";t.a=r.exports},755:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-and-replace"},[a("a",{staticStyle:{color:"#333","font-size":"14px",padding:"10px",cursor:"pointer"},on:{click:function(t){e.dialogVisible=!0}}},[a("i",{staticClass:"el-icon-plus",staticStyle:{"font-size":"16px","font-weight":"600"}}),e._v(" "),a("span",{staticStyle:{"vertical-align":"center"}},[e._v("新增测试展品")])]),e._v(" "),a("a",{staticStyle:{color:"#333","font-size":"14px",padding:"10px",cursor:"pointer"},on:{click:function(t){e.elDialogVisible=!0}}},[a("i",{staticClass:"el-icon-refresh",staticStyle:{"font-size":"16px","font-weight":"600"}}),e._v(" "),a("span",{staticStyle:{"vertical-align":"center"}},[e._v("替换依赖")])]),e._v(" "),e.dialogVisible?a("DepDialog",{attrs:{showMock:!0,exists:[],existMocks:[],currentID:""},on:{addARelease:e.addARelease,addAMock:e.addAMock,removeARelease:e.removeARelease,removeAMock:e.removeAMock,onClose:function(t){e.dialogVisible=!1}}}):e._e(),e._v(" "),a("el-dialog",{attrs:{visible:e.elDialogVisible,width:"840px","before-close":e.handleClose,"custom-class":"custom-class","close-on-click-modal":!1}},[a("div",[a("div",{staticStyle:{"text-align":"right","padding-right":"10px","padding-top":"5px"}},[a("i",{staticClass:"el-icon-close",staticStyle:{"font-size":"10px",color:"#999",cursor:"pointer"},on:{click:function(t){e.elDialogVisible=!1}}})]),e._v(" "),e.controlShowHide?a("div",{staticStyle:{padding:"0 20px",display:"flex","justify-content":"space-between","align-items":"center"}},[a("Replacer",{on:{onChange:e.replacerChange}}),e._v(" "),a("i",{staticClass:"el-icon-back",staticStyle:{transform:"rotate(180deg)"}}),e._v(" "),a("Replaced",{on:{onChange:e.replacedChange}})],1):e._e(),e._v(" "),a("div",{staticStyle:{height:"50px","align-items":"center",display:"flex","flex-direction":"row-reverse",padding:"0 20px"}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"primary",size:"mini",disabled:!e.replacer||!e.replaced},on:{click:e.confirmReplace}},[e._v("替换\n                ")]),e._v(" "),a("el-button",{staticStyle:{"font-size":"14px",padding:"0 20px",color:"#999"},attrs:{type:"text",size:"mini"},on:{click:function(t){e.elDialogVisible=!1}}},[e._v("取消\n                ")])],1)])])],1)};n._withStripped=!0;var i=a(635).a,s=(a(877),a(3)),r=Object(s.a)(i,n,[],!1,null,null,null);r.options.__file="src/views/node/test-manager/AddAndReplace/index.vue";t.a=r.exports},832:function(e,t,a){"use strict";var n=a(607);a.n(n).a},833:function(e,t,a){"use strict";var n=a(608);a.n(n).a},834:function(e,t,a){"use strict";var n=a(610);a.n(n).a},835:function(e,t,a){"use strict";var n=a(611);a.n(n).a},836:function(e,t,a){"use strict";var n=a(612);a.n(n).a},837:function(e,t,a){"use strict";var n=a(616);a.n(n).a},838:function(e,t,a){"use strict";var n=a(617);a.n(n).a},839:function(e,t,a){"use strict";var n=a(618);a.n(n).a},840:function(e,t,a){"use strict";var n=a(619);a.n(n).a},841:function(e,t,a){"use strict";var n=a(628);a.n(n).a},842:function(e,t,a){"use strict";var n=a(629);a.n(n).a},843:function(e,t,a){"use strict";var n=a(630);a.n(n).a},844:function(e,t,a){"use strict";var n=a(631);a.n(n).a},845:function(e,t,a){"use strict";var n=a(632);a.n(n).a},846:function(e,t,a){"use strict";var n=a(633);a.n(n).a},847:function(e,t,a){"use strict";var n=a(634);a.n(n).a},848:function(e,t,a){"use strict";(function(e){var n=a(426),i=a.n(n),s=a(428),r=a.n(s),o=a(86),c=a.n(o),l=a(429),u=a(755),d=a(725),p=a(510),f=a(724),v=null;t.a={name:"index",components:{RuleText:f.a,AddAndReplace:u.a,RulesBar:d.a},data:function(){return{matchTestResult:{},tableData:null,testRules:[],filterSearch:"",allTypes:["全部类型","json","widget","image","audio","markdown","reveal_slide","license","video","catalog"],selectedType:"全部类型",allState:["全部状态","已上线","未上线"],selectedState:"全部状态",currentPage:1,pageSize:10,totalQuantity:0}},mounted:function(){this.handleTableData(!0)},methods:{matchTestResources:function(){var e=this;return Object(l.coroutine)(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.params.nodeId,t.next=3,e.$axios.post("/v1/testNodes/".concat(a,"/matchTestResources"));case 3:if(n=t.sent,console.log(n.data,"res.data"),0===n.data.errcode&&0===n.data.ret){t.next=7;break}return t.abrupt("return",e.$message.error(JSON.stringify(n.data.msg)));case 7:i=n.data.data,e.matchTestResult={ruleText:i.ruleText,testRules:i.testRules.filter(function(e){return 0===e.matchErrors.length}).map(function(e){return c()({text:e.text},e.ruleInfo)})},e.testRules=i.testRules;case 10:case"end":return t.stop()}},t)}))()},handleTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(l.coroutine)(r.a.mark(function a(){var n,i,s,o;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=3;break}return a.next=3,e.matchTestResources();case 3:return n=e.$route.params.nodeId,i={page:e.currentPage,pageSize:e.pageSize,resourceType:"全部类型"===e.selectedType?void 0:e.selectedType,omitResourceType:"page_build",isOnline:e.stateTextToValue(e.selectedState),keywords:e.filterSearch||void 0},a.next=7,e.$axios("/v1/testNodes/".concat(n,"/testResources"),{params:i});case 7:if(0===(s=a.sent).data.errcode&&0===s.data.ret){a.next=10;break}return a.abrupt("return",e.$message.error(s.data.msg));case 10:o=s.data.data,e.tableData=o.dataList.map(function(t){var a=e.matchTestResult.testRules.find(function(e){return e.presentableName===t.testResourceName}),n=[];return a&&(n.push(a.operation),null!==a.tags&&n.push("set_tags"),a.replaces.length>0&&n.push("replace"),!0===a.online&&n.push("show"),!1===a.online&&n.push("hide")),c()({},t,{textRule:e.testRules.find(function(e){return e.id===t.ruleId}),icons:n})}),e.totalQuantity=o.totalItem;case 13:case"end":return a.stop()}},a)}))()},pushRuleSuccess:function(e){this.matchTestResult={ruleText:e.ruleText,testRules:e.testRules.map(function(e){return c()({text:e.text},e.ruleInfo)})},this.testRules=e.testRules,this.handleTableData()},goToOrigin:function(e){var t="";"presentable"===e.type&&(t="/node/manager-release/".concat(e.id)),"mock"===e.type&&(t="/mock/update/".concat(e.id)),"release"===e.type&&(t="/release/detail/".concat(e.id,"?version=").concat(e.version)),window.open(t)},onChangeCurrentPage:function(e){this.currentPage=e},onChangePageSize:function(e){this.pageSize=e},onChangeType:function(e){this.selectedType=e},onChangeState:function(e){this.selectedState=e},stateTextToValue:function(e){switch(e){case"全部状态":return 2;case"已上线":return 1;case"未上线":return 0;default:return 2}},operationCommand:function(e,t){return"编辑"===e?window.open("/node/test-manager-resource/"+t.testResourceId):"isOnline"===e?this.onLineAndOffLine(t):void("delete"===e&&this.deleteRule(t.testResourceName))},onLineAndOffLine:function(t){var a=this;return Object(l.coroutine)(r.a.mark(function n(){var s,o,c,l,u,d,f,v,h,m;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=i()(a.matchTestResult.testRules),o=a.$route.params.nodeId,c=t.testResourceName,l=1===t.differenceInfo.onlineStatusInfo.isOnline,u=a.matchTestResult.ruleText,(d=s.find(function(e){return e.presentableName===c}))?(d.online=!l,v=Object(p.decompile)([d]),f=u.replace(d.text,v)):(h={tags:null,replaces:[],online:!l,operation:"alter",presentableName:c},f=u+"\n"+Object(p.decompile)([h])),n.next=9,a.$axios.post("/v1/testNodes",{nodeId:o,testRuleText:e.from(f).toString("base64")});case 9:if(0===(m=n.sent).data.errcode&&0===m.data.ret){n.next=12;break}return n.abrupt("return",a.$message.error(JSON.stringify(m.data.data.errors)));case 12:l?a.$message.success("下线成功"):a.$message.success("上线成功"),a.pushRuleSuccess(m.data.data);case 14:case"end":return n.stop()}},n)}))()},deleteRule:function(t){var a=this;return Object(l.coroutine)(r.a.mark(function n(){var i,s,o,c;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=a.matchTestResult.testRules.find(function(e){return e.presentableName===t})){n.next=3;break}return n.abrupt("return");case 3:return s=a.$route.params.nodeId,o=a.matchTestResult.ruleText.replace(i.text,""),n.next=7,a.$axios.post("/v1/testNodes",{nodeId:s,testRuleText:e.from(o).toString("base64")});case 7:if(0===(c=n.sent).data.errcode&&0===c.data.ret){n.next=10;break}return n.abrupt("return",a.$message.error(JSON.stringify(c.data.data.errors)));case 10:a.$message.success("删除成功"),a.pushRuleSuccess(c.data.data);case 12:case"end":return n.stop()}},n)}))()},onVersionChange:function(t,a){var n=this;return Object(l.coroutine)(r.a.mark(function s(){var o,c,l,u,d,f,v,h,m;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=n.$route.params.nodeId,c=i()(n.matchTestResult.testRules),l=n.matchTestResult.ruleText,(d=c.find(function(e){return e.presentableName===a.testResourceName}))?("add"===d.operation?d.candidate.versionRange=t:d.replaces.push({replaced:{name:a.originInfo.name,versionRange:"*",type:"release"},replacer:{name:a.originInfo.name,type:"release",versionRange:t},scopes:[]}),f=Object(p.decompile)([d]),u=l.replace(d.text,f)):(v={text:"",tags:null,replaces:[{replaced:{name:a.originInfo.name,versionRange:"*",type:"release"},replacer:{name:a.originInfo.name,type:"release",versionRange:t},scopes:[]}],online:null,operation:"alter",presentableName:a.testResourceName},h=Object(p.decompile)([v]),u=l+"\n"+h),s.next=7,n.$axios.post("/v1/testNodes",{nodeId:o,testRuleText:e.from(u).toString("base64")});case 7:if(0===(m=s.sent).data.errcode&&0===m.data.ret){s.next=10;break}return s.abrupt("return",n.$message.error(JSON.stringify(m.data.data.errors)));case 10:n.$message.success("设置版本成功"),n.pushRuleSuccess(m.data.data);case 12:case"end":return s.stop()}},s)}))()}},watch:{isPageStyle:function(){this.filterSearch="",this.selectedType=this.$t("allType"),this.selectedState=this.$t("allState"),this.currentPage=1,this.pageSize=10,this.handleTableData()},selectedType:function(){this.currentPage=1,this.pageSize=10,this.handleTableData()},selectedState:function(){this.currentPage=1,this.pageSize=10,this.handleTableData()},filterSearch:function(){var e=this;v&&clearTimeout(v),v=setTimeout(function(){e.currentPage=1,e.pageSize=10,e.handleTableData()},300)},pageSize:function(){this.currentPage=1,this.handleTableData()},currentPage:function(){this.handleTableData()}}}}).call(this,a(491).Buffer)},873:function(e,t,a){"use strict";var n=a(638);a.n(n).a},874:function(e,t,a){"use strict";var n=a(639);a.n(n).a},875:function(e,t,a){"use strict";var n=a(640);a.n(n).a},876:function(e,t,a){"use strict";var n=a(641);a.n(n).a},877:function(e,t,a){"use strict";var n=a(642);a.n(n).a},878:function(e,t,a){"use strict";var n=a(643);a.n(n).a},879:function(e,t,a){"use strict";var n=a(644);a.n(n).a},880:function(e,t,a){"use strict";var n=a(645);a.n(n).a},881:function(e,t,a){"use strict";var n=a(646),i=a.n(n);t.default=i.a},882:function(e,t,a){"use strict";var n=a(647);a.n(n).a},883:function(e,t,a){"use strict";var n=a(648);a.n(n).a},884:function(e,t,a){"use strict";(function(e){var n=a(426),i=a.n(n),s=a(428),r=a.n(s),o=a(86),c=a.n(o),l=a(429),u=a(755),d=a(725),p=a(724),f=a(510),v=null;t.a={name:"index",components:{RulesBar:d.a,AddAndReplace:u.a,RuleText:p.a},data:function(){return{matchTestResult:{},testRules:[],tableData:null,filterSearch:"",selectedType:"全部类型",allState:["全部状态","已上线","未上线","异常"],selectedState:"全部状态",currentPage:1,pageSize:10,totalQuantity:0,activatedThemeId:""}},mounted:function(){this.handleTableData(!0)},methods:{matchTestResources:function(){var e=this;return Object(l.coroutine)(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.params.nodeId,t.next=3,e.$axios.post("/v1/testNodes/".concat(a,"/matchTestResources"));case 3:if(0===(n=t.sent).data.errcode&&0===n.data.ret){t.next=6;break}return t.abrupt("return",e.$message.error(JSON.stringify(n.data.msg)));case 6:i=n.data.data,e.activatedThemeId=i.themeId,e.matchTestResult={ruleText:i.ruleText,testRules:i.testRules.filter(function(e){return 0===e.matchErrors.length}).map(function(e){return c()({text:e.text},e.ruleInfo)})},e.testRules=i.testRules;case 10:case"end":return t.stop()}},t)}))()},handleTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(l.coroutine)(r.a.mark(function a(){var n,i,s,o;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t){a.next=3;break}return a.next=3,e.matchTestResources();case 3:return n=e.$route.params.nodeId,i={pageIndex:e.currentPage,pageSize:e.pageSize,resourceType:"page_build",isOnline:e.stateTextToValue(e.selectedState),keywords:e.filterSearch||void 0},a.next=7,e.$axios("/v1/testNodes/".concat(n,"/testResources"),{params:i});case 7:if(0===(s=a.sent).data.errcode&&0===s.data.ret){a.next=10;break}return a.abrupt("return",e.$message.error(s.data.msg));case 10:o=s.data.data,e.tableData=o.dataList.map(function(t){var a=e.matchTestResult.testRules.find(function(e){return e.presentableName===t.testResourceName}),n=[];return a&&(n.push(a.operation),null!==a.tags&&n.push("set_tags"),a.replaces.length>0&&n.push("replace")),t.testResourceId===e.activatedThemeId&&n.push("show"),c()({},t,{textRule:e.testRules.find(function(e){return e.id===t.ruleId}),icons:n})}),e.totalQuantity=o.totalItem;case 13:case"end":return a.stop()}},a)}))()},pushRuleSuccess:function(e){this.activatedThemeId=e.themeId,this.matchTestResult={ruleText:e.ruleText,testRules:e.testRules.map(function(e){return c()({text:e.text},e.ruleInfo)})},this.testRules=e.testRules,this.handleTableData()},goToOrigin:function(e){var t="";"presentable"===e.type&&(t="/node/manager-release/".concat(e.id)),"mock"===e.type&&(t="/mock/update/".concat(e.id)),"release"===e.type&&(t="/release/detail/".concat(e.id,"?version=").concat(e.version)),window.open(t)},onChangeCurrentPage:function(e){this.currentPage=e},onChangePageSize:function(e){this.pageSize=e},onChangeState:function(e){this.selectedState=e},stateTextToValue:function(e){switch(e){case"全部状态":return 2;case"已上线":return 1;case"未上线":return 0;default:return 2}},operationCommand:function(e,t){return"edit"===e?window.open("/node/test-manager-resource/"+t.testResourceId):"isOnline"===e?this.onLineAndOffLine(t):void("delete"===e&&this.deleteRule(t.testResourceName))},onLineAndOffLine:function(t){var a=this;return Object(l.coroutine)(r.a.mark(function n(){var s,o,c,l,u,d,p;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=i()(a.matchTestResult.testRules),o=a.$route.params.nodeId,c=t.testResourceName,l=a.matchTestResult.ruleText,u=s.find(function(e){return"activate_theme"===e.operation}),console.log(u,"rulerulerulerule"),d=u?l.replace(u.text,"activate_theme ".concat(c)):"activate_theme ".concat(c)+"\n"+l,n.next=9,a.$axios.post("/v1/testNodes",{nodeId:o,testRuleText:e.from(d).toString("base64")});case 9:if(0===(p=n.sent).data.errcode&&0===p.data.ret){n.next=12;break}return n.abrupt("return",a.$message.error(JSON.stringify(p.data.data.errors)));case 12:a.$message.success("激活成功"),a.pushRuleSuccess(p.data.data);case 14:case"end":return n.stop()}},n)}))()},deleteRule:function(t){var a=this;return Object(l.coroutine)(r.a.mark(function n(){var i,s,o,c;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=a.matchTestResult.testRules.find(function(e){return e.presentableName===t})){n.next=3;break}return n.abrupt("return");case 3:return s=a.$route.params.nodeId,o=a.matchTestResult.ruleText.replace(i.text,""),n.next=7,a.$axios.post("/v1/testNodes",{nodeId:s,testRuleText:e.from(o).toString("base64")});case 7:if(0===(c=n.sent).data.errcode&&0===c.data.ret){n.next=10;break}return n.abrupt("return",a.$message.error(JSON.stringify(c.data.data.errors)));case 10:a.$message.success("删除成功"),a.pushRuleSuccess(c.data.data);case 12:case"end":return n.stop()}},n)}))()},onVersionChange:function(t,a){var n=this;return Object(l.coroutine)(r.a.mark(function s(){var o,c,l,u,d,p,v,h,m;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o=n.$route.params.nodeId,c=i()(n.matchTestResult.testRules),l=n.matchTestResult.ruleText,(d=c.find(function(e){return e.presentableName===a.testResourceName}))?("add"===d.operation?d.candidate.versionRange=t:d.replaces.push({replaced:{name:a.originInfo.name,versionRange:"*",type:"release"},replacer:{name:a.originInfo.name,type:"release",versionRange:t},scopes:[]}),p=Object(f.decompile)([d]),u=l.replace(d.text,p)):(v={text:"",tags:null,replaces:[{replaced:{name:a.originInfo.name,versionRange:"*",type:"release"},replacer:{name:a.originInfo.name,type:"release",versionRange:t},scopes:[]}],online:null,operation:"alter",presentableName:a.testResourceName},h=Object(f.decompile)([v]),u=l+"\n"+h),s.next=7,n.$axios.post("/v1/testNodes",{nodeId:o,testRuleText:e.from(u).toString("base64")});case 7:if(0===(m=s.sent).data.errcode&&0===m.data.ret){s.next=10;break}return s.abrupt("return",n.$message.error(JSON.stringify(m.data.data.errors)));case 10:n.$message.success("设置版本成功"),n.pushRuleSuccess(m.data.data);case 12:case"end":return s.stop()}},s)}))()}},watch:{selectedState:function(){this.currentPage=1,this.pageSize=10,this.handleTableData()},filterSearch:function(){var e=this;v&&clearTimeout(v),v=setTimeout(function(){e.currentPage=1,e.pageSize=10,e.handleTableData()},300)},pageSize:function(){this.currentPage=1,this.handleTableData()},currentPage:function(){this.handleTableData()}}}}).call(this,a(491).Buffer)},885:function(e,t,a){"use strict";var n=a(649);a.n(n).a},886:function(e,t,a){"use strict";var n=a(650);a.n(n).a},887:function(e,t,a){"use strict";var n=a(652);a.n(n).a},888:function(e,t,a){"use strict";var n=a(653);a.n(n).a},889:function(e,t,a){"use strict";var n=a(654),i=a.n(n);t.default=i.a},890:function(e,t,a){"use strict";var n=a(655);a.n(n).a},891:function(e,t,a){"use strict";(function(e){var n=a(426),i=a.n(n),s=a(428),r=a.n(s),o=a(86),c=a.n(o),l=a(429),u=a(748),d=a(750),p=a(749),f=a(751),v=a(523),h=a(950),m=a(947),g=a(510);t.a={name:"index",components:{ConfirmInput:f.a,BlockItem:p.a,ModuleBlock:d.a,OverviewHeader:u.a,FreelogTags:v.a,DisplayEditContracts:m.a,ContentBlock:h.a},data:function(){return{nodePresentableId:"",testResourceID:"",matchTestResult:{},nodeId:"",originInfo:null,isOnline:!1,testResourceName:"",versions:[],versionValue:"",userDefinedTags:[],activatedThemeId:""}},mounted:function(){this.handleData(!0)},methods:{matchTestResources:function(e){var t=this;return Object(l.coroutine)(r.a.mark(function a(){var n,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$axios.post("/v1/testNodes/".concat(e,"/matchTestResources"));case 2:n=a.sent,i=n.data.data,t.activatedThemeId=i.themeId,t.matchTestResult={ruleText:i.ruleText,testRules:i.testRules.map(function(e){return c()({text:e.text},e.ruleInfo)})};case 6:case"end":return a.stop()}},a)}))()},handleData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(l.coroutine)(r.a.mark(function a(){var n,i,s;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.$route.params.testResourceID,a.next=3,e.$axios.get("/v1/testNodes/testResources/".concat(n));case 3:i=a.sent,s=i.data.data,e.nodeId=s.nodeId,e.testResourceID=n,e.nodePresentableId=s.nodePresentableId,t&&e.matchTestResources(s.nodeId),e.originInfo={theID:s.originInfo.id,name:s.originInfo.name,previewImage:s.previewImages[0],type:s.originInfo.type,version:s.originInfo.versions.reverse()[0],intro:s.intro,resourceType:s.resourceType},e.isOnline=1===s.differenceInfo.onlineStatusInfo.isOnline,e.versions=s.originInfo.versions,e.versionValue=s.originInfo.version,e.testResourceName=s.testResourceName,e.userDefinedTags=s.differenceInfo.userDefinedTagInfo.tags;case 15:case"end":return a.stop()}},a)}))()},pushRuleSuccess:function(e){this.activatedThemeId=e.themeId,this.matchTestResult={ruleText:e.ruleText,testRules:e.testRules.map(function(e){return c()({text:e.text},e.ruleInfo)})},this.handleData()},onLineAndOffLine:function(){var t=this;return Object(l.coroutine)(r.a.mark(function a(){var n,s,o,c,l,u,d,p;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=i()(t.matchTestResult.testRules),s=t.matchTestResult.ruleText,o=t.testResourceName,(c=n.find(function(e){return e.presentableName===o}))?(c.online=!t.isOnline,u=Object(g.decompile)([c]),l=s.replace(c.text,u)):(d={tags:null,replaces:[],online:!t.isOnline,operation:"alter",presentableName:o},l=s+"\n"+Object(g.decompile)([d])),a.next=7,t.$axios.post("/v1/testNodes",{nodeId:t.nodeId,testRuleText:e.from(l).toString("base64")});case 7:if(0===(p=a.sent).data.errcode&&0===p.data.ret){a.next=10;break}return a.abrupt("return",t.$message.error(JSON.stringify(p.data.data.errors)));case 10:t.isOnline?t.$message.success("下线成功"):t.$message.success("上线成功"),t.pushRuleSuccess(p.data.data);case 12:case"end":return a.stop()}},a)}))()},activateTheme:function(){var t=this;return Object(l.coroutine)(r.a.mark(function a(){var n,s,o,c,l,u;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=i()(t.matchTestResult.testRules),s=t.matchTestResult.ruleText,o=t.testResourceName,c=n.find(function(e){return"activate_theme"===e.operation}),l=c?s.replace(c.text,"activate_theme ".concat(o)):"activate_theme ".concat(o)+"\n"+s,a.next=7,t.$axios.post("/v1/testNodes",{nodeId:t.nodeId,testRuleText:e.from(l).toString("base64")});case 7:if(0===(u=a.sent).data.errcode&&0===u.data.ret){a.next=10;break}return a.abrupt("return",t.$message.error(JSON.stringify(u.data.data.errors)));case 10:t.$message.success("激活成功"),t.pushRuleSuccess(u.data.data);case 12:case"end":return a.stop()}},a)}))()},confirmChange:function(t){var a=this;return Object(l.coroutine)(r.a.mark(function n(){var s,o,c,l,u,d;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return console.log(t,"valuevaluevalue"),s=i()(a.matchTestResult.testRules),o=a.matchTestResult.ruleText,(c=s.find(function(e){return e.presentableName===a.testResourceName})).presentableName=t,l=Object(g.decompile)([c]),u=o.replace(c.text,l),n.next=9,a.$axios.post("/v1/testNodes",{nodeId:a.nodeId,testRuleText:e.from(u).toString("base64")});case 9:if(0===(d=n.sent).data.errcode&&0===d.data.ret){n.next=12;break}return n.abrupt("return",a.$message.error(JSON.stringify(d.data.data.errors)));case 12:a.$message.success("更新名称成功"),a.pushRuleSuccess(d.data.data);case 14:case"end":return n.stop()}},n)}))()},setTags:function(t){var a=this;return Object(l.coroutine)(r.a.mark(function n(){var s,o,c,l,u,d,p;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=i()(a.matchTestResult.testRules),o=a.matchTestResult.ruleText,(l=s.find(function(e){return e.presentableName===a.testResourceName}))?(l.tags=t,u=Object(g.decompile)([l]),c=o.replace(l.text,u)):(d={tags:t,replaces:[],online:null,operation:"alter",presentableName:a.testResourceName},c=o+"\n"+Object(g.decompile)([d])),n.next=6,a.$axios.post("/v1/testNodes",{nodeId:a.nodeId,testRuleText:e.from(c).toString("base64")});case 6:if(0===(p=n.sent).data.errcode&&0===p.data.ret){n.next=9;break}return n.abrupt("return",a.$message.error(JSON.stringify(p.data.data.errors)));case 9:a.$message.success("标签设置成功"),a.pushRuleSuccess(p.data.data);case 11:case"end":return n.stop()}},n)}))()},setVersion:function(t){var a=this;return Object(l.coroutine)(r.a.mark(function n(){var s,o,c,l,u,d,p,f;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=i()(a.matchTestResult.testRules),o=a.matchTestResult.ruleText,(l=s.find(function(e){return e.presentableName===a.testResourceName}))?("add"===l.operation?l.candidate.versionRange=t:l.replaces.push({replaced:{name:a.originInfo.name,versionRange:"*",type:"release"},replacer:{name:a.originInfo.name,type:"release",versionRange:t},scopes:[]}),u=Object(g.decompile)([l]),c=o.replace(l.text,u)):(d={text:"",tags:null,replaces:[{replaced:{name:a.originInfo.name,versionRange:"*",type:"release"},replacer:{name:a.originInfo.name,type:"release",versionRange:t},scopes:[]}],online:null,operation:"alter",presentableName:a.testResourceName},p=Object(g.decompile)([d]),c=o+"\n"+p),n.next=6,a.$axios.post("/v1/testNodes",{nodeId:a.nodeId,testRuleText:e.from(c).toString("base64")});case 6:if(0===(f=n.sent).data.errcode&&0===f.data.ret){n.next=9;break}return n.abrupt("return",a.$message.error(JSON.stringify(f.data.data.errors)));case 9:a.$message.success("设置版本成功"),a.pushRuleSuccess(f.data.data);case 11:case"end":return n.stop()}},n)}))()}},watch:{userDefinedTags:function(e,t){t&&JSON.stringify(e)!==JSON.stringify(t)&&this.setTags(e)},versionValue:function(e,t){t&&this.setVersion(e)}}}}).call(this,a(491).Buffer)},892:function(e,t,a){"use strict";var n=a(656);a.n(n).a},893:function(e,t,a){"use strict";var n=a(657);a.n(n).a},894:function(e,t,a){"use strict";var n=a(658);a.n(n).a},895:function(e,t,a){"use strict";var n=a(659);a.n(n).a},947:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("TabsHeader",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"contract"===e.activeTab,expression:"activeTab === 'contract'"}],staticStyle:{"background-color":"#fafbfb",padding:"10px 10px 20px 0",display:"flex"}},[a("div",{staticStyle:{width:"320px","flex-shrink":"0"}},[e._l(e.dataSource,function(t,n){return a("div",[e.dataSource[0]&&e.dataSource[0].releaseId===e.currentRelease.id?[0===n?a("NavTitle",[e._v(e._s(e.$t("currentRelease")))]):e._e(),e._v(" "),1===n?a("NavTitle",[e._v("依赖发行")]):e._e()]:0===n?a("NavTitle",[e._v("依赖发行")]):e._e(),e._v(" "),a("NavItem",{attrs:{activated:e.activatedIndex===n,title:t.releaseName,type:t.release&&t.release.resourceType,version:t.release&&t.release.resourceVersions[0].version,date:t.release&&t.release.updateDate.split("T")[0],tags:t.children&&t.children.filter(function(e){return e.contract&&!e.disabled}).map(function(e){return{policyName:e.policy.policyName,status:e.contract.status}})},on:{click:function(t){e.activatedIndex=n},gotoDetails:function(a){return e.gotoDetails(t.releaseId,t.release.resourceVersions[0].version)}}})],2)}),e._v(" "),a("div",{staticStyle:{height:"25px"}})],2),e._v(" "),a("div",{staticStyle:{"flex-shrink":"1",width:"100%",height:"720px","overflow-y":"auto"}},[-1!==e.activatedIndex?a("div",{staticStyle:{"background-color":"#fff",padding:"20px 50px","min-height":"100%"}},[a("div",{staticStyle:{color:"#333","font-size":"14px","background-color":"#fafbfb",padding:"15px"}},[a("div",{staticStyle:{"padding-bottom":"5px",display:"flex"}},[a("div",{staticStyle:{"flex-shrink":"0"}},[e._v(e._s(e.$t("authorizer")))]),e._v(" "),a("div",{staticStyle:{width:"100%","flex-shrink":"1","white-space":"normal"}},[e._v("\n                            "+e._s(e.dataSource[e.activatedIndex].releaseName)+"\n                        ")])]),e._v(" "),a("div",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{"flex-shrink":"0"}},[e._v(e._s(e.$t("authorized")))]),e._v(" "),a("div",{staticStyle:{width:"100%","flex-shrink":"1","white-space":"normal"}},[e._v(e._s(e.nodeInfo.nodeName))])])]),e._v(" "),e.dataSource[e.activatedIndex].children.filter(function(e){return e.contract}).length>0?a("ContractsContainer",{attrs:{title:e.$t("contracted")}},e._l(e.dataSource[e.activatedIndex].children.filter(function(e){return e.contract}),function(t,n){return a("div",{staticStyle:{position:"relative"}},[0!==n?a("div",{staticStyle:{height:"15px"}}):e._e(),e._v(" "),a("SignedContract",{attrs:{name:t.contract.contractName,status:t.contract.status,contractId:t.contract.contractId,data:t.contract.createDate.split("T")[0],contract:t.contract,disabled:!!t.disabled},on:{command:function(a){t.disabled?e.signPolicy(t.policy.policyId):e.breakSignPolicy(t.policy.policyId)}}})],1)}),0):e._e(),e._v(" "),e.dataSource[e.activatedIndex].children.filter(function(e){return!e.contract}).length>0?a("ContractsContainer",{attrs:{title:e.$t("availableSigning")}},e._l(e.dataSource[e.activatedIndex].children.filter(function(e){return!e.contract}),function(t,n){return a("div",[0!==n?a("div",{staticStyle:{height:"15px"}}):e._e(),e._v(" "),a("UnsignedContract",{attrs:{policyName:t.policy.policyName,policyText:t.policy.policyText},on:{add:function(a){return e.signPolicy(t.policy.policyId,!0)}}})],1)}),0):e._e()],1):e._e()])]),e._v(" "),a("ReleaseEditorContract",{directives:[{name:"show",rawName:"v-show",value:"authorize"===e.activeTab,expression:"activeTab === 'authorize'"}],attrs:{release:{releaseName:this.presentableName},depReleasesDetailList:e.depReleasesDetailList,contracts:e.contracts}})],1)};n._withStripped=!0;var i=a(428),s=a.n(i),r=a(86),o=a.n(r),c=a(429),l=a(513),u=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticStyle:{"font-size":"12px",color:"#999","background-color":"#f5f5f5","line-height":"30px","padding-left":"20px"}},[this._t("default")],2)};u._withStripped=!0;var d={name:"NavTitle"},p=a(3),f=Object(p.a)(d,u,[],!1,null,"183f0db6",null);f.options.__file="src/views/node/test-manager-resource/DisplayEditContracts/NavTitle.vue";var v=f.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a",{staticStyle:{padding:"12px 20px",display:"block",cursor:"pointer"},style:{"background-color":e.activated?"#fff":"transparent"},on:{click:function(t){return e.$emit("click")}}},[a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticStyle:{color:"#333","font-size":"14px","font-weight":"600",display:"flex","align-items":"center"}},[a("span",[e._v(e._s(e.title))]),e._v(" "),a("a",{staticStyle:{"font-size":"12px","text-decoration":"underline",color:"#409eff","margin-left":"8px"},on:{click:e.gotoDetails}},[e._v("详情")])]),e._v(" "),0===e.tags.length?a("i",{staticClass:"freelog fl-icon-warning",staticStyle:{background:"none",color:"#ffc210"}}):e._e()]),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#999"}},[e._v(e._s(e._f("pageBuildFilter")(e.type))+" | "+e._s(e.version)+" | "+e._s(e.date))]),e._v(" "),a("div",{staticStyle:{overflow:"hidden"}},e._l(e.tags,function(t){return a("label",{staticStyle:{"background-color":"#e9f4ff","border-radius":"2px",color:"#409eff",padding:"3px 10px",border:"1px solid #a5d1ff","margin-right":"10px","margin-top":"5px",display:"inline-block"}},[e._v("\n            "+e._s(t.policyName)+"\n            "),2===t.status?a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#fbb726",display:"inline-block"}}):e._e(),e._v(" "),4===t.status?a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#39c500",display:"inline-block"}}):e._e()])}),0)])};h._withStripped=!0;var m={name:"NavItem",props:{activated:{type:Boolean,default:!1},title:{type:String,default:"默认标题"},type:{type:String,default:"image"},version:{type:String,default:"1.0.0"},date:{type:String,default:"2019-12-10"},tags:{type:Array,default:function(){return[]}}},methods:{gotoDetails:function(e){e.stopPropagation(),e.preventDefault(),this.$emit("gotoDetails")}}},g=Object(p.a)(m,h,[],!1,null,"5b8696a5",null);g.options.__file="src/views/node/test-manager-resource/DisplayEditContracts/NavItem.vue";var _=g.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[a("div",{staticStyle:{display:"flex","font-size":"14px","font-weight":"600"}},[a("a",{staticStyle:{"padding-bottom":"8px",width:"100px","text-align":"center",cursor:"pointer"},style:{color:"contract"===e.value?"#409eff":"#333","border-bottom":"contract"===e.value?"2px solid #409eff":"none"},on:{click:function(t){return e.$emit("input","contract")}}},[e._v(e._s(e.$t("authorization")))]),e._v(" "),a("a",{staticStyle:{"padding-bottom":"8px",width:"100px","text-align":"center",cursor:"pointer"},style:{color:"authorize"===e.value?"#409eff":"#333","border-bottom":"authorize"===e.value?"2px solid #409eff":"none"},on:{click:function(t){return e.$emit("input","authorize")}}},[e._v(e._s(e.$t("authorizationChain")))])]),e._v(" "),a("div",{staticStyle:{display:"flex","font-size":"12px",color:"#333","padding-right":"10px"}},[a("div",{staticStyle:{display:"flex","padding-left":"30px","align-items":"center"}},[a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#fbb726"}}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.$t("pending")))])]),e._v(" "),a("div",{staticStyle:{display:"flex","padding-left":"30px","align-items":"center"}},[a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#39c500"}}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.$t("active")))])]),e._v(" "),a("div",{staticStyle:{display:"flex","padding-left":"30px","align-items":"center"}},[a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#e35a5f"}}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.$t("termination")))])])])])};y._withStripped=!0;var x={name:"TabsHeader",i18n:{messages:{en:{authorization:"Authorization",authorizationChain:"Chain",pending:"Pending",active:"Active",termination:"Termination"},"zh-CN":{authorization:"授权管理",authorizationChain:"授权链",pending:"待执行",active:"生效中",termination:"合约终止"}}},props:{value:{type:String,default:""}}},b=Object(p.a)(x,y,[],!1,null,"422ae12c",null);b.options.__file="src/views/node/test-manager-resource/DisplayEditContracts/TabsHeader.vue";var w=b.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"background-color":"#fafbfb",border:"1px solid #ccc","border-radius":"4px",overflow:"hidden"}},[a("div",{staticStyle:{padding:"0 15px","border-bottom":"1px solid #d8d8d8"}},[a("div",{staticStyle:{height:"14px"}}),e._v(" "),a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("span",{staticClass:"text-overflow-ellipsis",staticStyle:{"font-size":"16px",color:"#333","font-weight":"600","padding-right":"20px","max-width":"350px"}},[e._v(e._s(e.name))]),e._v(" "),2===e.status?a("span",{staticStyle:{color:"#fbb726",padding:"0 9px","line-height":"18px",border:"1px solid #fbb726","border-radius":"10px","font-size":"14px"}},[e._v(e._s(e.$t("pending")))]):e._e(),e._v(" "),4===e.status?a("span",{staticStyle:{color:"#39c500",padding:"0 9px","line-height":"18px",border:"1px solid #39c500","border-radius":"10px","font-size":"14px"}},[e._v(e._s(e.$t("active")))]):e._e(),e._v(" "),6===e.status?a("span",{staticStyle:{color:"#e35a5f",padding:"0 9px","line-height":"18px",border:"1px solid #e35a5f","border-radius":"10px","font-size":"14px"}},[e._v(e._s(e.$t("termination")))]):e._e()]),e._v(" "),e.unique?a("el-dropdown",[a("el-button",{attrs:{size:"mini"}},[e._v("\n                    已启用"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v("当前授权方案中只有一个合约，不可停用")])],1)],1):a("el-dropdown",{on:{command:function(t){return e.$emit("command")}}},[a("el-button",{attrs:{size:"mini"}},[e._v("\n                    "+e._s(e.disabled?e.$t("paused"):e.$t("used"))),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v(e._s(e.disabled?e.$t("use"):e.$t("pause")))])],1)],1)],1),e._v(" "),a("div",{staticStyle:{height:"15px"}}),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#999"}},[a("span",{staticStyle:{"padding-right":"50px"}},[e._v(e._s(e.$t("contract"))+"ID："+e._s(e.contractId))]),e._v(" "),a("span",[e._v(e._s(e.$t("signingTime"))+e._s(e.data))])]),e._v(" "),a("div",{staticStyle:{height:"14px"}})]),e._v(" "),a("div",{staticStyle:{margin:"0 30px"}},[a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("ContractDetail",{staticClass:"contract-policy-content",attrs:{contract:e.contract,policyText:e.contract.contractClause.policyText},on:{"update:contract":function(t){e.contract=t}}}),e._v(" "),a("div",{staticStyle:{height:"30px"}})],1)])};S._withStripped=!0;var T=a(130),C={name:"SignedContract",i18n:{messages:{en:{pending:"Pending",active:"Active",termination:"Termination",paused:"Paused",used:"Used",use:"Use",pause:"Pause",contract:"Contract ",signingTime:"Signing Time: "},"zh-CN":{pending:"待执行",active:"生效中",termination:"合约终止",paused:"已搁置",used:"已应用",use:"应用",pause:"搁置",contract:"合约",signingTime:"签约时间："}}},props:{name:{type:String,default:""},status:{type:Number,default:4},contractId:{type:String,default:""},data:{type:String,default:""},contract:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1},unique:{type:Boolean,default:!1}},components:{ContractDetail:T.a}},I=(a(892),Object(p.a)(C,S,[],!1,null,"1b2ed062",null));I.options.__file="src/views/node/test-manager-resource/DisplayEditContracts/SignedContract.vue";var k=I.exports,R=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticStyle:{height:"30px"}}),this._v(" "),t("div",{staticStyle:{color:"#999","font-size":"14px"}},[this._v(this._s(this.title))]),this._v(" "),t("div",{staticStyle:{height:"10px"}}),this._v(" "),this._t("default")],2)};R._withStripped=!0;var $={name:"ContractsContainer",props:{title:{type:String,default:"小标题"}}},D=Object(p.a)($,R,[],!1,null,"f9f00c3e",null);D.options.__file="src/views/node/test-manager-resource/DisplayEditContracts/ContractsContainer.vue";var N=D.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{border:"1px solid #ccc","border-radius":"4px"}},[a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between",height:"45px","background-color":"#fafbfb",padding:"0 15px","border-bottom":"1px solid #ccc","border-radius":"4px"}},[a("span",{staticClass:"text-overflow-ellipsis",staticStyle:{"font-size":"16px",color:"#333","font-weight":"600","padding-right":"20px","max-width":"350px"}},[e._v(e._s(e.policyName))]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:function(t){return e.$emit("add")}}},[e._v(e._s(e.$t("license"))+"\n        ")])],1),e._v(" "),a("div",{staticStyle:{height:"5px"}}),e._v(" "),a("div",{},[a("pre",{staticStyle:{"font-size":"14px",color:"#333",padding:"20px"}},[e._v(e._s(e.policyText))])])])};O._withStripped=!0;var P={name:"UnsignedContract",i18n:{messages:{en:{license:"License"},"zh-CN":{license:"获取授权"}}},props:{policyName:{type:String,default:"标题"},policyText:{type:String,default:""}}},E=(a(893),Object(p.a)(P,O,[],!1,null,"118f8830",null));function z(e,t){return j.apply(this,arguments)}function j(){return(j=Object(c.coroutine)(s.a.mark(function e(t,a){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/v1/contracts/list?",{params:{contractIds:a.join(",")}});case 2:return n=e.sent,e.abrupt("return",n.data.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function B(e){var t=[],a=!0,n=!1,i=void 0;try{for(var s,r=e[Symbol.iterator]();!(a=(s=r.next()).done);a=!0){var o=s.value,c=!0,l=!1,u=void 0;try{for(var d,p=o.children[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var f=d.value;t.push(f.contract.id)}}catch(e){l=!0,u=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw u}}}}catch(e){n=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}return t}function A(e,t){var a=e.find(function(e){return e.releaseId===t});return a?a.policies:[]}function M(e,t){return L.apply(this,arguments)}function L(){return(L=Object(c.coroutine)(s.a.mark(function e(t,a){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/v1/releases/list",{params:{releaseIds:a.join(",")}});case 2:return n=e.sent,e.abrupt("return",n.data.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}E.options.__file="src/views/node/test-manager-resource/DisplayEditContracts/UnsignedContract.vue";var V={name:"DisplayEditContracts",i18n:{messages:{en:{currentRelease:"Current Release",throwingRelease:"Throwing Release",authorizer:"Authorizer: ",authorized:"Authorized: ",contracted:"Contracted",availableSigning:"Available for signing",agencySuccess:"Agency success",success:"Success",onlyOneContract:"Only one contract in the current licensing scheme, cannot be deactivated"},"zh-CN":{currentRelease:"当前发行",throwingRelease:"上抛发行",authorizer:"授权方：",authorized:"被授权方：",contracted:"已签约",availableSigning:"以下策略可供签约",agencySuccess:"签约成功",success:"操作成功",onlyOneContract:"当前授权方案中只有一个合约，不可停用"}}},components:{UnsignedContract:E.exports,ContractsContainer:N,SignedContract:k,TabsHeader:w,NavItem:_,NavTitle:v,ReleaseEditorContract:l.a},data:function(){return{dataSource:[],activatedIndex:-1,nodeInfo:null,activeTab:"contract",presentableName:"",depReleasesDetailList:[],contracts:[],currentRelease:null}},mounted:function(){this.handleData()},methods:{handleData:function(){var e=this;return Object(c.coroutine)(s.a.mark(function t(){var a,n,i,r,c,l,u,d,p,f,v,h,m,g,_,y,x,b,w,S,T,C,I,k,R,$,D,N,O,P,E,j,L,V,H,F,U,q,K,J,W,Q,Y,G,X,Z,ee,te,ae,ne,ie,se,re,oe,ce,le,ue,de,pe,fe,ve;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.params.testResourceID,t.next=3,e.$axios.get("/v1/testNodes/testResources/".concat(a));case 3:if(0===(n=t.sent).data.errcode&&0===n.data.ret){t.next=7;break}throw e.$message.error(n.data.msg),new Error(n.data.msg);case 7:if(i=n.data.data,e.currentRelease=i.originInfo,e.nodeInfo||e.handleNodeInfo(i.nodeId),r=i.resolveReleases.map(function(e){return{releaseId:e.releaseId,releaseName:e.releaseName,children:e.contracts.map(function(e){return{contract:{id:e.contractId},policy:{id:e.policyId}}})}}),c=B(r),l=[],!(c.length>0)){t.next=17;break}return t.next=16,z(e.$axios,c);case 16:l=t.sent;case 17:u=!0,d=!1,p=void 0,t.prev=20,f=r[Symbol.iterator]();case 22:if(u=(v=f.next()).done){t.next=47;break}for(h=v.value,m=!0,g=!1,_=void 0,t.prev=27,y=function(){var e=b.value,t=e.contract.id;e.contract=l.find(function(e){return e.contractId===t})},x=h.children[Symbol.iterator]();!(m=(b=x.next()).done);m=!0)y();t.next=36;break;case 32:t.prev=32,t.t0=t.catch(27),g=!0,_=t.t0;case 36:t.prev=36,t.prev=37,m||null==x.return||x.return();case 39:if(t.prev=39,!g){t.next=42;break}throw _;case 42:return t.finish(39);case 43:return t.finish(36);case 44:u=!0,t.next=22;break;case 47:t.next=53;break;case 49:t.prev=49,t.t1=t.catch(20),d=!0,p=t.t1;case 53:t.prev=53,t.prev=54,u||null==f.return||f.return();case 56:if(t.prev=56,!d){t.next=59;break}throw p;case 59:return t.finish(56);case 60:return t.finish(53);case 61:return t.next=63,M(e.$axios,r.map(function(e){return e.releaseId}));case 63:if(w=t.sent){t.next=66;break}return t.abrupt("return");case 66:for(S=0;S<w.length;S++)r[S].release=w[S];T=!0,C=!1,I=void 0,t.prev=70,k=r[Symbol.iterator]();case 72:if(T=(R=k.next()).done){t.next=123;break}$=R.value,D=A(w,$.releaseId),N=D.map(function(e){return{policy:e}}),O=!0,P=!1,E=void 0,t.prev=79,j=N[Symbol.iterator]();case 81:if(O=(L=j.next()).done){t.next=105;break}for(V=L.value,H=!0,F=!1,U=void 0,t.prev=86,q=$.children[Symbol.iterator]();!(H=(K=q.next()).done);H=!0)J=K.value,V.policy.policyId===J.policy.id&&(V.contract=J.contract);t.next=94;break;case 90:t.prev=90,t.t2=t.catch(86),F=!0,U=t.t2;case 94:t.prev=94,t.prev=95,H||null==q.return||q.return();case 97:if(t.prev=97,!F){t.next=100;break}throw U;case 100:return t.finish(97);case 101:return t.finish(94);case 102:O=!0,t.next=81;break;case 105:t.next=111;break;case 107:t.prev=107,t.t3=t.catch(79),P=!0,E=t.t3;case 111:t.prev=111,t.prev=112,O||null==j.return||j.return();case 114:if(t.prev=114,!P){t.next=117;break}throw E;case 117:return t.finish(114);case 118:return t.finish(111);case 119:$.children=N;case 120:T=!0,t.next=72;break;case 123:t.next=129;break;case 125:t.prev=125,t.t4=t.catch(70),C=!0,I=t.t4;case 129:t.prev=129,t.prev=130,T||null==k.return||k.return();case 132:if(t.prev=132,!C){t.next=135;break}throw I;case 135:return t.finish(132);case 136:return t.finish(129);case 137:return t.next=139,e.$axios.get("/v1/contracts/list",{params:{targetIds:r.map(function(e){return e.releaseId}).join(","),partyTwo:n.data.data.nodeId}});case 139:if(0===(W=t.sent).data.errcode&&0===W.data.ret){t.next=143;break}throw e.$message.error(W.data.msg),new Error(W.data.msg);case 143:Q=W.data.data,Y=!0,G=!1,X=void 0,t.prev=147,Z=r[Symbol.iterator]();case 149:if(Y=(ee=Z.next()).done){t.next=174;break}for(te=ee.value,ae=!0,ne=!1,ie=void 0,t.prev=154,se=function(){var e=oe.value;if(!e.contract){var t=Q.find(function(t){return t.policyId===e.policy.policyId});t&&(e.contract=t,e.disabled=!0)}},re=te.children[Symbol.iterator]();!(ae=(oe=re.next()).done);ae=!0)se();t.next=163;break;case 159:t.prev=159,t.t5=t.catch(154),ne=!0,ie=t.t5;case 163:t.prev=163,t.prev=164,ae||null==re.return||re.return();case 166:if(t.prev=166,!ne){t.next=169;break}throw ie;case 169:return t.finish(166);case 170:return t.finish(163);case 171:Y=!0,t.next=149;break;case 174:t.next=180;break;case 176:t.prev=176,t.t6=t.catch(147),G=!0,X=t.t6;case 180:t.prev=180,t.prev=181,Y||null==Z.return||Z.return();case 183:if(t.prev=183,!G){t.next=186;break}throw X;case 186:return t.finish(183);case 187:return t.finish(180);case 188:for(e.dataSource=r,-1===e.activatedIndex&&(e.activatedIndex=0),ce=[],le=!0,ue=!1,de=void 0,t.prev=194,pe=function(){var e=ve.value,t=[],a=!0,n=!1,i=void 0;try{for(var s,r=e.children[Symbol.iterator]();!(a=(s=r.next()).done);a=!0){var c=s.value;t.push(c.contract)}}catch(e){n=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}ce.push(o()({},w.find(function(t){return t.releaseId===e.releaseId}),{contracts:t}))},fe=r[Symbol.iterator]();!(le=(ve=fe.next()).done);le=!0)pe();t.next=203;break;case 199:t.prev=199,t.t7=t.catch(194),ue=!0,de=t.t7;case 203:t.prev=203,t.prev=204,le||null==fe.return||fe.return();case 206:if(t.prev=206,!ue){t.next=209;break}throw de;case 209:return t.finish(206);case 210:return t.finish(203);case 211:e.presentableName=i.presentableName,e.depReleasesDetailList=ce,e.contracts=l;case 214:case"end":return t.stop()}},t,null,[[20,49,53,61],[27,32,36,44],[37,,39,43],[54,,56,60],[70,125,129,137],[79,107,111,119],[86,90,94,102],[95,,97,101],[112,,114,118],[130,,132,136],[147,176,180,188],[154,159,163,171],[164,,166,170],[181,,183,187],[194,199,203,211],[204,,206,210]])}))()},handleNodeInfo:function(e){var t=this;return Object(c.coroutine)(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$axios.get("/v1/nodes/".concat(e));case 2:if(0===(n=a.sent).data.errcode&&0===n.data.ret){a.next=6;break}throw t.$message.error(n.data.msg),new Error(n.data.msg);case 6:t.nodeInfo=n.data.data;case 7:case"end":return a.stop()}},a)}))()},signPolicy:function(e,t){var a=this;return Object(c.coroutine)(s.a.mark(function n(){var i;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(i=a.dataSource[a.activatedIndex].children.filter(function(e){return e.contract&&!e.disabled}).map(function(e){return e.policy.policyId})).push(e),n.prev=2,n.next=5,a.updateSignPolicy(i);case 5:t?a.$message.success(a.$t("agencySuccess")):a.$message.success(a.$t("success")),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),console.error(n.t0);case 11:case"end":return n.stop()}},n,null,[[2,8]])}))()},breakSignPolicy:function(e){var t=this;return Object(c.coroutine)(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.dataSource[t.activatedIndex].children.filter(function(e){return e.contract&&!e.disabled}).map(function(e){return e.policy.policyId}).filter(function(t){return t!==e}),a.prev=1,a.next=4,t.updateSignPolicy(n);case 4:t.$message.success(t.$t("success")),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(1),console.log(a.t0);case 10:case"end":return a.stop()}},a,null,[[1,7]])}))()},updateSignPolicy:function(e){var t=this;return Object(c.coroutine)(s.a.mark(function a(){var n,i,r;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==e.length){a.next=3;break}throw t.$message.error(t.$t("onlyOneContract")),new Error("当前授权方案中只有一个合约");case 3:return n=t.dataSource[t.activatedIndex].releaseId,i=e.map(function(e){return{policyId:e}}),a.prev=5,a.next=8,t.updatePresentable({resolveReleases:[{releaseId:n,contracts:i}]});case 8:r=a.sent,a.next=14;break;case 11:a.prev=11,a.t0=a.catch(5),console.error(a.t0);case 14:if(0===r.data.errcode&&0===r.data.ret){a.next=17;break}throw t.$message.error(r.data.msg),new Error(r.data.msg);case 17:setTimeout(function(){t.handleData()},10);case 18:case"end":return a.stop()}},a,null,[[5,11]])}))()},updatePresentable:function(e){var t=this;return Object(c.coroutine)(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.$route.params.testResourceID,a.next=3,t.$axios.put("/v1/testNodes/testResources/".concat(n),e);case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}},a)}))()},gotoDetails:function(e,t){window.open("/release/detail/".concat(e,"?version=").concat(t))}},watch:{activatedIndex:function(){this.selectedPolicyIDs=this.dataSource[this.activatedIndex].children.filter(function(e){return e.contract}).map(function(e){return e.policy.policyId})}}},H=(a(894),a(895),Object(p.a)(V,n,[],!1,null,"3fa19481",null));H.options.__file="src/views/node/test-manager-resource/DisplayEditContracts/index.vue";t.a=H.exports},948:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{width:"384px"}},[a("div",{staticStyle:{"font-size":"14px",color:"#333"}},[e._v("选择替换资源")]),e._v(" "),a("div",{staticStyle:{height:"5px"}}),e._v(" "),a("div",{staticStyle:{border:"1px solid #c8c8c8","border-radius":"2px",overflow:"hidden"}},[a("div",{staticStyle:{"border-radius":"2px 2px 0 0","background-color":"#fafbfb","font-size":"14px",overflow:"hidden",display:"flex",color:"#333"}},[a("a",{staticStyle:{padding:"10px 0","margin-left":"15px",cursor:"pointer"},style:{color:"myRelease"===e.activeTab?"#409eff":"#333",borderBottom:"myRelease"===e.activeTab?"2px solid #378fea":"none"},on:{click:function(t){e.activeTab="myRelease"}}},[e._v("我的发行")]),e._v(" "),a("a",{staticStyle:{padding:"10px 0","margin-left":"20px",cursor:"pointer"},style:{color:"mock"===e.activeTab?"#409eff":"#333",borderBottom:"mock"===e.activeTab?"2px solid #378fea":"none"},on:{click:function(t){e.activeTab="mock"}}},[e._v("我的mock")]),e._v(" "),a("a",{staticStyle:{padding:"10px 0","margin-left":"20px",cursor:"pointer"},style:{color:"release"===e.activeTab?"#409eff":"#333",borderBottom:"release"===e.activeTab?"2px solid #378fea":"none"},on:{click:function(t){e.activeTab="release"}}},[e._v("发行市场")])]),e._v(" "),a("div",{staticStyle:{height:"380px"}},["myRelease"===e.activeTab?a("MyRelease",{attrs:{activatedRelease:e.activatedRelease},on:{onDataChange:e.onDataChange}}):e._e(),e._v(" "),"release"===e.activeTab?a("Release",{attrs:{activatedRelease:e.activatedRelease},on:{onDataChange:e.onDataChange}}):e._e(),e._v(" "),a("Mock",{directives:[{name:"show",rawName:"v-show",value:"mock"===e.activeTab,expression:"activeTab === 'mock'"}],attrs:{activatedRelease:e.activatedRelease},on:{onDataChange:e.onDataChange}})],1)])])};n._withStripped=!0;var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("LazyLoadingBox",{staticStyle:{margin:"0"},attrs:{end:e.dataEnd},on:{toBottom:e.toBottom}},[a("div",{staticStyle:{padding:"15px 15px 10px"}},[a("el-input",{staticStyle:{display:"block"},attrs:{size:"small",placeholder:"请输入内容"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),e._l(this.data,function(t){return a("Item",{attrs:{active:e.activatedRelease&&t.name===e.activatedRelease.name,state:e.activatedRelease&&t.name===e.activatedRelease.name?e.activatedRelease:void 0,title:t.name,type:t.type,version:t.version,date:t.date,versions:t.versions},on:{onDataChange:e.onDataChange}})})],2)};i._withStripped=!0;var s=a(428),r=a.n(s),o=a(426),c=a.n(o),l=a(429),u=a(435),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5px 15px"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("Radio",{attrs:{selected:e.active},on:{click:e.onDataChange}}),e._v(" "),a("span",{staticClass:"overflow",staticStyle:{"padding-left":"10px","font-size":"14px",color:"#333"}},[e._v(e._s(e.title))])],1),e._v(" "),a("div",{staticStyle:{"padding-left":"25px",display:"flex","align-items":"center","justify-content":"space-between"}},[a("div",{staticStyle:{"font-size":"12px",color:"#333"}},[e._v(e._s(e.type)+" "+e._s(e.version?"| v"+e.version:"")+" | "+e._s(e.date))]),e._v(" "),e.active&&e.version?a("el-popover",{attrs:{placement:"bottom-end",width:"325",trigger:"click"},model:{value:e.popoverShow,callback:function(t){e.popoverShow=t},expression:"popoverShow"}},[a("a",{staticStyle:{"font-size":"12px",display:"flex","align-items":"center",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[a("span",[e._v("版本范围")]),e._v(" "),a("i",{staticClass:"el-icon-d-arrow-right",staticStyle:{transform:"rotate(90deg)","font-size":"12px"}})]),e._v(" "),a("div",{staticStyle:{width:"100%",overflow:"hidden"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("Radio",{attrs:{selected:!e.customer},on:{click:function(t){e.customer=!1}}}),e._v(" "),a("span",{staticStyle:{padding:"0 10px","font-size":"14px",color:"#333"}},[e._v("选定版本")]),e._v(" "),a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择",size:"mini",disabled:e.customer},model:{value:e.selectedVersion,callback:function(t){e.selectedVersion=t},expression:"selectedVersion"}},e._l(e.versions,function(e){return a("el-option",{attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("div",{staticStyle:{height:"10px"}}),e._v(" "),a("div",[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("Radio",{attrs:{selected:e.customer},on:{click:function(t){e.customer=!0}}}),e._v(" "),a("span",{staticStyle:{padding:"0 10px","font-size":"14px",color:"#333"}},[e._v("自定义")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.customer,expression:"customer"}]},[a("div",{staticStyle:{height:"5px"}}),e._v(" "),a("el-input",{staticStyle:{display:"block"},attrs:{placeholder:"输入semver版本范围"},model:{value:e.inputVersion,callback:function(t){e.inputVersion=t},expression:"inputVersion"}})],1)]),e._v(" "),a("div",{staticStyle:{height:"10px"}}),e._v(" "),a("div",{staticStyle:{"align-items":"center",display:"flex","flex-direction":"row-reverse",width:"100%"}},[a("el-button",{staticStyle:{"font-size":"12px"},attrs:{type:"primary",size:"mini"},on:{click:e.onDataChange}},[e._v("确定\n                    ")]),e._v(" "),a("el-button",{staticStyle:{"font-size":"12px",padding:"0 20px",color:"#999"},attrs:{type:"text",size:"mini"},on:{click:function(t){e.popoverShow=!1}}},[e._v("取消\n                    ")])],1)])]):e._e()],1)])};d._withStripped=!0;var p={name:"Item",components:{Radio:a(721).a},props:{active:{type:Boolean,default:!1},title:String,type:String,version:String,date:String,versions:{type:Array,default:function(){return[]}},state:{type:Object,default:function(){return{customer:!1,selectedVersion:this.versions[0],inputVersion:""}}}},data:function(){return{popoverShow:!1,customer:!!this.state&&this.state.customer,selectedVersion:this.state?this.state.selectedVersion:this.versions[0],inputVersion:this.state?this.state.inputVersion:""}},mounted:function(){},methods:{onDataChange:function(){this.popoverShow=!1,this.version?this.$emit("onDataChange",{name:this.title,customer:this.customer,selectedVersion:this.selectedVersion,inputVersion:this.inputVersion}):this.$emit("onDataChange",{name:this.title})}}},f=(a(873),a(3)),v=Object(f.a)(p,d,[],!1,null,"227deb59",null);v.options.__file="src/views/node/test-manager/AddAndReplace/Replacer/Item.vue";var h=v.exports,m={name:"MyRelease",components:{LazyLoadingBox:u.a,Item:h},props:{activatedRelease:{default:null}},data:function(){return{page:1,input:"",dataEnd:!1,data:[]}},mounted:function(){this.search()},methods:{search:function(){var e=this;return Object(l.coroutine)(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={isSelf:1,page:e.page,keywords:e.input,pageSize:20},t.next=3,e.$axios.get("/v1/releases",{params:a});case 3:n=t.sent,i=n.data.data,e.dataEnd=i.page*i.pageSize>=i.totalItem,e.data=[].concat(c()(e.data),c()(i.dataList.map(function(e){return{id:e.releaseId,name:e.releaseName,isOnline:1===e.status,type:e.latestVersion.resourceInfo.resourceType,version:e.latestVersion.version,date:e.updateDate.split("T")[0],versions:e.resourceVersions.map(function(e){return e.version}).reverse()}})));case 7:case"end":return t.stop()}},t)}))()},toBottom:function(){this.page++,this.search()},onDataChange:function(e){this.$emit("onDataChange",e)}},watch:{input:function(){var e=this;this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){e.page=1,e.data=[],e.search()},1e3)}}},g=(a(874),Object(f.a)(m,i,[],!1,null,"a4703936",null));g.options.__file="src/views/node/test-manager/AddAndReplace/Replacer/MyRelease.vue";var _=g.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("LazyLoadingBox",{staticStyle:{margin:"0"},attrs:{end:e.dataEnd},on:{toBottom:e.toBottom}},[a("div",{staticStyle:{padding:"15px 15px 10px"}},[a("el-input",{staticStyle:{display:"block"},attrs:{size:"small",placeholder:"请输入内容"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),e._l(this.data,function(t){return a("Item",{attrs:{active:e.activatedRelease&&t.name===e.activatedRelease.name,state:e.activatedRelease&&t.name===e.activatedRelease.name?e.activatedRelease:void 0,title:t.name,type:t.type,version:t.version,date:t.date,versions:t.versions},on:{onDataChange:e.onDataChange}})})],2)};y._withStripped=!0;var x={name:"MyRelease",components:{LazyLoadingBox:u.a,Item:h},props:{activatedRelease:{default:null}},data:function(){return{page:1,input:"",dataEnd:!1,data:[]}},mounted:function(){this.search()},methods:{search:function(){var e=this;return Object(l.coroutine)(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={page:e.page,keywords:e.input,pageSize:20},t.next=3,e.$axios.get("/v1/releases",{params:a});case 3:n=t.sent,i=n.data.data,e.dataEnd=i.page*i.pageSize>=i.totalItem,e.data=[].concat(c()(e.data),c()(i.dataList.map(function(e){return{id:e.releaseId,name:e.releaseName,isOnline:1===e.status,type:e.latestVersion.resourceInfo.resourceType,version:e.latestVersion.version,date:e.updateDate.split("T")[0],versions:e.resourceVersions.map(function(e){return e.version}).reverse()}})));case 7:case"end":return t.stop()}},t)}))()},toBottom:function(){this.page++,this.search()},onDataChange:function(e){this.$emit("onDataChange",e)}},watch:{input:function(){var e=this;this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){e.page=1,e.data=[],e.search()},1e3)}}},b=(a(875),Object(f.a)(x,y,[],!1,null,"19b78931",null));b.options.__file="src/views/node/test-manager/AddAndReplace/Replacer/Release.vue";var w=b.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("LazyLoadingBox",{staticStyle:{margin:"0"},attrs:{end:e.dataEnd},on:{toBottom:e.toBottom}},[a("div",{staticStyle:{padding:"15px 15px 10px"}},[a("el-input",{staticStyle:{display:"block"},attrs:{size:"small",placeholder:"请输入内容"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),e._l(this.data,function(t){return a("Item",{attrs:{active:e.activatedRelease&&t.name===e.activatedRelease.name,state:e.activatedRelease&&t.name===e.activatedRelease.name?e.activatedRelease:void 0,title:t.name,type:t.type,date:t.date,versions:t.versions},on:{onDataChange:e.onDataChange}})})],2)};S._withStripped=!0;var T={name:"MyRelease",components:{LazyLoadingBox:u.a,Item:h},props:{activatedRelease:{default:null}},data:function(){return{page:1,input:"",dataEnd:!1,data:[]}},mounted:function(){this.search()},methods:{search:function(){var e=this;return Object(l.coroutine)(r.a.mark(function t(){var a,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={page:e.page,keywords:e.input,pageSize:10},t.next=3,e.$axios.get("/v1/resources/mocks",{params:a});case 3:n=t.sent,i=n.data.data,e.dataEnd=i.page*i.pageSize>=i.totalItem,e.data=[].concat(c()(e.data),c()(i.dataList.map(function(e){return{id:e.mockResourceId,name:e.fullName,type:e.resourceType,date:e.updateDate.split("T")[0]}})));case 7:case"end":return t.stop()}},t)}))()},toBottom:function(){this.page++,this.search()},onDataChange:function(e){this.$emit("onDataChange",e)}},watch:{input:function(){var e=this;this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){e.page=1,e.data=[],e.search()},1e3)}}},C=(a(876),Object(f.a)(T,S,[],!1,null,"9404d360",null));C.options.__file="src/views/node/test-manager/AddAndReplace/Replacer/Mock.vue";var I={name:"index",components:{Mock:C.exports,Release:w,MyRelease:_},data:function(){return{filterSearch:"",activeTab:"myRelease",activatedRelease:null}},methods:{onDataChange:function(e){this.activatedRelease=e,this.$emit("onChange",e)}}},k=Object(f.a)(I,n,[],!1,null,"07eb691c",null);k.options.__file="src/views/node/test-manager/AddAndReplace/Replacer/index.vue";t.a=k.exports},949:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{width:"384px"}},[a("div",{staticStyle:{"font-size":"14px",color:"#333"}},[e._v("选择被替换资源")]),e._v(" "),a("div",{staticStyle:{height:"5px"}}),e._v(" "),a("div",{staticStyle:{border:"1px solid #c8c8c8","border-radius":"2px",overflow:"hidden"}},[a("div",{staticStyle:{"border-radius":"2px 2px 0 0",display:"flex","align-items":"center","justify-content":"space-between",padding:"15px 15px 10px"}},[a("el-autocomplete",{staticStyle:{width:"80%"},attrs:{size:"small","fetch-suggestions":e.querySearchAsync,placeholder:"请输入内容","trigger-on-focus":!1},on:{select:e.handleSelect},model:{value:e.filterSearch,callback:function(t){e.filterSearch=t},expression:"filterSearch"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),e.selectedExact&&e.selectedExact.versions?a("Version",{attrs:{versions:e.selectedExact.versions},on:{change:e.onVersionChange}}):e._e()],1),e._v(" "),a("div",{staticStyle:{height:"365px"}},[a("el-tree",{ref:"tree",attrs:{props:{isLeaf:"leaf"},data:e.data2,load:e.loadNode1,lazy:"","show-checkbox":"","node-key":"id","default-expand-all":!1,"default-checked-keys":[]},on:{"check-change":e.treeCheckChange}})],1)])])};n._withStripped=!0;var i=a(428),s=a.n(i),r=a(429),o=a(426),c=a.n(o),l=a(721),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{attrs:{placement:"bottom-end",width:"325",trigger:"click"},model:{value:e.popoverShow,callback:function(t){e.popoverShow=t},expression:"popoverShow"}},[a("a",{staticStyle:{"font-size":"12px",display:"flex","align-items":"center",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[a("span",[e._v("版本范围")]),e._v(" "),a("i",{staticClass:"el-icon-d-arrow-right",staticStyle:{transform:"rotate(90deg)","font-size":"12px"}})]),e._v(" "),a("div",{staticStyle:{width:"100%",overflow:"hidden"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("Radio",{attrs:{selected:!e.custom},on:{click:function(t){e.custom=!1}}}),e._v(" "),a("span",{staticStyle:{padding:"0 10px","font-size":"14px",color:"#333"}},[e._v("选定版本")]),e._v(" "),a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择",size:"mini",disabled:e.custom},model:{value:e.selectedVersion,callback:function(t){e.selectedVersion=t},expression:"selectedVersion"}},[a("el-option",{attrs:{label:"全部版本",value:"*"}}),e._v(" "),e._l(e.versions,function(e){return a("el-option",{attrs:{label:e,value:e}})})],2)],1),e._v(" "),a("div",{staticStyle:{height:"10px"}}),e._v(" "),a("div",[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("Radio",{attrs:{selected:e.custom},on:{click:function(t){e.custom=!0}}}),e._v(" "),a("span",{staticStyle:{padding:"0 10px","font-size":"14px",color:"#333"}},[e._v("自定义")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.custom,expression:"custom"}]},[a("div",{staticStyle:{height:"5px"}}),e._v(" "),a("el-input",{staticStyle:{display:"block"},attrs:{placeholder:"输入semver版本范围"},model:{value:e.inputVersion,callback:function(t){e.inputVersion=t},expression:"inputVersion"}})],1)]),e._v(" "),a("div",{staticStyle:{height:"10px"}}),e._v(" "),a("div",{staticStyle:{"align-items":"center",display:"flex","flex-direction":"row-reverse",width:"100%"}},[a("el-button",{staticStyle:{"font-size":"12px"},attrs:{type:"primary",size:"mini"},on:{click:e.onchange}},[e._v("确定")]),e._v(" "),a("el-button",{staticStyle:{"font-size":"12px",padding:"0 20px",color:"#999"},attrs:{type:"text",size:"mini"},on:{click:function(t){e.popoverShow=!1}}},[e._v("取消\n            ")])],1)])])};u._withStripped=!0;var d={name:"Version",components:{Radio:l.a},props:{versions:{type:Array,default:function(){return[]}}},data:function(){return{popoverShow:!1,custom:!1,selectedVersion:"*",inputVersion:""}},methods:{onchange:function(){this.$emit("change",{custom:this.custom,selectedVersion:this.selectedVersion,inputVersion:this.inputVersion}),this.popoverShow=!1}}},p=a(3),f=Object(p.a)(d,u,[],!1,null,"2ae85274",null);f.options.__file="src/views/node/test-manager/AddAndReplace/Replaced/Version.vue";var v=f.exports,h=null;function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=[],n=!0,i=!1,s=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var c=r.value,l=t+"->"+("mock"===c.type?"#:":"$:")+c.name,u=m(c.dependencies,l);a.push({id:l,label:c.name,children:u,leaf:0===u.length})}}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return a}var g={name:"index",components:{Version:v,Radio:l.a},data:function(){return{data2:[],filterSearch:"",popoverShow:!1,selectedExact:null,version:"*",scope:[]}},mounted:function(){},methods:{treeCheckChange:function(){if(!h){h=setTimeout(function(){h=null},10);for(var e=[],t=c()(this.$refs.tree.getCheckedKeys()),a=function(){var a=t.shift();e.push(a),t=t.filter(function(e){return!e.startsWith(a+"->")})};t.length>0;)a();this.scope=e,this.$emit("onChange",{name:this.filterSearch,version:this.version,scope:this.scope})}},querySearchAsync:function(e,t){var a=this;Object(r.coroutine)(s.a.mark(function n(){var i,r,o,c,l;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=a.$route.params.nodeId,r={keywords:e},n.next=4,a.$axios.get("/v1/testNodes/".concat(i,"/searchTestResourceDependencyTree"),{params:r});case 4:o=n.sent,c=o.data.data,l=c.map(function(e){return{id:e.id,value:e.name,type:e.type,versions:e.versions}}),t(l);case 8:case"end":return n.stop()}},n)}))()},closePopover:function(){},onVersionChange:function(e){this.version=e.custom?e.inputVersion:e.selectedVersion,this.searchTestResource()},handleSelect:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t.selectedExact=e,t.searchTestResource();case 2:case"end":return a.stop()}},a)}))()},searchTestResource:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function e(){var a,n,i,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.$route.params.nodeId,n={dependentEntityId:t.selectedExact.id,dependentEntityVersionRange:t.version},e.next=4,t.$axios.get("/v1/testNodes/".concat(a,"/searchTestResource"),{params:n});case 4:i=e.sent,r=i.data.data,t.data2=r.map(function(e){return{id:e.testResourceName,label:e.testResourceName,testResourceId:e.testResourceId,children:[]}});case 7:case"end":return e.stop()}},e)}))()},loadNode1:function(e,t){var a=this;return 0===e.level?t([]):e.level>1?t(e.data.children||[]):void setTimeout(Object(r.coroutine)(s.a.mark(function n(){var i,r,o;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i={dependentEntityId:a.selectedExact.id,dependentEntityVersionRange:a.version},n.next=3,a.$axios.get("/v1/testNodes/testResources/".concat(e.data.testResourceId,"/filterDependencyTree"),{params:i});case 3:r=n.sent,o=m(r.data.data,e.data.id),t(o);case 6:case"end":return n.stop()}},n)})),500)}}},_=Object(p.a)(g,n,[],!1,null,"392cbae4",null);_.options.__file="src/views/node/test-manager/AddAndReplace/Replaced/index.vue";t.a=_.exports},950:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("span",{staticStyle:{"font-size":"14px","line-height":"1",color:"#333","font-weight":"600","border-left":"3px solid #333","padding-left":"5px"}},[e._v(e._s(e.title))]),e._v(" "),a("div",{staticStyle:{"padding-left":"10px"}},[e._t("right")],2)]),e._v(" "),a("div",{staticStyle:{height:"25px"}})]),e._v(" "),e._t("default"),e._v(" "),a("div",{staticStyle:{height:"10px"}})],2)};n._withStripped=!0;var i={name:"ContentBlock",props:{title:{type:String,default:"标题"}}},s=a(3),r=Object(s.a)(i,n,[],!1,null,"68db207d",null);r.options.__file="src/views/node/test-manager-resource/ContentBlock.vue";t.a=r.exports},951:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"manager-release"},[a("div",{staticStyle:{height:"30px"}}),e._v(" "),e.releaseInfo?a("OverviewHeader",{attrs:{theID:e.releaseInfo.theID,previewSrc:e.releaseInfo.previewImages||void 0,title:e.releaseInfo.releaseName,type:"release",resourceType:e._f("pageBuildFilter")(e.releaseInfo.resourceType),version:e.releaseInfo.version,content:e.releaseInfo.intro}}):e._e(),e._v(" "),a("ModuleBlock",[a("BlockItem",{attrs:{label:"状态"}},["page_build"===e.releaseInfo.resourceType?[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isOnline,expression:"!isOnline"}],staticClass:"manager-release__state"},[a("label",[e._v("未激活")]),e._v(" "),a("a",{on:{click:e.onLineAndOffLine}},[e._v("激活")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isOnline,expression:"isOnline"}],staticClass:"manager-release__state"},[a("label",[e._v("已激活")])])]:[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isOnline,expression:"!isOnline"}],staticClass:"manager-release__state"},[a("label",[e._v("未上线")]),e._v(" "),a("a",{on:{click:e.onLineAndOffLine}},[e._v("上线")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isOnline,expression:"isOnline"}],staticClass:"manager-release__state"},[a("label",[e._v("已上线")]),e._v(" "),a("a",{on:{click:e.onLineAndOffLine}},[e._v("下线")])])]],2),e._v(" "),a("BlockItem",{attrs:{label:"展品名称"}},[a("ConfirmInput",{attrs:{value:e.presentableName},on:{confirmChange:e.confirmChange}})],1),e._v(" "),0!==e.versions.length?a("BlockItem",{attrs:{label:"展示版本"}},[a("el-select",{staticClass:"manager-release__version",model:{value:e.versionValue,callback:function(t){e.versionValue=t},expression:"versionValue"}},e._l(e.versions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1):e._e(),e._v(" "),a("BlockItem",{attrs:{label:"标签"}},[a("div",{staticStyle:{height:"5px"}}),e._v(" "),a("FreelogTags",{model:{value:e.userDefinedTags,callback:function(t){e.userDefinedTags=t},expression:"userDefinedTags"}})],1),e._v(" "),a("BlockItem",{attrs:{label:"授权策略"}},[e.isShowEditPolicy?e._e():[0===e.policies.length?a("div",{staticClass:"manager-release__policy"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.switchShowEditPolicy(!0)}}},[e._v("添加策略\n                    ")]),e._v(" "),a("el-popover",{attrs:{placement:"top",trigger:"hover",content:e.$t("noPolicyNotAppear")}},[a("div",{staticClass:"manager-release__policy__warning",attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"el-icon-warning"})])])],1):e._e(),e._v(" "),e.policies.length>0?a("PolicyList",{staticClass:"manager-release__policy__list",attrs:{policyList:e.policies},on:{"add-policy":function(t){return e.switchShowEditPolicy(!0)},"update-policies":e.updatePolicies}}):e._e()],e._v(" "),e.isShowEditPolicy?a("PolicyEditor",{staticClass:"r-e-w-r-p-editor",attrs:{policy:e.newPolicie,showFooterBtns:!0},on:{save:e.saveANewPolicy,cancel:function(t){return e.switchShowEditPolicy(!1)}}}):e._e()],2)],1),e._v(" "),a("ContentBlock",{attrs:{title:e.$t("authorization")}},[a("DisplayEditContracts")],1),e._v(" "),a("div",{staticStyle:{height:"65px"}})],1)};n._withStripped=!0;var i=a(428),s=a.n(i),r=a(429),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("span",{staticStyle:{"font-size":"14px","line-height":"1",color:"#333","font-weight":"600","border-left":"3px solid #333","padding-left":"5px"}},[e._v(e._s(e.title))]),e._v(" "),a("div",{staticStyle:{"padding-left":"10px"}},[e._t("right")],2)]),e._v(" "),a("div",{staticStyle:{height:"25px"}})]),e._v(" "),e._t("default"),e._v(" "),a("div",{staticStyle:{height:"10px"}})],2)};o._withStripped=!0;var c={name:"ContentBlock",props:{title:{type:String,default:"标题"}}},l=a(3),u=Object(l.a)(c,o,[],!1,null,"19cc089f",null);u.options.__file="src/views/node/manager-release/ContentBlock.vue";var d=u.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isEdit?a("div",[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary",round:""},on:{click:e.confirmChange}},[e._v("保存\n    ")]),e._v(" "),a("el-button",{attrs:{size:"mini",round:""},on:{click:function(t){return e.switchEdit(!1)}}},[e._v("取消\n    ")])],1):a("div",{staticStyle:{display:"flex","align-items":"center",height:"40px"}},[a("div",{staticStyle:{"font-size":"16px",color:"#333","font-weight":"600","padding-right":"20px","line-height":"1"}},[e._v("\n        "+e._s(e.value)+"\n    ")]),e._v(" "),a("el-button",{staticStyle:{color:"#333","font-size":"20px"},attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(t){return e.switchEdit(!0)}}})],1)};p._withStripped=!0;var f={name:"DisplayOrInput",model:{prop:"value",event:"onChange"},props:{value:{type:String,default:""}},data:function(){return{isEdit:!1,inputValue:this.value}},methods:{switchEdit:function(e){this.isEdit=e,e&&(this.inputValue=this.value)},confirmChange:function(){this.$emit("onChange",this.inputValue),this.isEdit=!1}}},v=Object(l.a)(f,p,[],!1,null,"2e156450",null);v.options.__file="src/views/node/manager-release/DisplayOrInput.vue";var h=v.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("TabsHeader",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"contract"===e.activeTab,expression:"activeTab === 'contract'"}],staticStyle:{"background-color":"#fafbfb",padding:"10px 10px 20px 0",display:"flex"}},[a("div",{staticStyle:{width:"320px","flex-shrink":"0"}},[e._l(e.dataSource,function(t,n){return a("div",[0===n?a("NavTitle",[e._v(e._s(e.$t("currentRelease")))]):e._e(),e._v(" "),1===n?a("NavTitle",[e._v(e._s(e.$t("throwingRelease")))]):e._e(),e._v(" "),a("NavItem",{attrs:{activated:e.activatedIndex===n,title:t.releaseName,type:t.release.resourceType,version:t.release.resourceVersions[0].version,date:t.release.updateDate.split("T")[0],tags:t.children.filter(function(e){return e.contract&&!e.disabled}).map(function(e){return{policyName:e.policy.policyName,status:e.contract.status}})},on:{gotoDetails:function(a){return e.gotoDetails(t.releaseId,t.release.resourceVersions[0].version)},click:function(t){e.activatedIndex=n}}})],1)}),e._v(" "),a("div",{staticStyle:{height:"25px"}})],2),e._v(" "),a("div",{staticStyle:{"flex-shrink":"1",width:"100%",height:"720px","overflow-y":"auto"}},[-1!==e.activatedIndex?a("div",{staticStyle:{"background-color":"#fff",padding:"20px 50px","min-height":"100%"}},[a("div",{staticStyle:{color:"#333","font-size":"14px","background-color":"#fafbfb",padding:"15px"}},[a("div",{staticStyle:{"padding-bottom":"5px",display:"flex"}},[a("div",{staticStyle:{"flex-shrink":"0"}},[e._v(e._s(e.$t("authorizer")))]),e._v(" "),a("div",{staticStyle:{width:"100%","flex-shrink":"1","white-space":"normal"}},[e._v("\n                                "+e._s(e.dataSource[e.activatedIndex].releaseName)+"\n                            ")])]),e._v(" "),a("div",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{"flex-shrink":"0"}},[e._v(e._s(e.$t("authorized")))]),e._v(" "),a("div",{staticStyle:{width:"100%","flex-shrink":"1","white-space":"normal"}},[e._v(e._s(e.nodeInfo.nodeName))])])]),e._v(" "),a("ContractsContainer",{attrs:{title:e.$t("contracted")}},e._l(e.dataSource[e.activatedIndex].children.filter(function(e){return e.contract}),function(t,n){return a("div",{staticStyle:{position:"relative"}},[0!==n?a("div",{staticStyle:{height:"15px"}}):e._e(),e._v(" "),a("SignedContract",{attrs:{name:t.contract.contractName,status:t.contract.status,contractId:t.contract.contractId,data:t.contract.createDate.split("T")[0],contract:t.contract,disabled:!!t.disabled},on:{command:function(a){t.disabled?e.signPolicy(t.policy.policyId):e.breakSignPolicy(t.policy.policyId)}}})],1)}),0),e._v(" "),e.dataSource[e.activatedIndex].children.filter(function(e){return!e.contract}).length>0?a("ContractsContainer",{attrs:{title:e.$t("availableSigning")}},e._l(e.dataSource[e.activatedIndex].children.filter(function(e){return!e.contract}),function(t,n){return a("div",[0!==n?a("div",{staticStyle:{height:"15px"}}):e._e(),e._v(" "),a("UnsignedContract",{attrs:{policyName:t.policy.policyName,policyText:t.policy.policyText},on:{add:function(a){return e.signPolicy(t.policy.policyId,!0)}}})],1)}),0):e._e()],1):e._e()])]),e._v(" "),a("ReleaseEditorContract",{directives:[{name:"show",rawName:"v-show",value:"authorize"===e.activeTab,expression:"activeTab === 'authorize'"}],attrs:{release:{releaseName:this.presentableName},depReleasesDetailList:e.depReleasesDetailList,contracts:e.contracts}})],1)};m._withStripped=!0;var g=a(86),_=a.n(g),y=a(513),x=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticStyle:{"font-size":"12px",color:"#999","background-color":"#f5f5f5","line-height":"30px","padding-left":"20px"}},[this._t("default")],2)};x._withStripped=!0;var b={name:"NavTitle"},w=Object(l.a)(b,x,[],!1,null,"94c9a458",null);w.options.__file="src/views/node/manager-release/DisplayEditContracts/NavTitle.vue";var S=w.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a",{staticStyle:{padding:"12px 20px",display:"block",cursor:"pointer"},style:{"background-color":e.activated?"#fff":"transparent"},on:{click:function(t){return e.$emit("click")}}},[a("div",{staticStyle:{color:"#333","font-size":"14px","font-weight":"600"}},[e._v(e._s(e.title)+" "),a("a",{staticStyle:{"font-size":"12px","text-decoration":"underline",color:"#409eff","margin-left":"8px"},on:{click:e.gotoDetails}},[e._v("详情")])]),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#999"}},[e._v(e._s(e._f("pageBuildFilter")(e.type))+" | "+e._s(e.version)+" | "+e._s(e.date))]),e._v(" "),a("div",{staticStyle:{overflow:"hidden"}},e._l(e.tags,function(t){return a("label",{staticStyle:{"background-color":"#e9f4ff","border-radius":"2px",color:"#409eff",padding:"3px 10px",border:"1px solid #a5d1ff","margin-right":"10px","margin-top":"5px",display:"inline-block"}},[e._v("\n            "+e._s(t.policyName)+"\n            "),2===t.status?a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#fbb726",display:"inline-block"}}):e._e(),e._v(" "),4===t.status?a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#39c500",display:"inline-block"}}):e._e()])}),0)])};T._withStripped=!0;var C={name:"NavItem",props:{activated:{type:Boolean,default:!1},title:{type:String,default:"默认标题"},type:{type:String,default:"image"},version:{type:String,default:"1.0.0"},date:{type:String,default:"2019-12-10"},tags:{type:Array,default:function(){return[]}}},methods:{gotoDetails:function(e){e.stopPropagation(),e.preventDefault(),this.$emit("gotoDetails")}}},I=Object(l.a)(C,T,[],!1,null,"57920a72",null);I.options.__file="src/views/node/manager-release/DisplayEditContracts/NavItem.vue";var k=I.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[a("div",{staticStyle:{display:"flex","font-size":"14px","font-weight":"600"}},[a("a",{staticStyle:{"padding-bottom":"8px",width:"100px","text-align":"center",cursor:"pointer"},style:{color:"contract"===e.value?"#409eff":"#333","border-bottom":"contract"===e.value?"2px solid #409eff":"none"},on:{click:function(t){return e.$emit("input","contract")}}},[e._v(e._s(e.$t("authorization")))]),e._v(" "),a("a",{staticStyle:{"padding-bottom":"8px",width:"100px","text-align":"center",cursor:"pointer"},style:{color:"authorize"===e.value?"#409eff":"#333","border-bottom":"authorize"===e.value?"2px solid #409eff":"none"},on:{click:function(t){return e.$emit("input","authorize")}}},[e._v(e._s(e.$t("authorizationChain")))])]),e._v(" "),a("div",{staticStyle:{display:"flex","font-size":"12px",color:"#333","padding-right":"10px"}},[a("div",{staticStyle:{display:"flex","padding-left":"30px","align-items":"center"}},[a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#fbb726"}}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.$t("pending")))])]),e._v(" "),a("div",{staticStyle:{display:"flex","padding-left":"30px","align-items":"center"}},[a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#39c500"}}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.$t("active")))])]),e._v(" "),a("div",{staticStyle:{display:"flex","padding-left":"30px","align-items":"center"}},[a("i",{staticStyle:{width:"8px",height:"8px","border-radius":"50%","background-color":"#e35a5f"}}),e._v(" "),a("span",{staticStyle:{"padding-left":"5px"}},[e._v(e._s(e.$t("termination")))])])])])};R._withStripped=!0;var $={name:"TabsHeader",i18n:{messages:{en:{authorization:"Authorization",authorizationChain:"Chain",pending:"Pending",active:"Active",termination:"Termination"},"zh-CN":{authorization:"授权管理",authorizationChain:"授权链",pending:"待执行",active:"生效中",termination:"合约终止"}}},props:{value:{type:String,default:""}}},D=Object(l.a)($,R,[],!1,null,"0e011c6c",null);D.options.__file="src/views/node/manager-release/DisplayEditContracts/TabsHeader.vue";var N=D.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"background-color":"#fafbfb",border:"1px solid #ccc","border-radius":"4px",overflow:"hidden"}},[a("div",{staticStyle:{padding:"0 15px","border-bottom":"1px solid #d8d8d8"}},[a("div",{staticStyle:{height:"14px"}}),e._v(" "),a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("span",{staticClass:"text-overflow-ellipsis",staticStyle:{"font-size":"16px",color:"#333","font-weight":"600","padding-right":"20px","max-width":"350px"}},[e._v(e._s(e.name))]),e._v(" "),2===e.status?a("span",{staticStyle:{color:"#fbb726",padding:"0 9px","line-height":"18px",border:"1px solid #fbb726","border-radius":"10px","font-size":"14px"}},[e._v(e._s(e.$t("pending")))]):e._e(),e._v(" "),4===e.status?a("span",{staticStyle:{color:"#39c500",padding:"0 9px","line-height":"18px",border:"1px solid #39c500","border-radius":"10px","font-size":"14px"}},[e._v(e._s(e.$t("active")))]):e._e(),e._v(" "),6===e.status?a("span",{staticStyle:{color:"#e35a5f",padding:"0 9px","line-height":"18px",border:"1px solid #e35a5f","border-radius":"10px","font-size":"14px"}},[e._v(e._s(e.$t("termination")))]):e._e()]),e._v(" "),e.unique?a("el-dropdown",[a("el-button",{attrs:{size:"mini"}},[e._v("\n                    已启用"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v("当前授权方案中只有一个合约，不可停用")])],1)],1):a("el-dropdown",{on:{command:function(t){return e.$emit("command")}}},[a("el-button",{attrs:{size:"mini"}},[e._v("\n                    "+e._s(e.disabled?e.$t("paused"):e.$t("used"))),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[e._v(e._s(e.disabled?e.$t("use"):e.$t("pause")))])],1)],1)],1),e._v(" "),a("div",{staticStyle:{height:"15px"}}),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#999"}},[a("span",{staticStyle:{"padding-right":"50px"}},[e._v(e._s(e.$t("contract"))+"ID："+e._s(e.contractId))]),e._v(" "),a("span",[e._v(e._s(e.$t("signingTime"))+e._s(e.data))])]),e._v(" "),a("div",{staticStyle:{height:"14px"}})]),e._v(" "),a("div",{staticStyle:{margin:"0 30px"}},[a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("ContractDetail",{staticClass:"contract-policy-content",attrs:{contract:e.contract,policyText:e.contract.contractClause.policyText},on:{"update:contract":function(t){e.contract=t}}}),e._v(" "),a("div",{staticStyle:{height:"30px"}})],1)])};O._withStripped=!0;var P=a(130),E={name:"SignedContract",i18n:{messages:{en:{pending:"Pending",active:"Active",termination:"Termination",paused:"Paused",used:"Used",use:"Use",pause:"Pause",contract:"Contract ",signingTime:"Signing Time: "},"zh-CN":{pending:"待执行",active:"生效中",termination:"合约终止",paused:"已搁置",used:"已应用",use:"应用",pause:"搁置",contract:"合约",signingTime:"签约时间："}}},props:{name:{type:String,default:""},status:{type:Number,default:4},contractId:{type:String,default:""},data:{type:String,default:""},contract:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1},unique:{type:Boolean,default:!1}},components:{ContractDetail:P.a}},z=(a(837),Object(l.a)(E,O,[],!1,null,"1527a96d",null));z.options.__file="src/views/node/manager-release/DisplayEditContracts/SignedContract.vue";var j=z.exports,B=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{staticStyle:{height:"30px"}}),this._v(" "),t("div",{staticStyle:{color:"#999","font-size":"14px"}},[this._v(this._s(this.title))]),this._v(" "),t("div",{staticStyle:{height:"10px"}}),this._v(" "),this._t("default")],2)};B._withStripped=!0;var A={name:"ContractsContainer",props:{title:{type:String,default:"小标题"}}},M=Object(l.a)(A,B,[],!1,null,"26890c7f",null);M.options.__file="src/views/node/manager-release/DisplayEditContracts/ContractsContainer.vue";var L=M.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{border:"1px solid #ccc","border-radius":"4px"}},[a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between",height:"45px","background-color":"#fafbfb",padding:"0 15px","border-bottom":"1px solid #ccc","border-radius":"4px"}},[a("span",{staticClass:"text-overflow-ellipsis",staticStyle:{"font-size":"16px",color:"#333","font-weight":"600","padding-right":"20px","max-width":"350px"}},[e._v(e._s(e.policyName))]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:function(t){return e.$emit("add")}}},[e._v(e._s(e.$t("license"))+"\n        ")])],1),e._v(" "),a("div",{staticStyle:{height:"5px"}}),e._v(" "),a("div",{},[a("pre",{staticStyle:{"font-size":"14px",color:"#333",padding:"20px"}},[e._v(e._s(e.policyText))])])])};V._withStripped=!0;var H={name:"UnsignedContract",i18n:{messages:{en:{license:"License"},"zh-CN":{license:"获取授权"}}},props:{policyName:{type:String,default:"标题"},policyText:{type:String,default:""}}},F=(a(838),Object(l.a)(H,V,[],!1,null,"66795e06",null));function U(e,t){return q.apply(this,arguments)}function q(){return(q=Object(r.coroutine)(s.a.mark(function e(t,a){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/v1/contracts/list?",{params:{contractIds:a.join(",")}});case 2:return n=e.sent,e.abrupt("return",n.data.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function K(e){var t=[],a=!0,n=!1,i=void 0;try{for(var s,r=e[Symbol.iterator]();!(a=(s=r.next()).done);a=!0){var o=s.value,c=!0,l=!1,u=void 0;try{for(var d,p=o.children[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var f=d.value;t.push(f.contract.id)}}catch(e){l=!0,u=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw u}}}}catch(e){n=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}return t}function J(e,t){var a=e.find(function(e){return e.releaseId===t});return a?a.policies:[]}function W(e,t){return Q.apply(this,arguments)}function Q(){return(Q=Object(r.coroutine)(s.a.mark(function e(t,a){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/v1/releases/list",{params:{releaseIds:a.join(",")}});case 2:return n=e.sent,e.abrupt("return",n.data.data);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}F.options.__file="src/views/node/manager-release/DisplayEditContracts/UnsignedContract.vue";var Y={name:"DisplayEditContracts",i18n:{messages:{en:{currentRelease:"Current Release",throwingRelease:"Throwing Release",authorizer:"Authorizer: ",authorized:"Authorized: ",contracted:"Contracted",availableSigning:"Available for signing",agencySuccess:"Agency success",success:"Success",onlyOneContract:"Only one contract in the current licensing scheme, cannot be deactivated"},"zh-CN":{currentRelease:"当前发行",throwingRelease:"上抛发行",authorizer:"授权方：",authorized:"被授权方：",contracted:"已签约",availableSigning:"以下策略可供签约",agencySuccess:"签约成功",success:"操作成功",onlyOneContract:"当前授权方案中只有一个合约，不可停用"}}},components:{UnsignedContract:F.exports,ContractsContainer:L,SignedContract:j,TabsHeader:N,NavItem:k,NavTitle:S,ReleaseEditorContract:y.a},data:function(){return{dataSource:[],activatedIndex:-1,nodeInfo:null,activeTab:"contract",presentableName:"",depReleasesDetailList:[],contracts:[]}},mounted:function(){this.handleData()},methods:{handleData:function(){var e=this;return Object(r.coroutine)(s.a.mark(function t(){var a,n,i,r,o,c,l,u,d,p,f,v,h,m,g,y,x,b,w,S,T,C,I,k,R,$,D,N,O,P,E,z,j,B,A,M,L,V,H,F,q,Q,Y,G,X,Z,ee,te,ae,ne,ie,se,re,oe,ce,le,ue,de,pe;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/v1/presentables/".concat(e.$route.params.presentableId));case 2:if(0===(a=t.sent).data.errcode&&0===a.data.ret){t.next=6;break}throw e.$message.error(a.data.msg),new Error(a.data.msg);case 6:return n=a.data.data,e.nodeInfo||e.handleNodeInfo(n.nodeId),i=n.resolveReleases.map(function(e){return{releaseId:e.releaseId,releaseName:e.releaseName,children:e.contracts.map(function(e){return{contract:{id:e.contractId},policy:{id:e.policyId}}})}}),t.next=11,U(e.$axios,K(i));case 11:r=t.sent,o=!0,c=!1,l=void 0,t.prev=15,u=i[Symbol.iterator]();case 17:if(o=(d=u.next()).done){t.next=42;break}for(p=d.value,f=!0,v=!1,h=void 0,t.prev=22,m=function(){var e=y.value,t=e.contract.id;e.contract=r.find(function(e){return e.contractId===t})},g=p.children[Symbol.iterator]();!(f=(y=g.next()).done);f=!0)m();t.next=31;break;case 27:t.prev=27,t.t0=t.catch(22),v=!0,h=t.t0;case 31:t.prev=31,t.prev=32,f||null==g.return||g.return();case 34:if(t.prev=34,!v){t.next=37;break}throw h;case 37:return t.finish(34);case 38:return t.finish(31);case 39:o=!0,t.next=17;break;case 42:t.next=48;break;case 44:t.prev=44,t.t1=t.catch(15),c=!0,l=t.t1;case 48:t.prev=48,t.prev=49,o||null==u.return||u.return();case 51:if(t.prev=51,!c){t.next=54;break}throw l;case 54:return t.finish(51);case 55:return t.finish(48);case 56:return t.next=58,W(e.$axios,i.map(function(e){return e.releaseId}));case 58:for(x=t.sent,b=0;b<x.length;b++)i[b].release=x[b];w=!0,S=!1,T=void 0,t.prev=63,C=i[Symbol.iterator]();case 65:if(w=(I=C.next()).done){t.next=116;break}k=I.value,R=J(x,k.releaseId),$=R.map(function(e){return{policy:e}}),D=!0,N=!1,O=void 0,t.prev=72,P=$[Symbol.iterator]();case 74:if(D=(E=P.next()).done){t.next=98;break}for(z=E.value,j=!0,B=!1,A=void 0,t.prev=79,M=k.children[Symbol.iterator]();!(j=(L=M.next()).done);j=!0)V=L.value,z.policy.policyId===V.policy.id&&(z.contract=V.contract);t.next=87;break;case 83:t.prev=83,t.t2=t.catch(79),B=!0,A=t.t2;case 87:t.prev=87,t.prev=88,j||null==M.return||M.return();case 90:if(t.prev=90,!B){t.next=93;break}throw A;case 93:return t.finish(90);case 94:return t.finish(87);case 95:D=!0,t.next=74;break;case 98:t.next=104;break;case 100:t.prev=100,t.t3=t.catch(72),N=!0,O=t.t3;case 104:t.prev=104,t.prev=105,D||null==P.return||P.return();case 107:if(t.prev=107,!N){t.next=110;break}throw O;case 110:return t.finish(107);case 111:return t.finish(104);case 112:k.children=$;case 113:w=!0,t.next=65;break;case 116:t.next=122;break;case 118:t.prev=118,t.t4=t.catch(63),S=!0,T=t.t4;case 122:t.prev=122,t.prev=123,w||null==C.return||C.return();case 125:if(t.prev=125,!S){t.next=128;break}throw T;case 128:return t.finish(125);case 129:return t.finish(122);case 130:return t.next=132,e.$axios.get("/v1/contracts/list",{params:{targetIds:i.map(function(e){return e.releaseId}).join(","),partyTwo:a.data.data.nodeId}});case 132:if(0===(H=t.sent).data.errcode&&0===H.data.ret){t.next=136;break}throw e.$message.error(H.data.msg),new Error(H.data.msg);case 136:F=H.data.data,q=!0,Q=!1,Y=void 0,t.prev=140,G=i[Symbol.iterator]();case 142:if(q=(X=G.next()).done){t.next=167;break}for(Z=X.value,ee=!0,te=!1,ae=void 0,t.prev=147,ne=function(){var e=se.value;if(!e.contract){var t=F.find(function(t){return t.policyId===e.policy.policyId});t&&(e.contract=t,e.disabled=!0)}},ie=Z.children[Symbol.iterator]();!(ee=(se=ie.next()).done);ee=!0)ne();t.next=156;break;case 152:t.prev=152,t.t5=t.catch(147),te=!0,ae=t.t5;case 156:t.prev=156,t.prev=157,ee||null==ie.return||ie.return();case 159:if(t.prev=159,!te){t.next=162;break}throw ae;case 162:return t.finish(159);case 163:return t.finish(156);case 164:q=!0,t.next=142;break;case 167:t.next=173;break;case 169:t.prev=169,t.t6=t.catch(140),Q=!0,Y=t.t6;case 173:t.prev=173,t.prev=174,q||null==G.return||G.return();case 176:if(t.prev=176,!Q){t.next=179;break}throw Y;case 179:return t.finish(176);case 180:return t.finish(173);case 181:for(e.dataSource=i,-1===e.activatedIndex&&(e.activatedIndex=0),re=[],oe=!0,ce=!1,le=void 0,t.prev=187,ue=function(){var e=pe.value,t=[],a=!0,n=!1,i=void 0;try{for(var s,r=e.children[Symbol.iterator]();!(a=(s=r.next()).done);a=!0){var o=s.value;t.push(o.contract)}}catch(e){n=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(n)throw i}}re.push(_()({},x.find(function(t){return t.releaseId===e.releaseId}),{contracts:t}))},de=i[Symbol.iterator]();!(oe=(pe=de.next()).done);oe=!0)ue();t.next=196;break;case 192:t.prev=192,t.t7=t.catch(187),ce=!0,le=t.t7;case 196:t.prev=196,t.prev=197,oe||null==de.return||de.return();case 199:if(t.prev=199,!ce){t.next=202;break}throw le;case 202:return t.finish(199);case 203:return t.finish(196);case 204:e.presentableName=n.presentableName,e.depReleasesDetailList=re,e.contracts=r;case 207:case"end":return t.stop()}},t,null,[[15,44,48,56],[22,27,31,39],[32,,34,38],[49,,51,55],[63,118,122,130],[72,100,104,112],[79,83,87,95],[88,,90,94],[105,,107,111],[123,,125,129],[140,169,173,181],[147,152,156,164],[157,,159,163],[174,,176,180],[187,192,196,204],[197,,199,203]])}))()},handleNodeInfo:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$axios.get("/v1/nodes/".concat(e));case 2:if(0===(n=a.sent).data.errcode&&0===n.data.ret){a.next=6;break}throw t.$message.error(n.data.msg),new Error(n.data.msg);case 6:t.nodeInfo=n.data.data;case 7:case"end":return a.stop()}},a)}))()},signPolicy:function(e,t){var a=this;return Object(r.coroutine)(s.a.mark(function n(){var i;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(i=a.dataSource[a.activatedIndex].children.filter(function(e){return e.contract&&!e.disabled}).map(function(e){return e.policy.policyId})).push(e),n.prev=2,n.next=5,a.updateSignPolicy(i);case 5:t?a.$message.success(a.$t("agencySuccess")):a.$message.success(a.$t("success")),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),console.error(n.t0);case 11:case"end":return n.stop()}},n,null,[[2,8]])}))()},breakSignPolicy:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.dataSource[t.activatedIndex].children.filter(function(e){return e.contract&&!e.disabled}).map(function(e){return e.policy.policyId}).filter(function(t){return t!==e}),a.prev=1,a.next=4,t.updateSignPolicy(n);case 4:t.$message.success(t.$t("success")),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(1),console.log(a.t0);case 10:case"end":return a.stop()}},a,null,[[1,7]])}))()},updateSignPolicy:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function a(){var n,i,r;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==e.length){a.next=3;break}throw t.$message.error(t.$t("onlyOneContract")),new Error("当前授权方案中只有一个合约");case 3:return n=t.dataSource[t.activatedIndex].releaseId,i=e.map(function(e){return{policyId:e}}),a.prev=5,a.next=8,t.updatePresentable({resolveReleases:[{releaseId:n,contracts:i}]});case 8:r=a.sent,a.next=14;break;case 11:a.prev=11,a.t0=a.catch(5),console.error(a.t0);case 14:if(0===r.data.errcode&&0===r.data.ret){a.next=17;break}throw t.$message.error(r.data.msg),new Error(r.data.msg);case 17:setTimeout(function(){t.handleData()},10);case 18:case"end":return a.stop()}},a,null,[[5,11]])}))()},updatePresentable:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$axios.put("/v1/presentables/".concat(t.$route.params.presentableId),e);case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},a)}))()},gotoDetails:function(e,t){window.open("/release/detail/".concat(e,"?version=").concat(t))}},watch:{activatedIndex:function(){this.selectedPolicyIDs=this.dataSource[this.activatedIndex].children.filter(function(e){return e.contract}).map(function(e){return e.policy.policyId})}}},G=(a(839),a(840),Object(l.a)(Y,m,[],!1,null,"54009923",null));G.options.__file="src/views/node/manager-release/DisplayEditContracts/index.vue";var X=G.exports,Z=a(523),ee=a(714),te=a(716),ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fl-contracts-manager-wrap clearfix"},[a("div",{staticClass:"contract-list-wrapper"},[a("h4",{staticClass:"label-title"},[e._v(e._s(e.$t("components.contractManager.resourceList")))]),e._v(" "),a("div",{staticClass:"contract-list-panel"},[e.masterContract.contractId?a("div",[a("p",{staticClass:"sub-label-title"},[e._v(e._s(e.$t("components.contractManager.masterResource")))]),e._v(" "),a("div",{staticClass:"contract-item",class:["contract-status-"+e.masterContract.status,{current:e.currentContract.contractId===e.masterContract.contractId}],on:{click:function(t){return e.showContractDetailHandler(e.masterContract)}}},[e.masterContract.releaseDetail?a("div",[a("i",{staticClass:"dot"}),e._v(" "),e.masterContract.releaseDetail.releaseName?a("span",[e._v(e._s(e.masterContract.releaseDetail.releaseName))]):a("span",[e._v(e._s(e.$t("components.contractManager.subResourceId"))+" "+e._s(e.masterContract.contractId))])]):e._e()])]):e._e(),e._v(" "),e.contractList.length?a("div",[e.masterContract.contractId?a("p",{staticClass:"sub-label-title"},[e._v(e._s(e.$t("components.contractManager.bubbleResources"))+" "),a("span",{staticClass:"contracts-num"},[e._v(e._s(e.contractList.length))])]):e._e(),e._v(" "),a("ul",{staticClass:"contract-list"},e._l(e.contractList,function(t){return a("li",{key:t.contractId,staticClass:"contract-item",class:["contract-status-"+t.status,{current:e.currentContract.contractId===t.contractId}],on:{click:function(a){return e.showContractDetailHandler(t)}}},[a("div",[t.releaseDetail.releaseName?a("span",{staticClass:"res-contract-title"},[e._v(e._s(t.releaseDetail.releaseName))]):a("span",{staticClass:"res-contract-title"},[e._v(e._s(e.$t("components.contractManager.subResourceId"))+" "+e._s(t.contractId))]),e._v(" "),t.statusInfo?a("span",{staticClass:"contract-state-tip",class:["contract-state-"+t.statusInfo.type]},[e._v(e._s(t.statusInfo.desc))]):e._e()])])}),0)]):e._e()])]),e._v(" "),e.currentContract.contractId?a("div",{staticClass:"contract-exec-container"},[a("contract-detail",{attrs:{contract:e.currentContract},on:{update:e.updateContractHandler}})],1):e._e()])};ae._withStripped=!0;var ne=a(497),ie=a(458),se=a(6),re=a(164),oe=a(116);a(10),a(37);var ce=a(26),le={};var ue={format:function(e){if(!e)return null;if(e.contractClause&&e.contractClause.authorizedObjects&&(e.forUsers=e.contractClause.authorizedObjects.map(function(e){return{users:e.users.join("、"),type:e.userType}})),e.statusInfo=ie.CONTRACT_STATUS_COLORS[e.status],e.partyOneUserId){var t=le[e.partyOneUserId];t||(t=Object(ce.b)(function(t){Object(re.b)(e.partyOneUserId).then(function(e){t(e)})}),le[e.partyOneUserId]=t),t(function(t){se.Vue.set(e,"partyOneInfo",t)})}if(e.partyTwo&&e.partyTwo.length<=10){var a=le[e.partyTwo];a||(a=Object(ce.b)(function(t){Object(oe.a)(e.partyTwo).then(function(e){t(e)})}),le[e.partyTwo]=a),a(function(t){se.Vue.set(e,"partyTwoInfo",t)})}return e}},de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.contractDetail.contractId?a("div",{staticClass:"fl-contract-detail-wrap"},[a("h4",{staticClass:"label-title"},[e._v(e._s(e.$t("components.contractDetail.title")))]),e._v(" "),a("contract-detail-info",{attrs:{detail:e.contractDetail,showRefreshing:!0,labelWidth:85}},[a("template",{slot:"prepend"},[a("el-form-item",{attrs:{label:e.$t("components.contractDetail.releaseName")}},[e._v(e._s(e.releaseDetail.releaseName))]),e._v(" "),a("el-form-item",{attrs:{label:e.$t("components.contractDetail.releaseType")}},[e._v(e._s(e.releaseDetail.resourceType))])],1),e._v(" "),1===e.contractDetail.status?a("el-form-item",{staticClass:"flex-grid",attrs:{label:e.$t("components.contractDetail.activateContract")}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.activateContractHandler(e.contractDetail)}}},[e._v(e._s(e.$t("components.contractDetail.triggerContract"))+"\n      ")])],1):e._e()],2),e._v(" "),a("div",{staticClass:"contract-policy-content-wrap"},[a("div",{staticClass:"contract-policy-title"},[e._v("\n      "+e._s(e.contractDetail.contractClause.policyName||e.$t("components.contractDetail.defaultPolicyName"))+"\n      "),a("label",[e._v(e._s(e.$t("components.contractDetail.authState"))+e._s(e.contractDetail.statusInfo.desc))])]),e._v(" "),a("contract-content",{staticClass:"contract-policy-content",attrs:{contract:e.contractDetail,policyText:e.contractDetail.contractClause.policyText},on:{"update:contract":function(t){e.contractDetail=t},"update-contract":e.updateContractAfterEvent}})],1)],1):e._e()};de._withStripped=!0;var pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.detail.contractId?a("el-form",{staticClass:"small-el-form",attrs:{"label-position":"left","label-width":e.labelWidth+"px"}},[e._t("prepend"),e._v(" "),a("el-form-item",{attrs:{label:e.$t("components.detailInfo.createDate")}},[a("span",[e._v(e._s(e._f("fmtDate")(e.detail.createDate)))])]),e._v(" "),a("el-form-item",{attrs:{label:e.$t("components.detailInfo.contractId")}},[e._v("\n    "+e._s(e.detail.contractId)+"\n  ")]),e._v(" "),a("el-form-item",{attrs:{label:e.$t("components.detailInfo.partyOne")}},[e.detail.partyOneInfo&&e.detail.partyOneInfo.nickname?a("span",[e._v(e._s(e.detail.partyOneInfo.nickname))]):a("span",[e._v(e._s(e.detail.partyOne))])]),e._v(" "),a("el-form-item",{attrs:{label:e.$t("components.detailInfo.partyTwo")}},[e.detail.partyTwoInfo&&e.detail.partyTwoInfo.nodeName?a("span",[e._v(e._s(e.detail.partyTwoInfo.nodeName))]):a("span",[e._v(e._s(e.detail.partyTwo))])]),e._v(" "),e._t("default")],2):e._e()};pe._withStripped=!0;var fe={name:"contract-detail-info",data:function(){return{}},props:{detail:{type:Object,default:function(){return{statusInfo:{}}}},labelWidth:{type:Number,default:function(){return 100}}}},ve=(a(841),Object(l.a)(fe,pe,[],!1,null,"3f1cad67",null));ve.options.__file="src/components/detail-info/contract.vue";var he={name:"fl-contract-detail-wrap",data:function(){return{eventComponent:"",dialogTitle:"",showEventExecDialog:!1,contractDetail:{},releaseDetail:{},account:"",options:[],password:"",selectedContractEvent:""}},components:{ContractDetailInfo:ve.exports,"contract-content":P.a},props:{contract:Object},watch:{contract:"initContractDetail"},mounted:function(){this.initContractDetail()},methods:{initContractDetail:function(){var e=this.contract;e&&e.contractId&&(e.partyOneInfo?this.contractDetail=e:this.contractDetail=ue.format(e),e.releaseDetail&&(this.releaseDetail=e.releaseDetail))},updateContractAfterEvent:function(e){var t=this;e&&e.shouldUpdate&&setTimeout(function(){t.updateContractDetail()},500)},formatData:function(){var e=Object.assign({},this.contractDetail);return e=ue.format(e)},loadContractDetail:function(e){return this.$services.contract.get(e||{}).then(function(e){return e.getData()}).catch(this.$error.showErrorMessage)},updateContractDetail:function(e){var t=this;this.loadContractDetail(this.contractDetail.contractId).then(function(a){Object.assign(t.contractDetail,a),t.formatData(),e&&e.done&&e.done()})},activateContractHandler:function(e){var t=this;this.$axios.get("/v1/contracts/initial",{params:{contractIds:e.contractId}}).then(function(a){0===a.data.errcode?(t.$message.success(t.$t("components.contractDetail.activateContractSuccess")),t.loadContractDetail(e.contractId).then(function(a){Object.assign(e,a),t.$emit("update",ue.format(e))})):t.$error.showErrorMessage(a.data.msg)})}}},me=(a(842),a(843),Object(l.a)(he,de,[],!1,null,"45ec48f6",null));me.options.__file="src/components/ContractDetail/index.vue";var ge=me.exports,_e={name:"fl-contract-manager",data:function(){return{query:"",currentContract:{},contractList:[],masterContract:{},loading:!1}},components:{TableView:ne.a,ContractDetail:ge},props:{contracts:Array},watch:{contracts:function(e,t){for(var a=e.map(function(e){return e.contractId}),n=t.map(function(e){return e.contractId}),i=0;i<a.length;i++)if(-1===n.indexOf(a[i])){this.initView();break}}},mounted:function(){this.contracts&&this.initView()},methods:{initView:function(){var e=this;if(this.contracts.length&&!1!==this.shouldUpdate()){this.masterContract={};var t=this.$route.query;Object.assign(t,this.$route.params),this.loading=!0,this.loadData(t).then(this.formatContracts).then(function(t){e.contractList=t,e.masterContract.contractId?e.showContractDetailHandler(e.masterContract):t.length&&e.showContractDetailHandler(t[0]),e.fireContractsChange()}).finally(function(){e.loading=!1,e.shouldUpdate()})}},shouldUpdate:function(){var e=this.contracts.map(function(e){return"".concat(e.contractId)}).join("_");return this.updateKey!==e&&(this.updateKey=e,!0)},formatContracts:function(e){var t=this,a=e.contracts,n=e.releases,i={},s=[];return n.forEach(function(e){i[e.releaseId]=e}),a.forEach(function(e){e.releaseDetail=i[e.partyOne],e.contractId===t.masterContract.contractId?(Object.assign(t.masterContract,e),ue.format(t.masterContract)):(ue.format(e),s.push(e))}),s},loadData:function(){var e=this,t=[];return this.contracts.map(function(a){a.contractId&&t.push(a.contractId),a.isMasterContract&&(e.masterContract=a)}),this.loadContractInfos(t).then(this.loadReleasesInfo)},loadReleasesInfo:function(e){var t=e.map(function(e){return e.partyOne}).join(",");return this.$services.ReleaseService.get("list?releaseIds=".concat(t)).then(function(e){return e.data}).then(function(t){return 0===t.errcode?{contracts:e,releases:t.data}:{contracts:e,releases:[]}})},loadContractInfos:function(e){return this.$services.contractRecords.get({params:{contractIds:e.filter(function(e){return e}).join(",")}}).then(function(e){return e.getData()})},showContractDetailHandler:function(e){e&&e.contractId&&(this.currentContract=e)},fireContractsChange:function(){var e=this.contractList;this.masterContract.contractId&&(e=e.concat(this.masterContract)),this.$emit("contracts-change",e)},updateContractHandler:function(e){Object.assign(this.currentContract,e),this.fireContractsChange()}}},ye=(a(844),Object(l.a)(_e,ae,[],!1,null,"1094a0fe",null));ye.options.__file="src/components/ContractManager/index.vue";var xe=ye.exports,be=a(751),we=a(750),Se=a(749);var Te={name:"manager-release",i18n:{messages:{en:{type:"Type",signingTime:"Signing Time",nodeReleaseTitle:"The node release title",tags:"Tags",newTag:"New Tag",policies:"Policies",cancel:"Cancel",save:"Save",noPolicyNotAppear:"No policy issue does not appear in the market",addPolicy:"Add Policy",authorization:"Authorization",unnamedPolicy:"Unnamed policy",addPolicySuccess:"Add a policy success",updatedPolicySuccessfully:"Updated the policy successfully",titleUpdateSuccessful:"The node issuing title update is successful",tagUpdatedSuccessfully:"User tag updated successfully"},"zh-CN":{type:"类型",signingTime:"签约时间",nodeReleaseTitle:"节点发行标题",tags:"标签",newTag:"新标签",policies:"策略",cancel:"取消",save:"保存",noPolicyNotAppear:"无策略的发行不会出现在市场中",addPolicy:"添加策略",authorization:"授权管理",unnamedPolicy:"未命名策略",addPolicySuccess:"添加策略成功",updatedPolicySuccessfully:"更新策略成功",titleUpdateSuccessful:"节点发行标题更新成功",tagUpdatedSuccessfully:"用户标签更新成功"}}},components:{OverviewHeader:a(748).a,BlockItem:Se.a,ModuleBlock:we.a,ConfirmInput:be.a,ContentBlock:d,DisplayOrInput:h,FreelogTags:Z.a,PolicyEditor:ee.a,PolicyList:te.a,ContractManager:xe,DisplayEditContracts:X,ReleaseEditorContract:y.a},data:function(){return{initState:!0,releaseInfo:{theID:"",previewImages:"",releaseName:"",resourceType:"",version:"",createDate:"",intro:""},isOnline:0,presentableName:null,versions:[],versionValue:null,userDefinedTags:null,isShowEditPolicy:!1,policies:[],newPolicie:{policyName:this.$t("unnamedPolicy"),policyText:""},activeTab:"contract",resolveReleases:[],resolveReleaseID:"",resolveReleaseContracts:[],resolveReleasePolicies:[],releases:[],depReleasesDetailList:[],contracts:[]}},mounted:function(){this.handleInitInfo(),"true"===this.$route.query.addPolicy&&this.switchShowEditPolicy(!0)},methods:{handleInitInfo:function(){var e=this;return Object(r.coroutine)(s.a.mark(function t(){var a,n,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/v1/presentables/".concat(e.$route.params.presentableId));case 2:a=t.sent,n=a.data.data,setTimeout(function(){return e.initState=!1}),i=new Date(n.createDate),e.releaseInfo={theID:n.releaseInfo.releaseId,previewImages:n.releaseInfo.previewImages[0]?n.releaseInfo.previewImages[0]:void 0,releaseName:n.releaseInfo.releaseName,resourceType:n.releaseInfo.resourceType,version:n.releaseInfo.versions.reverse()[0],intro:n.releaseInfo.intro,createDate:[[i.getFullYear(),(i.getMonth()+1<10?"0":"")+(i.getMonth()+1),(i.getDate()<10?"0":"")+i.getDate()].join("-"),[(i.getHours()<10?"0":"")+i.getHours(),(i.getMinutes()<10?"0":"")+i.getMinutes()].join(":")].join(" ")},e.isOnline=n.isOnline,e.presentableName=n.presentableName,e.versions=n.releaseInfo.versions,e.versionValue=n.releaseInfo.version,e.userDefinedTags=n.userDefinedTags,e.policies=n.policies,e.resolveReleases=n.resolveReleases,e.resolveReleaseID=n.resolveReleases[0].releaseId;case 15:case"end":return t.stop()}},t)}))()},updatePresentable:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$axios.put("/v1/presentables/".concat(t.$route.params.presentableId),e);case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},a)}))()},switchShowEditPolicy:function(e){this.isShowEditPolicy=e,this.newPolicie={policyName:this.$t("unnamedPolicy"),policyText:""}},saveANewPolicy:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.updatePresentable({policyInfo:{addPolicies:[{policyName:e.policyName,policyText:window.btoa(e.policyText)}]}});case 2:if(0===(n=a.sent).data.errcode){a.next=5;break}return a.abrupt("return",t.$message.error(n.data.msg));case 5:t.isShowEditPolicy=!1,t.policies=n.data.data.policies,t.$message.success(t.$t("addPolicySuccess"));case 8:case"end":return a.stop()}},a)}))()},updatePolicies:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.updatePresentable({policyInfo:{updatePolicies:[{policyId:e.policyId,policyName:e.policyName,status:e.status}]}});case 2:if(0===(n=a.sent).data.errcode){a.next=5;break}return a.abrupt("return",t.$message.error(n.data.msg));case 5:t.isShowEditPolicy=!1,t.policies=n.data.data.policies,t.$message.success(t.$t("updatedPolicySuccessfully"));case 8:case"end":return a.stop()}},a)}))()},confirmChange:function(e){this.presentableName=e,this.updatePresentable({presentableName:e}),this.$message.success(this.$t("titleUpdateSuccessful"))},onLineAndOffLine:function(){var e=this;return Object(r.coroutine)(s.a.mark(function t(){var a,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.$route.params.presentableId,0!==e.isOnline){t.next=4;break}if(e.policies&&0!==e.policies.length){t.next=4;break}return t.abrupt("return",e.$message.error("暂无策略"));case 4:return t.next=6,e.$axios.put("/v1/presentables/".concat(a,"/switchOnlineState"),{onlineState:0===e.isOnline?1:0});case 6:if(0===(n=t.sent).data.errcode){t.next=9;break}return t.abrupt("return",e.$message.error(n.data.msg));case 9:0===e.isOnline?e.$message.success("上线成功"):e.$message.success("下线成功"),e.handleInitInfo();case 11:case"end":return t.stop()}},t)}))()},updateVersion:function(e){var t=this;return Object(r.coroutine)(s.a.mark(function a(){var n,i;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.$route.params.presentableId,a.next=3,t.$services.PresentablesService.put("".concat(n,"/switchPresentableVersion"),{version:e});case 3:if(i=a.sent,0===i.data.errcode){a.next=7;break}return a.abrupt("return",t.$message.error("更新版本失败！"));case 7:t.$message.success("更新版本成功！");case 8:case"end":return a.stop()}},a)}))()}},watch:{userDefinedTags:function(e,t){this.initState||JSON.stringify(e)!==JSON.stringify(t)&&(this.updatePresentable({userDefinedTags:e}),this.$message.success(this.$t("tagUpdatedSuccessfully")))},versionValue:function(e,t){null!==t&&this.updateVersion(e)}},computed:{availablePolicies:function(){var e=this,t=this.resolveReleases.find(function(t){return t.releaseId===e.resolveReleaseID});if(!t)return[];var a=t.contracts.map(function(e){return e.policyId}),n=this.releases.find(function(t){return t.releaseId===e.resolveReleaseID});return n?n.policies.filter(function(e){return!a.includes(e.policyId)}):[]}}},Ce=(a(846),a(847),Object(l.a)(Te,n,[],!1,null,"c915dd12",null));Ce.options.__file="src/views/node/manager-release/index.vue";t.default=Ce.exports},954:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"test-management"},[a("div",{staticClass:"test-management__aside"},[a("NodeHeader",{attrs:{nodeName:e.nodeInfo.name,nodeHref:e.nodeInfo.testOrigin,isTestNode:!0,enterNode:"/node/manager/"+e.$route.params.nodeId,btnText:"进入节点管理"}}),e._v(" "),a("div",{staticClass:"test-management__aside__nav"},e._l(e.tabList,function(t,n){return a("a",{key:"tab"+n,class:{"test-management__aside__nav--active":e.selectedTab===t.tab},on:{click:function(a){return e.exchangeTab(t)}}},[e._v(e._s(t.name))])}),0)],1),e._v(" "),a("div",{staticClass:"test-management__main"},["ReleaseList"===e.selectedTab?a("ReleaseList"):e._e(),e._v(" "),"StylePage"===e.selectedTab?a("StylePage"):e._e(),e._v(" "),"MappingRules"===e.selectedTab?a("MappingRules"):e._e()],1)])};n._withStripped=!0;var i=a(428),s=a.n(i),r=a(426),o=a.n(r),c=a(429),l=a(498),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"release-list"},[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("div",{staticClass:"release-list__header"},[a("AddAndReplace",{attrs:{matchTestResult:e.matchTestResult},on:{success:e.pushRuleSuccess}}),e._v(" "),a("el-input",{staticClass:"release-list__header__input",model:{value:e.filterSearch,callback:function(t){e.filterSearch=t},expression:"filterSearch"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:0!==e.filterSearch.length,expression:"filterSearch.length !== 0"}],staticClass:"el-input__icon el-icon-circle-close",staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},on:{click:function(t){e.filterSearch=""}},slot:"suffix"})])],1),e._v(" "),a("div",{staticStyle:{height:"70px"}}),e._v(" "),e.tableData&&0===e.tableData.length?a("div",{staticStyle:{display:"flex",height:"400px","justify-content":"center","align-items":"center",color:"#999","font-size":"22px"}},[a("div",[e._v("您还没有添加任何测试资源。")])]):a("el-table",{staticClass:"release-list__table",attrs:{"empty-text":null===e.tableData?"加载中...":"",data:e.tableData}},[a("el-table-column",{attrs:{prop:"rules",label:"规则","min-width":"12%"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.textRule?a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("RulesBar",{attrs:{slot:"reference",rules:t.row.icons},slot:"reference"}),e._v(" "),a("rule-text",{attrs:{textRule:t.row.textRule}})],1):a("RulesBar",{attrs:{rules:t.row.icons}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"来源|测试展品|展示版本","min-width":"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"text-overflow-ellipsis release-list__table__name"},[t.row.nodePresentableId?a("label",{staticClass:"release-list__table__name--presentable"},[e._v("节点")]):["mock"===t.row.originInfo.type?a("label",{staticClass:"release-list__table__name--mock"},[e._v("mock")]):e._e(),e._v(" "),"release"===t.row.originInfo.type?a("label",{staticClass:"release-list__table__name--release"},[e._v("发行")]):e._e()],e._v(" "),a("span",[e._v(e._s(t.row.testResourceName))])],2),e._v(" "),"mock"!==t.row.originInfo.type?a("div",{staticStyle:{"padding-left":"50px"}},[a("el-select",{staticStyle:{width:"110px",transform:"scale(.714)","transform-origin":"0"},attrs:{placeholder:"请选择",value:t.row.originInfo.version,size:"mini"},on:{change:function(a){return e.onVersionChange(a,t.row)}}},e._l([].concat(t.row.originInfo.versions).reverse(),function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"entries",label:"相关测试资源","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"release-list__table__entries",on:{click:function(a){return e.goToOrigin(t.row.originInfo)}}},[a("div",{staticClass:"resource-default-preview release-list__table__entries__preview"},[t.row.previewImages.length>0?a("img",{staticClass:"resource-default-preview",attrs:{src:t.row.previewImages[0],alt:""}}):e._e()]),e._v(" "),a("div",{staticClass:"release-list__table__entries__info"},[a("div",{staticClass:"text-overflow-ellipsis"},[e._v("\n                            "+e._s(t.row.originInfo.name)+"\n                        ")]),e._v(" "),a("div",[e._v("\n                            "+e._s(t.row.originInfo.versions[t.row.originInfo.versions.length-1])+"\n                        ")])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"type","min-width":"12%"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-dropdown",{staticClass:"release-list__table__type__dropdown",on:{command:e.onChangeType}},[a("div",{staticClass:"release-list__table__type__dropdown__text"},[e._v("\n                        "+e._s(e.selectedType)+" "),a("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.allTypes,function(t){return a("el-dropdown-item",{attrs:{command:t}},[e._v("\n                            "+e._s(t)+"\n                        ")])}),1)],1)]}},{key:"default",fn:function(t){return[a("div",{staticClass:"release-list__table__type__text"},[e._v("\n                    "+e._s(t.row.resourceType)+"\n                ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status","min-width":"12%"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-dropdown",{staticStyle:{height:"32px","padding-left":"0"},on:{command:e.onChangeState}},[a("div",{staticStyle:{"padding-left":"0",cursor:"pointer"}},[e._v("\n                        "+e._s(e.selectedState)+" "),a("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown",trigger:"click"},slot:"dropdown"},e._l(e.allState,function(t){return a("el-dropdown-item",{attrs:{command:t}},[e._v("\n                            "+e._s(t)+"\n                        ")])}),1)],1)]}},{key:"default",fn:function(t){return[a("div",{staticClass:"release-list__table__status"},[1===t.row.differenceInfo.onlineStatusInfo.isOnline?a("span",{staticClass:"release-list__table__status--online"},[e._v("已上线")]):e._e(),e._v(" "),0===t.row.differenceInfo.onlineStatusInfo.isOnline?a("span",{staticClass:"release-list__table__status--downline"},[e._v("未上线")]):e._e(),e._v(" "),2===t.row.resolveReleaseSignStatus?[a("el-popover",{attrs:{placement:"top",width:"150",trigger:"hover"}},[a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[a("span",[e._v("尚未获得测试授权")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.operationCommand("编辑",t.row)}}},[e._v("详情")])],1),e._v(" "),a("i",{staticClass:"el-icon-warning",staticStyle:{"font-size":"20px",color:"#ffc210","margin-left":"8px"},attrs:{slot:"reference"},slot:"reference"})])]:e._e()],2)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operation","min-width":"5%",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{on:{command:function(a){return e.operationCommand(a,t.row)}}},[a("el-button",{staticClass:"release-list__table__operation",attrs:{icon:"el-icon-more",type:"small",circle:""}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"编辑"}},[e._v("\n                            编辑\n                        ")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"isOnline"}},[0===t.row.differenceInfo.onlineStatusInfo.isOnline?a("span",{staticStyle:{color:"#44a0ff"}},[e._v("上线")]):e._e(),e._v(" "),1===t.row.differenceInfo.onlineStatusInfo.isOnline?a("span",{staticStyle:{color:"#ee4040"}},[e._v("下线")]):e._e()]),e._v(" "),e.matchTestResult.testRules.find(function(e){return e.presentableName===t.row.testResourceName})?a("el-dropdown-item",{attrs:{command:"delete"}},[a("span",{staticStyle:{color:"#ee4040"}},[e._v("删除")])]):e._e()],1)],1)]}}])})],1),e._v(" "),e.totalQuantity>10?a("div",{staticClass:"release-list__table__pagination"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[10,20,30,40,50],layout:"total, sizes, prev, pager, next, jumper",total:e.totalQuantity},on:{"current-change":e.onChangeCurrentPage,"size-change":e.onChangePageSize}})],1):e._e()],1)};u._withStripped=!0;var d=a(848).a,p=(a(882),a(883),a(3)),f=Object(p.a)(d,u,[],!1,null,"2797e78e",null);f.options.__file="src/views/node/test-manager/ReleaseList/index.vue";var v=f.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"style-page"},[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("div",{staticClass:"style-page__header"},[a("AddAndReplace",{attrs:{matchTestResult:e.matchTestResult},on:{success:e.pushRuleSuccess}}),e._v(" "),a("el-input",{staticClass:"style-page__header__input",model:{value:e.filterSearch,callback:function(t){e.filterSearch=t},expression:"filterSearch"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:0!==e.filterSearch.length,expression:"filterSearch.length !== 0"}],staticClass:"el-input__icon el-icon-circle-close",attrs:{slot:"suffix"},on:{click:function(t){e.filterSearch=""}},slot:"suffix"})])],1),e._v(" "),a("div",{staticStyle:{height:"70px"}}),e._v(" "),e.tableData&&0===e.tableData.length?a("div",{staticStyle:{display:"flex",height:"400px","justify-content":"center","align-items":"center",color:"#999","font-size":"22px"}},[a("div",[e._v("您还没有为该节点设置主题，节点无法展示。 您可以添加theme类型的测试资源作为节点的主题。")])]):a("el-table",{staticClass:"style-page__table",attrs:{data:e.tableData,"empty-text":null===e.tableData?"加载中...":""}},[a("el-table-column",{attrs:{prop:"rules",label:"规则","min-width":"12%"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.textRule?a("el-popover",{attrs:{placement:"right",width:"670",trigger:"hover"}},[a("RulesBar",{attrs:{slot:"reference",rules:t.row.icons},slot:"reference"}),e._v(" "),a("rule-text",{attrs:{textRule:t.row.textRule}})],1):a("RulesBar",{attrs:{rules:t.row.icons}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"测试展品 | 展示版本","min-width":"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"text-overflow-ellipsis style-page__table__name"},["mock"===t.row.originInfo.type?a("label",{staticClass:"style-page__table__name__mock"},[e._v("mock")]):e._e(),e._v(" "),"release"===t.row.originInfo.type?a("label",{staticClass:"style-page__table__name__release"},[e._v("发行")]):e._e(),e._v(" "),"presentable"===t.row.originInfo.type?a("label",{staticStyle:{width:"40px",display:"inline-block"}},[a("div",{staticStyle:{"border-top":"1px solid #b5b5b5",width:"16px"}})]):e._e(),e._v(" "),a("span",[e._v(e._s(t.row.testResourceName))])]),e._v(" "),"mock"!==t.row.originInfo.type?a("div",{staticStyle:{"padding-left":"50px"}},[a("el-select",{staticStyle:{width:"110px",transform:"scale(.714)","transform-origin":"0"},attrs:{placeholder:"请选择",value:t.row.originInfo.version,size:"mini"},on:{change:function(a){return e.onVersionChange(a,t.row)}}},e._l([].concat(t.row.originInfo.versions).reverse(),function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"entries",label:"相关测试资源","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"style-page__table__entries",on:{click:function(a){return e.goToOrigin(t.row.originInfo)}}},[a("div",{staticClass:"resource-default-preview style-page__table__entries__img"},[t.row.previewImages.length>0?a("img",{staticClass:"resource-default-preview",attrs:{src:t.row.previewImages[0]}}):e._e()]),e._v(" "),a("div",{staticClass:"style-page__table__entries__info"},[a("div",{staticClass:"text-overflow-ellipsis"},[e._v(e._s(t.row.originInfo.name))]),e._v(" "),a("div",[e._v(e._s(t.row.originInfo.version))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"全部类型","min-width":"12%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"style-page__table__type"},[e._v("\n                        "+e._s(e._f("pageBuildFilter")(t.row.resourceType))+"\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status","min-width":"12%"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-dropdown",{staticStyle:{height:"32px","padding-left":"0"},on:{command:e.onChangeState}},[a("div",{staticStyle:{"padding-left":"0",cursor:"pointer"}},[e._v("\n                            "+e._s(e.selectedState)+" "),a("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.allState,function(t){return a("el-dropdown-item",{attrs:{command:t}},[e._v("\n                                "+e._s(t)+"\n                            ")])}),1)],1)]}},{key:"default",fn:function(t){return[a("div",{staticClass:"style-page__table__status"},[t.row.testResourceId===e.activatedThemeId?a("span",{staticStyle:{color:"#000"}},[e._v("已激活")]):e._e(),e._v(" "),t.row.testResourceId!==e.activatedThemeId?a("span",{staticStyle:{color:"#bfbfbf"}},[e._v("未激活")]):e._e(),e._v(" "),2===t.row.resolveReleaseSignStatus?[a("el-popover",{attrs:{placement:"top",width:"100",trigger:"hover"}},[a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[a("span",[e._v("尚未获得测试授权")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.operationCommand("编辑",t.row)}}},[e._v("详情")])],1),e._v(" "),a("i",{staticClass:"el-icon-warning",staticStyle:{"font-size":"20px",color:"#ffc210","margin-left":"8px"},attrs:{slot:"reference"},slot:"reference"})])]:e._e()],2)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operation",label:"操作","min-width":"5%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{on:{command:function(a){return e.operationCommand(a,t.row)}}},[a("el-button",{staticClass:"release-list__table__operation",attrs:{icon:"el-icon-more",type:"small",circle:""}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"edit"}},[e._v("\n                                编辑\n                            ")]),e._v(" "),a("el-dropdown-item",{attrs:{command:t.row.testResourceId!==e.activatedThemeId?"isOnline":""}},[t.row.testResourceId!==e.activatedThemeId?a("div",{staticStyle:{color:"#44a0ff"}},[e._v("激活")]):e._e(),e._v(" "),t.row.testResourceId===e.activatedThemeId?a("div",{staticStyle:{color:"#bfbfbf"}},[e._v("已激活")]):e._e()]),e._v(" "),e.matchTestResult.testRules.find(function(e){return e.presentableName===t.row.testResourceName})?a("el-dropdown-item",{attrs:{command:"delete"}},[a("span",{staticStyle:{color:"#ee4040"}},[e._v("删除")])]):e._e()],1)],1)]}}])})],1),e._v(" "),e.totalQuantity>10?a("div",{staticClass:"style-page__pagination"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[10,20,30,40,50],layout:"total, sizes, prev, pager, next, jumper",total:e.totalQuantity},on:{"current-change":e.onChangeCurrentPage,"size-change":e.onChangePageSize}})],1):e._e()],1)};h._withStripped=!0;var m=a(884).a,g=(a(885),a(886),Object(p.a)(m,h,[],!1,null,"2a3fe7e9",null));g.options.__file="src/views/node/test-manager/StylePage/index.vue";var _=g.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mapping-rule-wrapper"},[a("div",{staticClass:"mapping-rule__header"},[a("div",{staticClass:"mr-btn-group"},[a("el-button",{staticClass:"mr-edit-btn",attrs:{type:"text"},on:{click:e.tapEditBtn}},[a("i",{staticClass:"el-icon-edit"}),e._v(e._s(e.$t("enterBtnText"))+"\n\t\t\t\t")]),e._v(" "),a("el-upload",{staticClass:"mr-import",attrs:{accept:"text/plain","show-file-list":!1,"auto-upload":!1,"on-change":e.rulesImportHandler}},[a("el-button",{attrs:{type:"text"}},[a("i",{staticClass:"el-icon-download"}),e._v(" "+e._s(e.$t("imortBtnText")))])],1),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:e.tapExportBtn}},[a("i",{staticClass:"el-icon-upload2"}),e._v("\n\t\t\t\t\t"+e._s(e.selectedRules.length>0?e.$t("batchExportBtnText"):e.$t("exportAllBtnText"))+"\n\t\t\t\t")]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"rulesDownload",attrs:{href:e.rulesTextDownloadUrl,download:e.rulesTextDownloadName}}),e._v(" "),e.selectedRules.length>0?[a("el-button",{staticClass:"mr-btn--delete",attrs:{type:"text"},on:{click:e.tapBatchDeleteBtn}},[a("i",{staticClass:"el-icon-delete"}),e._v(" "+e._s(e.$t("batchDeletionBtnText")))])]:e._e()],2)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.editorVisible,expression:"!editorVisible"}],staticClass:"mapping-rule__body"},[a("el-table",{ref:"mrTable",staticStyle:{width:"100%"},attrs:{data:e.targetRulesTableData},on:{"selection-change":e.rulesSelectionHandler}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("ruleType"),width:"146"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("rules-bar",{staticClass:"mr-icons",class:{disabled:e.row.matchErrors.length},attrs:{rules:e.row.iconArr}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(e){return[a("rule-text",{attrs:{textRule:e.row}})]}}])},[a("template",{slot:"header"},[a("span",[e._v(e._s(e.$t("mappingRuleContent")))])])],2),e._v(" "),a("el-table-column",{attrs:{label:e.$t("operation"),width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"mrb-btn--delete",attrs:{type:"text"},on:{click:function(a){return e.tapDeleteBtn(t.row)}}},[a("i",{staticClass:"el-icon-delete"})])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"mapping-rule-editor-box",class:{visible:e.editorVisible}},[a("h4",[e._v("\n\t\t\t\t"+e._s(e.$t("editMappingRules"))+"\n\t\t\t\t"),a("el-button",{staticClass:"mr-back-btn",attrs:{type:"text"},on:{click:e.tapBackBtn}},[a("i",{staticClass:"el-icon-back"}),e._v(" "+e._s(e.$t("exitBtnText"))+"\n\t\t\t\t")])],1),e._v(" "),a("div",{staticClass:"mapping-rule-input-box"},[a("codemirror",{ref:"codeMirror",class:{hasErrors:13===e.rulesInputRowsCount},attrs:{code:e.rulesText,options:e.editorOptions},on:{input:e.onCodeChange}}),e._v(" "),a("div",{staticClass:"mr-rb-btns-box"},[a("el-button",{staticClass:"mr-rb-save-btn",attrs:{type:"primary",size:"small",round:""},on:{click:e.tapSaveBtn}},[e._v(e._s(e.$t("saveBtnText")))])],1)],1),e._v(" "),a("div",{staticClass:"mapping-rule-errors-box"},[""!==e.syntaxErrorsText?[a("h4",{staticClass:"syntax-error__title"},[e._v(e._s(e.$t("errors[2]")))]),e._v(" "),a("ul",{domProps:{innerHTML:e._s(e.syntaxErrorsText)}})]:e._e(),e._v(" "),""!==e.matchErrorsText?[a("h4",{staticClass:"match-error__title"},[e._v(e._s(e.$t("errors[3]")))]),e._v(" "),a("ul",{domProps:{innerHTML:e._s(e.matchErrorsText)}})]:e._e()],2),e._v(" "),""!==e.matchResultsText?a("div",{staticClass:"mapping-rule-match-result"},[a("h4",{staticClass:"match-result__title"},[e._v(e._s(e.$t("matchResultsTexts[0]")))]),e._v(" "),a("ul",{domProps:{innerHTML:e._s(e.matchResultsText)}})]):e._e()])])};y._withStripped=!0;var x=a(651).a,b=(a(887),a(888),a(889)),w=Object(p.a)(x,y,[],!1,null,"f3464614",null);"function"==typeof b.default&&Object(b.default)(w),w.options.__file="src/views/node/test-manager/MappingRules/index.vue";var S=w.exports,T={name:"test-management",components:{NodeHeader:a(753).a,clipboard:l.a,ReleaseList:v,StylePage:_,MappingRules:S},data:function(){return{styleObject:{minHeight:window.innerHeight-60+"px"},selectedTab:this.$route.query.tab||"ReleaseList",nodeInfo:{origin:"",name:""},tabList:[{name:"展品管理",tab:"ReleaseList"},{name:"主题管理",tab:"StylePage"},{name:"映射规则管理",tab:"MappingRules"}]}},mounted:function(){this.handleNodeInfo()},methods:{handleNodeInfo:function(){var e=this;return Object(c.coroutine)(s.a.mark(function t(){var a,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/v1/nodes/".concat(e.$route.params.nodeId));case 2:a=t.sent,n=[a.data.data.nodeDomain].concat(o()(window.location.origin.split(".").filter(function(e,t,a){return t>=a.length-2}))).join("."),e.nodeInfo={origin:n,name:a.data.data.nodeName,testOrigin:"t."+n};case 5:case"end":return t.stop()}},t)}))()},exchangeTab:function(e){this.selectedTab=e.tab,this.$router.replace({path:this.$route.path,query:{tab:e.tab}})}}},C=(a(890),Object(p.a)(T,n,[],!1,null,"a5614e10",null));C.options.__file="src/views/node/test-manager/index.vue";t.default=C.exports},963:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"node-manager"},[a("div",{staticClass:"node-manager__aside"},[a("NodeHeader",{attrs:{nodeName:e.nodeInfo.name,nodeHref:e.nodeInfo.origin,isTestNode:!1,enterNode:"/node/test-manager/"+e.$route.params.nodeId,btnText:e.$t("gotoTest")}}),e._v(" "),a("div",{staticClass:"node-manager__aside__navs"},[a("a",{class:{"node-manager__aside__navs__a--active":!e.isPageStyle},on:{click:function(t){return e.switchIsPageStyle(!1)}}},[e._v(e._s(e.$t("presentableManagement")))]),e._v(" "),a("a",{class:{"node-manager__aside__navs__a--active":e.isPageStyle},style:{backgroundColor:e.isPageStyle?"#fff":"transparent",borderRight:e.isPageStyle?"3px solid #409eff":"none",color:e.isPageStyle?"#409eff":"#333"},on:{click:function(t){return e.switchIsPageStyle(!0)}}},[e._v(e._s(e.$t("nodePageStyle")))])])],1),e._v(" "),a("div",{staticClass:"node-manager__main"},[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("div",{staticClass:"node-manager__main__header"},[a("div"),e._v(" "),a("el-input",{staticClass:"node-manager__main__header__input",attrs:{debounce:"1000"},model:{value:e.filterSearch,callback:function(t){e.filterSearch=t},expression:"filterSearch"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:e.filterSearch&&e.filterSearch.length>0,expression:"filterSearch && filterSearch.length > 0"}],staticClass:"el-input__icon el-icon-circle-close",attrs:{slot:"suffix"},on:{click:function(t){e.filterSearch=""}},slot:"suffix"})])],1),e._v(" "),e.tableData&&0===e.tableData.length?[a("div",{staticStyle:{height:"40px"}}),e._v(" "),a("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"center"}}),e._v(" "),a("div",{staticStyle:{display:"flex",height:"400px","justify-content":"center","align-items":"center",color:"#999","font-size":"22px"}},[a("div",[a("span",[e._v(e._s(e.isPageStyle?e.$t("notSetTheme"):e.$t("notAdded")))]),e._v(" "),a("router-link",{staticClass:"nav-link ls-nav-link",attrs:{to:e.isPageStyle?"/?q=page_build":"/",target:"_blank"}},[a("el-button",{staticStyle:{"border-radius":"2px","background-color":"#409EFF"},attrs:{type:"primary"}},[e._v("\n                                "+e._s(e.isPageStyle?e.$t("addTheme"):e.$t("toMarket"))+"\n                            ")])],1)],1)])]:[a("div",{staticStyle:{height:"80px"}}),e._v(" "),a("el-table",{staticClass:"node-manager__main__table",attrs:{"empty-text":null===e.tableData?e.$t("loading")+"...":"",data:e.tableData}},[a("el-table-column",{attrs:{prop:"presentableName","min-width":"18%"},scopedSlots:e._u([{key:"header",fn:function(t){return a("div",{staticStyle:{"padding-left":"16px"}},[e._v("\n                            展品 | 展示版本\n                        ")])}},{key:"default",fn:function(t){return a("div",{staticStyle:{"padding-left":"16px"}},[a("a",{staticClass:"text-overflow-ellipsis node-manager__main__table__name",on:{click:function(a){return e.handleOperation("edit",t.row)}}},[e._v(e._s(t.row.presentableName))]),e._v(" "),a("el-select",{staticStyle:{width:"110px",transform:"scale(.714)","transform-origin":"0"},attrs:{placeholder:"请选择",value:t.row.releaseInfo.version,size:"mini"},on:{change:function(a){return e.onVersionChange(a,t.row)}}},e._l([].concat(t.row.releaseInfo.versions).reverse(),function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"publish",label:"相关发行","min-width":"20%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"node-manager__main__table__release",attrs:{href:"/release/detail/"+t.row.releaseInfo.releaseId+"?version="+t.row.releaseInfo.version,target:"_blank"}},[a("div",{staticClass:"resource-default-preview node-manager__main__table__release__preview"},[t.row.releaseInfo.previewImages&&t.row.releaseInfo.previewImages.length>0?a("img",{staticClass:"resource-default-preview",staticStyle:{width:"100%",height:"100%"},attrs:{src:t.row.releaseInfo.previewImages[0],alt:""}}):e._e()]),e._v(" "),a("div",{staticClass:"node-manager__main__table__release__content"},[a("div",{staticClass:"text-overflow-ellipsis node-manager__main__table__release__content__name"},[e._v("\n                                        "+e._s(t.row.releaseInfo.releaseName)+"\n                                    ")]),e._v(" "),a("div",{staticClass:"node-manager__main__table__release__content__version"},[e._v("\n                                        "+e._s(t.row.releaseInfo.versions[t.row.releaseInfo.versions.length-1])+"\n                                    ")])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:e.$t("table.type"),"min-width":"12%"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-dropdown",{staticStyle:{height:"32px"}},[a("div",[e._v("\n                                    "+e._s(e.selectedType)+" "),e.isPageStyle?e._e():a("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),e.isPageStyle?e._e():a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.allTypes,function(t){return a("el-dropdown-item",[a("a",{staticStyle:{display:"block",width:"100%",height:"100%"},on:{click:function(a){return e.onChangeType(t)}}},[e._v(e._s(t))])])}),1)],1)]}},{key:"default",fn:function(t){return[a("div",{staticClass:"node-manager__main__table__type"},[e._v("\n                                "+e._s(e._f("pageBuildFilter")(t.row.releaseInfo.resourceType))+"\n                            ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"policies",label:e.$t("table.policies"),"min-width":"14%"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticClass:"table-policies node-manager__main__table__policy"},[a("el-popover",{attrs:{placement:"bottom-start",width:"400",trigger:"hover",disabled:0===t.row.policies.length}},[a("PolicyTabs",{attrs:{policies:t.row.policies}}),e._v(" "),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"node-manager__main__table__policy__box"},[t.row.policies.length>0?a("div",{staticClass:"node-manager__main__table__policy__box--then-zero"},[e._v("\n                                            "+e._s(t.row.policies[0].policyName)+"\n                                        ")]):e._e(),e._v(" "),0===t.row.policies.length?a("div",{staticClass:"node-manager__main__table__policy__box--zero"},[e._v("\n                                            "+e._s(e.$t("noPolicy"))+"\n                                        ")]):e._e(),e._v(" "),t.row.policies.length>1?a("div",{staticClass:"node-manager__main__table__policy__box--then-one"},[e._v("\n                                            "+e._s(e.$t("suchAs"))+e._s(t.row.policies.length)+e._s(e.$t("policies"))+"…\n                                        ")]):e._e()])])],1),e._v(" "),a("a",{staticClass:"node-manager__main__table__policy__add",on:{click:function(a){return e.goToAddPolicyPage(t.row.presentableId)}}},[a("i",{staticClass:"el-icon-plus"})])],1)}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:e.$t("table.updateTime"),"min-width":"18%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"node-manager__main__table__date"},[a("div",{staticClass:"node-manager__main__table__date__update"},[e._v("\n                                    "+e._s(e.dateStringToFormat(t.row.updateDate))+"\n                                ")]),e._v(" "),a("div",{staticClass:"node-manager__main__table__date__create"},[e._v(e._s(e.$t("joined"))+"\n                                    "+e._s(e.dateStringToFormat(t.row.createDate))+"\n                                ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"state",label:e.$t("table.state"),"min-width":"12%"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-dropdown",{staticStyle:{height:"32px"}},[a("div",[e._v("\n                                    "+e._s(e.selectedState)+" "),a("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.allState,function(t){return a("el-dropdown-item",[a("a",{staticClass:"node-manager__main__table__state__button",on:{click:function(a){return e.onChangeState(t)}}},[e._v(e._s(t))])])}),1)],1)]}},{key:"default",fn:function(t){return[a("div",{staticClass:"node-manager__main__table__state__text"},[1===t.row.isOnline?a("span",{staticClass:"node-manager__main__table__state__text--online"},[e._v("\n                                "+e._s("page_build"===t.row.releaseInfo.resourceType?"已激活":e.$t("online"))+"\n                            ")]):e._e(),e._v(" "),0===t.row.isOnline?a("span",{staticClass:"node-manager__main__table__state__text--no-online"},[e._v("\n                                 "+e._s("page_build"===t.row.releaseInfo.resourceType?"未激活":e.$t("noOnline"))+"\n                            ")]):e._e(),e._v(" "),t.row.isAuth?e._e():[a("el-popover",{attrs:{placement:"top",width:"160",trigger:"hover"}},[a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[a("span",[e._v(e._s(e.$t("exceptionExists")))]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleOperation("edit",t.row)}}},[e._v("详情\n                                            ")])],1),e._v(" "),a("i",{staticClass:"el-icon-warning",attrs:{slot:"reference"},slot:"reference"})])]],2)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operation",label:e.$t("table.operation"),"min-width":"5%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{on:{command:function(a){return e.handleOperation(a,t.row)}}},[a("el-button",{staticClass:"node-manager__main__table__operation",attrs:{icon:"el-icon-more",type:"small",circle:""}}),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"edit"}},[a("a",{staticClass:"node-manager__main__table__operation__dropdown-link"},[e._v(e._s(e.$t("action.edit")))])]),e._v(" "),a("el-dropdown-item",{attrs:{command:"page_build"!==t.row.releaseInfo.resourceType||0===t.row.isOnline?"online":""}},[a("a",{staticStyle:{display:"block",width:"100%",height:"100%"}},["page_build"===t.row.releaseInfo.resourceType?a("span",{staticStyle:{color:"#44a0ff"}},[0===t.row.isOnline?a("div",[e._v("激活")]):e._e(),e._v(" "),1===t.row.isOnline?a("div",{staticStyle:{color:"#bfbfbf"}},[e._v("已激活")]):e._e()]):[0===t.row.isOnline?a("span",{staticStyle:{color:"#44a0ff"}},[e._v(e._s(e.$t("action.online")))]):e._e(),e._v(" "),1===t.row.isOnline?a("span",{staticStyle:{color:"#ee4040"}},[e._v(e._s(e.$t("action.downline")))]):e._e()]],2)])],1)],1)]}}])})],1),e._v(" "),e.totalQuantity>10?a("div",{staticClass:"node-manager__main__pagination"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":[10,20,30,40,50],layout:"total, sizes, prev, pager, next, jumper",total:e.totalQuantity},on:{"current-change":e.onChangeCurrentPage,"size-change":e.onChangePageSize}})],1):e._e()]],2)])};n._withStripped=!0;var i=a(428),s=a.n(i),r=a(426),o=a.n(r),c=a(429),l=a(498),u=a(487),d=a(753),p=null,f={name:"manager",i18n:{messages:{en:{copySuccess:"Copy Success",nodeReleaseList:"Node lists of release",nodePageStyle:"Theme",all:"All",pending:"Pending",table:{publish:"Release",presentableName:"Title",type:"All Type",policies:"Policy",updateTime:"UpdateTime",state:"All State",operation:"Operation"},allType:"AllType",allState:"AllState",online:"Online",noOnline:"NoOnline",contractException:"ContractException",noPolicy:"No policy",suchAs:"Such as ",policies:" policies",joined:"Joined",exceptionExists:"This exception exists on the contractual chain",action:{edit:"Edit",top:"Top",upgrade:"Upgrade",online:"Online",downline:"Downline"},cannotOnline:{noPolicy:"Cannot be on the line : No authorization policy is available",exceptions:"Cannot be on the line : authorized chain of exceptions"},gotoTest:"Test node management",presentableManagement:"Presentable",notAdded:"You have not added any issue to the node",notSetTheme:'You have not set a theme for the node, the node cannot be shown. You can add a " theme " theme of the issue as a node of Type',toMarket:"To release the market",addTheme:"AddTheme",loading:"Loading"},"zh-CN":{copySuccess:"复制成功",nodeReleaseList:"节点发行列表",nodePageStyle:"主题管理",all:"全部",pending:"待处理",table:{publish:"发行",presentableName:"发行标题",type:"全部类型",policies:"策略",updateTime:"更新时间",state:"全部状态",operation:"操作"},allType:"全部类型",allState:"全部状态",online:"已上线",noOnline:"未上线",contractException:"合约异常",noPolicy:"暂无策略",suchAs:"等",policies:"个策略",joined:"加入时间",exceptionExists:"此合约链上存在异常",action:{edit:"编辑",top:"置顶",upgrade:"升级",online:"上线",downline:"下线"},cannotOnline:{noPolicy:"无法上线：没有可用的授权策略",exceptions:"无法上线：授权链异常"},gotoTest:"进入测试节点管理",presentableManagement:"展品管理",notAdded:"您还没有添加任何发行到该节点",notSetTheme:"您还没有为该节点设置主题，节点无法展示。 您可以添加“theme”类型的发行作为节点的主题",toMarket:"前往发行市场",addTheme:"添加主题",loading:"加载中"}}},components:{clipboard:l.a,PolicyTabs:u.a,NodeHeader:d.a},data:function(){return{styleObject:{minHeight:window.innerHeight-60+"px"},nodeInfo:{origin:"",name:""},isPageStyle:this.$route.query.isPageStyle&&"true"===this.$route.query.isPageStyle,filterTodo:"全部",filterSearch:"",tableData:null,allTypes:[this.$t("allType"),"json","widget","image","audio","markdown","reveal_slide","license","video","catalog"],selectedType:this.$t("allType"),allState:[this.$t("allState"),this.$t("online"),this.$t("noOnline"),this.$t("contractException")],selectedState:this.$t("allState"),currentPage:1,pageSize:10,totalQuantity:0}},mounted:function(){this.handleTableData(),this.handleNodeInfo(),this.listenWindowVisibility()},methods:{listenWindowVisibility:function(){var e=this,t="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null,a=t.replace(/hidden/i,"visibilitychange");document.addEventListener(a,function(){document[t]||e.handleTableData()})},switchIsPageStyle:function(e){this.isPageStyle!==e&&(this.isPageStyle=e,this.$router.replace(this.$route.path+"?isPageStyle="+e))},handleNodeInfo:function(){var e=this;return Object(c.coroutine)(s.a.mark(function t(){var a,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/v1/nodes/".concat(e.$route.params.nodeId));case 2:a=t.sent,n=[a.data.data.nodeDomain].concat(o()(window.location.origin.split(".").filter(function(e,t,a){return t>=a.length-2}))).join("."),e.nodeInfo={origin:n,name:a.data.data.nodeName};case 5:case"end":return t.stop()}},t)}))()},handleTableData:function(){var e=this;return Object(c.coroutine)(s.a.mark(function t(){var a,n,i,r,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={nodeId:e.$route.params.nodeId,page:e.currentPage,pageSize:e.pageSize,resourceType:e.isPageStyle?"page_build":e.selectedType===e.$t("allType")?void 0:e.selectedType,isOnline:e.stateTextToValue(e.selectedState),keywords:e.filterSearch||void 0,omitResourceType:e.isPageStyle?void 0:"page_build"},t.next=3,e.$axios.get("/v1/presentables",{params:a});case 3:return n=t.sent,e.totalQuantity=n.data.data.totalItem,e.tableData=n.data.data.dataList.map(function(e){return{presentableId:e.presentableId,presentableName:e.presentableName,releaseInfo:e.releaseInfo,policies:e.policies,updateDate:e.updateDate,createDate:e.createDate,isOnline:e.isOnline,isAuth:!0}}),i={presentableIds:e.tableData.map(function(e){return e.presentableId}).join(",")},t.next=9,e.$axios.get("/v1/auths/presentables/batchNodeAndReleaseSideAuth",{params:i});case 9:for(r=t.sent,o=0;o<e.tableData.length;o++)e.tableData[o].isAuth=r.data.data[o].authResult.isAuth;case 11:case"end":return t.stop()}},t)}))()},onVersionChange:function(e,t){var a=this;return Object(c.coroutine)(s.a.mark(function n(){var i,r;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.presentableId,n.next=3,a.$services.PresentablesService.put("".concat(i,"/switchPresentableVersion"),{version:e});case 3:if(r=n.sent,0===r.data.errcode){n.next=7;break}return n.abrupt("return",a.$message.error("更新版本失败！"));case 7:a.$message.success("更新版本成功！"),t.releaseInfo.version=e;case 9:case"end":return n.stop()}},n)}))()},spaceReplaceNbsp:function(e){return e.replace(/\n/g,"<br/>").replace(/\s/g,"&nbsp;")},dateStringToFormat:function(e){var t=new Date(e);return[t.getFullYear(),t.getMonth()+1,t.getDate()].join(".")},stateTextToValue:function(e){switch(e){case this.$t("allState"):return 2;case this.$t("online"):return 1;case this.$t("noOnline"):return 0;default:return 2}},onChangeType:function(e){this.selectedType=e},onChangeState:function(e){this.selectedState=e},onChangeCurrentPage:function(e){this.currentPage=e},onChangePageSize:function(e){this.pageSize=e},goToEditPage:function(e){window.open("/node/manager-release/".concat(e))},goToAddPolicyPage:function(e){window.open("/node/manager-release/".concat(e,"?addPolicy=true"))},onLineAndOffLine:function(e){var t=this;return Object(c.coroutine)(s.a.mark(function a(){var n;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==e.isOnline){a.next=5;break}if(e.policies&&0!==e.policies.length){a.next=3;break}return a.abrupt("return",t.$message.error(t.$t("cannotOnline.noPolicy")));case 3:if(e.isAuth){a.next=5;break}return a.abrupt("return",t.$message.error(t.$t("cannotOnline.exceptions")));case 5:return a.next=7,t.$axios.put("/v1/presentables/".concat(e.presentableId,"/switchOnlineState"),{onlineState:0===e.isOnline?1:0});case 7:if(0===(n=a.sent).data.errcode){a.next=10;break}return a.abrupt("return",t.$message.error(n.data.msg));case 10:0===e.isOnline?t.$message.success("page_build"===e.releaseInfo.resourceType?"激活成功":"上线成功"):t.$message.success("下线成功"),t.handleTableData();case 12:case"end":return a.stop()}},a)}))()},handleOperation:function(e,t){"edit"===e?this.goToEditPage(t.presentableId):"online"===e&&this.onLineAndOffLine(t)}},watch:{isPageStyle:function(){this.filterSearch="",this.selectedType=this.$t("allType"),this.selectedState=this.$t("allState"),this.currentPage=1,this.pageSize=10,this.handleTableData()},selectedType:function(){this.currentPage=1,this.pageSize=10,this.handleTableData()},selectedState:function(){this.currentPage=1,this.pageSize=10,this.handleTableData()},filterSearch:function(){var e=this;p&&clearTimeout(p),p=setTimeout(function(){e.currentPage=1,e.pageSize=10,e.handleTableData()},300)},pageSize:function(){this.currentPage=1,this.handleTableData()},currentPage:function(){this.handleTableData()}}},v=(a(835),a(836),a(3)),h=Object(v.a)(f,n,[],!1,null,"ff79ee86",null);h.options.__file="src/views/node/manager/index.vue";t.default=h.exports},966:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"node-creator-container"},[a("el-form",{ref:"dataForm",staticClass:"node-form",attrs:{model:e.dataForm,rules:e.formRules,"label-width":"0"}},[a("el-form-item",{staticClass:"node-creator-input-item",attrs:{prop:"nodeDomain"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.dataForm.nodeDomain,expression:"dataForm.nodeDomain"}],staticClass:"node-creator-input",attrs:{type:"text",placeholder:e.$t("node.createPlaceholders.domain")},domProps:{value:e.dataForm.nodeDomain},on:{change:e.toLowerCase,blur:e.trimNodeDomain,input:function(t){t.target.composing||e.$set(e.dataForm,"nodeDomain",t.target.value)}}}),e._v(" "),a("span",{staticClass:"node-domain-postfix"},[e._v(e._s(e.domainPostfix))])]),e._v(" "),a("el-form-item",{staticClass:"node-creator-input-item",attrs:{prop:"nodeName"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.dataForm.nodeName,expression:"dataForm.nodeName"}],staticClass:"node-creator-input",attrs:{type:"text",placeholder:e.$t("node.createPlaceholders.name")},domProps:{value:e.dataForm.nodeName},on:{blur:e.trimNodeName,input:function(t){t.target.composing||e.$set(e.dataForm,"nodeName",t.target.value)}}})]),e._v(" "),a("el-form-item",{staticClass:"ft-btns"},[a("el-button",{staticClass:"ft-btn",attrs:{round:""},on:{click:e.goBackHandler}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),a("el-button",{staticClass:"ft-btn",attrs:{round:"",type:"primary"},on:{click:function(t){return e.submitForm("dataForm")}}},[e._v(e._s(e.$t("node.createNode")))])],1)],1)],1)};n._withStripped=!0;var i={name:"node-creator",data:function(){var e=this;return{dataForm:{nodeName:"",nodeDomain:""},formRules:{nodeName:[{required:!0,message:this.$t("node.nodeNameRules.noEmpty"),trigger:"blur"},{validator:function(t,a,n){a?a.length<2||a.length>24?n(new Error(e.$t("node.nodeNameRules.length"))):/^[\u4E00-\u9FA5|a-z|0-9|A-Z]+$/.test(a)?n():n(new Error(e.$t("node.nodeNameRules.prefix"))):n(new Error(e.$t("node.nodeNameRules.noEmpty")))},trigger:"blur"},{min:4,max:20,message:this.$t("node.nodeNameRules.length"),trigger:"blur"}],nodeDomain:[{validator:function(t,a,n){a?a.length<4||a.length>20?n(new Error(e.$t("node.createRules.length"))):/^[a-z\d-]+$/.test(a)?n():n(new Error(e.$t("node.createRules.prefix"))):n(new Error(e.$t("node.createRules.noEmpty")))},trigger:"blur"}]}}},computed:{domainPostfix:function(){return/\.test/.test(window.location.host)?".testfreelog.com":".freelog.com"}},mounted:function(){},methods:{goBackHandler:function(){window.history.back()},createNode:function(){var e=this,t=this;t.dataForm.nodeName=t.dataForm.nodeName.replace(/^(\s*)|(\s*)$/g,"");var a=Object.assign({},t.dataForm);a.nodeDomain=a.nodeDomain.toLowerCase(),t.$services.nodes.post(t.dataForm).then(function(a){var n=a.data;0!==n.errcode?e.$message.error(n.msg):(t.$message.success(e.$t("node.createSuccess")),e.$store.dispatch("addNode",n.data),setTimeout(function(){t.$router.push({path:"/node/manager/".concat(n.data.nodeId)})},1e3))}).catch(this.$error.showErrorMessage)},comfirm:function(){return this.$confirm(this.$t("node.confirmMessages.question"),this.$t("node.confirmMessages.tip"),{confirmButtonText:this.$t("node.confirmMessages.confirm"),cancelButtonText:this.$t("node.confirmMessages.cancel"),type:"warning"})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.comfirm().then(function(){t.createNode()}).catch(function(){})})},trimNodeDomain:function(){this.dataForm.nodeDomain=this.dataForm.nodeDomain.replace(/^(\s*)|(\s*)$/g,"")},toLowerCase:function(){this.dataForm.nodeDomain=this.dataForm.nodeDomain.toLowerCase()},trimNodeName:function(){this.dataForm.nodeName=this.dataForm.nodeName.replace(/^(\s*)|(\s*)$/g,"")}}},s=(a(832),a(833),a(3)),r=Object(s.a)(i,n,[],!1,null,"2411477c",null);r.options.__file="src/views/node/create/index.vue";t.default=r.exports},970:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{width:"1190px",margin:"0 auto"}},[a("div",{staticStyle:{height:"30px"}}),e._v(" "),e.originInfo?a("OverviewHeader",{attrs:{theID:e.originInfo.theID,previewSrc:e.originInfo.previewImage,title:e.originInfo.name,type:e.originInfo.type,resourceType:e._f("pageBuildFilter")(e.originInfo.resourceType),version:e.originInfo.version,content:e.originInfo.intro}}):e._e(),e._v(" "),a("ModuleBlock",["page_build"!==e.originInfo.resourceType?a("BlockItem",{attrs:{label:"状态"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isOnline,expression:"!isOnline"}],staticStyle:{display:"flex","align-items":"center"}},[a("label",{staticStyle:{"font-size":"14px",color:"#333","font-weight":"600","padding-right":"40px"}},[e._v("未上线")]),e._v(" "),a("a",{staticStyle:{display:"inline-block","line-height":"28px","background-color":"#409eff",color:"#fff",width:"60px","text-align":"center","border-radius":"14px","font-weight":"600",cursor:"pointer"},on:{click:e.onLineAndOffLine}},[e._v("上线")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isOnline,expression:"isOnline"}],staticStyle:{display:"flex","align-items":"center"}},[a("label",{staticStyle:{"font-size":"14px",color:"#333","font-weight":"600","padding-right":"40px"}},[e._v("已上线")]),e._v(" "),a("a",{staticStyle:{display:"inline-block","line-height":"28px","background-color":"#409eff",color:"#fff",width:"60px","text-align":"center","border-radius":"14px","font-weight":"600",cursor:"pointer"},on:{click:e.onLineAndOffLine}},[e._v("下线")])])]):e._e(),e._v(" "),"page_build"===e.originInfo.resourceType?a("BlockItem",{attrs:{label:"状态"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.activatedThemeId!==e.testResourceID,expression:"activatedThemeId !== testResourceID"}],staticStyle:{display:"flex","align-items":"center"}},[a("label",{staticStyle:{"font-size":"14px",color:"#333","font-weight":"600","padding-right":"40px"}},[e._v("未激活")]),e._v(" "),a("a",{staticStyle:{display:"inline-block","line-height":"28px","background-color":"#409eff",color:"#fff",width:"60px","text-align":"center","border-radius":"14px","font-weight":"600",cursor:"pointer"},on:{click:e.activateTheme}},[e._v("激活")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.activatedThemeId===e.testResourceID,expression:"activatedThemeId === testResourceID"}],staticStyle:{display:"flex","align-items":"center"}},[a("label",{staticStyle:{"font-size":"14px",color:"#333","font-weight":"600","padding-right":"40px"}},[e._v("已激活")])])]):e._e(),e._v(" "),a("BlockItem",{attrs:{label:"节点发行名称"}},[e.originInfo?a("ConfirmInput",{attrs:{disabled:!!e.nodePresentableId,value:e.testResourceName},on:{confirmChange:e.confirmChange}}):e._e()],1),e._v(" "),0!==e.versions.length?a("BlockItem",{attrs:{label:"展示版本"}},[a("el-select",{staticStyle:{display:"block",width:"700px","background-color":"#fafbfb","font-weight":"600"},model:{value:e.versionValue,callback:function(t){e.versionValue=t},expression:"versionValue"}},e._l(e.versions,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1):e._e(),e._v(" "),a("BlockItem",{attrs:{label:"标签"}},[a("div",{staticStyle:{height:"5px"}}),e._v(" "),a("FreelogTags",{model:{value:e.userDefinedTags,callback:function(t){e.userDefinedTags=t},expression:"userDefinedTags"}})],1)],1),e._v(" "),a("ContentBlock",{attrs:{title:"授权管理"}},[a("DisplayEditContracts")],1)],1)};n._withStripped=!0;var i=a(891).a,s=a(3),r=Object(s.a)(i,n,[],!1,null,"1093f759",null);r.options.__file="src/views/node/test-manager-resource/index.vue";t.default=r.exports}}]);