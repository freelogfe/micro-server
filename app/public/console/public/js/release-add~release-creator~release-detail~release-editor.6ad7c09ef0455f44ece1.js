(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{455:function(e,t,s){"use strict";s.r(t),s.d(t,"CONTRACT_STATUS",function(){return c}),s.d(t,"CONTRACT_STATUS_TIPS",function(){return i}),s.d(t,"CONTRACT_STATUS_COLORS",function(){return n});var a=s(1),c={uncreated:-1,initial:1,running:2,activated:3,userTerminated:4,sysTerminated:5,terminated:6},i={"-1":a.a.t("config.contract.statesTip[0]"),1:a.a.t("config.contract.statesTip[1]"),2:a.a.t("config.contract.statesTip[2]"),3:a.a.t("config.contract.statesTip[3]"),4:a.a.t("config.contract.statesTip[4]"),5:"",6:a.a.t("config.contract.statesTip[6]")},n={"-1":{type:"danger",desc:i[-1]},1:{type:"warning",desc:i[1]},2:{type:"warning",desc:i[2]},3:{type:"info",desc:i[3]},4:{type:"success",desc:i[4]},5:{type:"info",desc:""},6:{type:"info",desc:i[6]}}},522:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"scheme-manage-wrapper"},[s("div",{staticClass:"s-m-w-tags"},["create"!==e.type?[s("span",[s("i",{staticClass:"contract-status status-2"}),e._v(e._s(e.$t("contractStatus[0]")))]),e._v(" "),s("span",[s("i",{staticClass:"contract-status status-4"}),e._v(e._s(e.$t("contractStatus[1]")))]),e._v(" "),s("span",[s("i",{staticClass:"contract-status status-6"}),e._v(e._s(e.$t("contractStatus[2]")))])]:e._e(),e._v(" "),s("span",[s("i",{staticClass:"el-icon-top"}),e._v(e._s(e.$t("contractStatus[3]")))])],2),e._v(" "),s("div",{staticClass:"cont clearfix"},[s("div",{staticClass:"s-m-w-c-left"},e._l(e.depReleasesDetailList,function(t,a){return s("div",{key:"dep-box-"+a},[s("release-depend-item",{attrs:{release:t,"is-active":e.selectedRelease.releaseId===t.releaseId,resolveStatus:t.resolveStatus,contractsMap:e.contractsMap},on:{"exchange-item":e.exchangeSelectedRelease}}),e._v(" "),e._l(t.baseUpcastReleases,function(t,a){return s("release-depend-item",{key:"dep-item-"+a,attrs:{"is-scond-level":"",release:t,"is-active":e.selectedRelease.releaseId===t.releaseId,resolveStatus:t.resolveStatus,contractsMap:e.contractsMap},on:{"exchange-item":e.exchangeSelectedRelease}})})],2)}),0),e._v(" "),s("div",{staticClass:"s-m-w-c-right"},["create"===e.type?[s("div",{staticClass:"s-m-w-c-upcast-box"},[s("div",{staticClass:"s-m-w-c-ub-head"},[s("el-radio",{attrs:{label:!0},model:{value:e.isSelectedReleaesUpcast,callback:function(t){e.isSelectedReleaesUpcast=t},expression:"isSelectedReleaesUpcast"}},[e._v(e._s(e.$t("upcast")))]),e._v(" "),s("el-tooltip",{attrs:{placement:"right",effect:"light"}},[s("i",{staticClass:"el-icon-info",class:[{selected:e.isSelectedReleaesUpcast}]}),e._v(" "),s("div",{staticClass:"s-m-w-c-ubh-tip",attrs:{slot:"content"},slot:"content"},[e._v("\n                如果因为某些原因无法和依赖发行的授权方达成合约，您可以选择将依赖上抛给最终整合方解决。\n                "),s("ul",[s("li",[e._v("请注意依赖发行一旦被上抛就不能再签约了。")]),e._v(" "),s("li",[e._v("基础上抛是在发行的第一个版本的授权方案中被上抛的依赖。")]),e._v(" "),s("li",[e._v("基础上抛贯穿发行的所有版本，发行中新版本上抛的依赖都不能超过基础上抛的范围。")])])])])],1)]),e._v(" "),s("div",{staticClass:"s-m-w-c-p-wrapper",class:[{disabled:e.isSelectedReleaesUpcast}]},[s("div",{staticClass:"s-m-w-c-head"},[s("el-radio",{attrs:{label:!1},model:{value:e.isSelectedReleaesUpcast,callback:function(t){e.isSelectedReleaesUpcast=t},expression:"isSelectedReleaesUpcast"}},[e._v(e._s(e.$t("signContractBtnText")))]),e._v(" "),s("el-tooltip",{attrs:{placement:"right",effect:"light"}},[s("div",{staticClass:"s-m-w-c-ubh-tip",attrs:{slot:"content"},slot:"content"},[e._v("\n                作为被授权方，如果您满足且接受授权方的授权策略，则可以选择和授权方签约。授权双方之间存在一个按照未来发生的事件改变资源授权状态的机制，称之为合约。\n                "),s("ul",[s("li",[e._v("合约的复用：授权方和被授权方的合约在同一个授权方（节点或发行）范围内可以复用。")]),e._v(" "),s("li",[e._v("合约的启用和停用：如果您和授权方的多个授权策略签订了多个合约，则在管理合约时，至少要有一个合约是启用状态。您可以选择启用或者停用其中某一个或某几个合约，在授权链中，系统仅会验证启用合约的授权状态。")])])]),e._v(" "),s("i",{staticClass:"el-icon-info"})])],1),e._v(" "),e._l(e.tmpNoSignedPolicies,function(t,a){return s("div",{key:"p-nosigned-"+a,staticClass:"s-m-w-c-policy",class:{offline:0===t.status&&!(e.contractsMap&&e.contractsMap[t.contractId])}},[s("div",{staticClass:"smw-c-p-box"},[s("div",{staticClass:"p-name",class:[e.type],on:{click:function(s){return e.selectPolicy(e.tmpNoSignedPolicies,t,a)}}},[t.isSelected?s("i",{staticClass:"el-icon-check"}):s("span",{staticClass:"p-n-check-box"}),e._v("\n                "+e._s(t.policyName)),0===t.status?s("span",[e._v("（"+e._s(e.$t("offline"))+"）")]):e._e()]),e._v(" "),s("div",{staticClass:"p-detail"},[s("pre",{staticClass:"p-segment-text"},[e._v(e._s(e.fmtPolicyTextList(t)))])])])])})],2)]:[s("div",{staticClass:"s-m-w-c-p-wrapper",class:[{disabled:e.isSelectedReleaesUpcast}]},[e.tmpSignedPolicies.length?[s("div",{staticClass:"s-m-w-c-head"},[e.selectedRelease.contracts&&e.selectedRelease.contracts.length>0?s("div",{staticClass:"p-auth-info"},[s("div",[s("label",[e._v(e._s(e.$t("partyA"))+"：")]),e._v(" "),s("router-link",{attrs:{to:"/release/detail/"+e.selectedRelease.releaseId+"?version="+e.selectedRelease.latestVersion.version}},[e._v("\n                    "+e._s(e.selectedRelease.releaseName)+"\n                  ")])],1),e._v(" "),s("div",[s("label",[e._v(e._s(e.$t("partyB"))+"：")]),s("span",[e._v(e._s(e.release.releaseName))])])]):e._e()]),e._v(" "),s("h4",{staticClass:"s-m-w-c-p-title"},[e._v("\n              "+e._s("edit"!==e.type?e.$t("signedContracts"):e.$t("signStatus[0]"))+" \n              "),"edit"!==e.type?s("el-tooltip",{attrs:{placement:"right",content:e.$t("tips[2]")}},[s("i",{staticClass:"el-icon-info"})]):e._e()],1),e._v(" "),e._l(e.tmpSignedPolicies,function(t,a){return s("div",{key:"p-signed-"+a,staticClass:"s-m-w-c-policy",class:{offline:0===t.status&&!(e.contractsMap&&e.contractsMap[t.contractId]),disabled:!1===t.isEnbledContract}},[e.contractsMap&&e.contractsMap[t.contractId]?s("div",{staticClass:"smw-c-p-signed"},[s("div",{staticClass:"p-name",class:[e.type],on:{click:function(s){return e.selectPolicy(e.tmpSignedPolicies,t,a)}}},["edit"!==e.type?[t.isSelected?s("i",{staticClass:"el-icon-check"}):s("span",{staticClass:"p-n-check-box"})]:e._e(),e._v("\n                    "+e._s(t.policyName)+"\n                    "),s("span",{staticClass:"contract-status",class:["status-"+e.contractsMap[t.contractId].status]},[e._v(e._s(e.contractsMap[t.contractId].statusTip))]),e._v(" "),"edit"===e.type?s("el-dropdown",{staticClass:"p-enabled-btn",on:{command:e.toggleEnabledContract}},[s("span",[e._v(e._s(t.isEnbledContract?e.$t("policyStatus[0]"):e.$t("policyStatus[1]"))),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.isEnbledContract?s("el-dropdown-item",{attrs:{command:a+"-0"}},[e._v(e._s(e.$t("layAsideBtnText")))]):s("el-dropdown-item",{attrs:{command:a+"-1"}},[e._v(e._s(e.$t("applyBtnText")))])],1)],1):e._e()],2),e._v(" "),s("div",{staticClass:"p-auth-info"},[s("span",[e._v(e._s(e.$t("contractID"))+"："+e._s(t.contractId))]),e._v(" "),s("span",[e._v(e._s(e.$t("signingDate"))+"："+e._s(e._f("fmtDate")(e.contractsMap[t.contractId].updateDate)))])]),e._v(" "),s("div",{staticClass:"p-detail"},[s("contract-detail",{staticClass:"contract-policy-content",attrs:{contract:e.contractsMap[t.contractId],policyText:e.contractsMap[t.contractId].contractClause.policyText},on:{"update:contract":function(s){return e.$set(e.contractsMap,t.contractId,s)},"update-contract":e.updateContractAfterEvent}})],1)]):e._e()])})]:e._e(),e._v(" "),e.tmpNoSignedPolicies.length?[s("h4",{staticClass:"s-m-w-c-p-title"},[e._v(" "+e._s(e.isSelectedReleaesUpcast?e.$t("tips[0]"):e.$t("tips[1]"))+" ")]),e._v(" "),e._l(e.tmpNoSignedPolicies,function(t,a){return s("div",{key:"p-"+a,staticClass:"s-m-w-c-policy",class:{offline:0===t.status&&!(e.contractsMap&&e.contractsMap[t.contractId])}},[s("div",{staticClass:"smw-c-p-box"},[s("div",{staticClass:"p-name",class:[e.type],on:{click:function(s){return e.selectPolicy(e.tmpNoSignedPolicies,t,a)}}},["edit"!==e.type?[t.isSelected?s("i",{staticClass:"el-icon-check"}):s("span",{staticClass:"p-n-check-box"})]:e._e(),e._v("\n                  "+e._s(t.policyName)),0===t.status?s("span",[e._v("（"+e._s(e.$t("offline"))+"）")]):e._e(),e._v(" "),"edit"===e.type?s("div",{staticClass:"p-signed-btn",on:{click:function(s){return e.policySignImmediately(t)}}},[e._v(e._s(e.$t("signContractBtnText")))]):e._e()],2),e._v(" "),s("div",{staticClass:"p-detail"},[s("pre",{staticClass:"p-segment-text"},[e._v(e._s(e.fmtPolicyTextList(t)))])])])])})]:e._e()],2)]],2),e._v(" "),"create"===e.type?s("scheme-float-ball",{staticClass:"s-m-w-c-floatball",attrs:{selectedAuthSchemes:e.selectedAuthSchemes,upcastReleases:e.baseUpcastReleases}}):e._e()],1)])};a._withStripped=!0;var c=s(87),i=s.n(c),n=s(427),l=s.n(n),o=s(90),r=s(130),d=s(455),p=s(744),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isShow?s("div",{on:{click:function(e){e.stopPropagation()}}},[s("div",{staticClass:"float-ball",on:{click:e.toggleSchemeList}},[e.selectedAuthSchemes.length||e.upcastReleases.length?s("span",{staticClass:"float-count"},[e._v(e._s(e.selectedAuthSchemes.length+e.upcastReleases.length))]):s("span",{staticClass:"float-icon-list"},[s("span"),e._v(" "),s("span"),e._v(" "),s("span")])]),e._v(" "),e.isShowSchemeList?s("div",{staticClass:"float-list-box"},[e.selectedAuthSchemes.length?s("div",{staticClass:"selected-authschemes-box"},[s("h3",[e._v(e._s(e.$t("components.authScheme.selectedSchemesTitle")))]),e._v(" "),s("ul",e._l(e.selectedAuthSchemes,function(t,a){return s("li",{key:"selectedAuthScheme-"+a},[s("div",{staticClass:"float-lb-row-1"},[s("span",{staticClass:"s-a-b-name"},[e._v(e._s(t.releaseName))]),e._v(" "),e._l(t.selectedPolicies,function(t){return s("span",{staticClass:"s-a-b-policy-name"},[e._v(e._s(t.policyName))])})],2)])}),0)]):e._e(),e._v(" "),0===e.selectedAuthSchemes.length&&0===e.upcastReleases.length?s("p",[e._v(e._s(e.$t("components.authScheme.selectTip")))]):e._e(),e._v(" "),e.upcastReleases.length?s("div",{staticClass:"upcast-releases-box"},[s("h3",[e._v(e._s(e.$t("components.authScheme.unhandledListTitle")))]),e._v(" "),s("ul",e._l(e.upcastReleases,function(t,a){return s("li",{key:"upcastReleases-"+a},[s("div",{staticClass:"float-lb-row-1"},[s("i",{staticClass:"el-icon-top"}),e._v(e._s(t.releaseName))])])}),0)]):e._e()]):e._e()]):e._e()};u._withStripped=!0;var h={props:{isShow:{type:Boolean,default:!0},selectedAuthSchemes:Array,upcastReleases:Array},data:function(){return{isShowSchemeList:!1,isRegisterGlobalClickEvent:!1}},methods:{toggleSchemeList:function(){this.isShowSchemeList=!this.isShowSchemeList,this.isRegisterGlobalClickEvent||(this.isRegisterGlobalClickEvent=!0,document.addEventListener("click",this.hideSchemeList))},hideSchemeList:function(){this.isShowSchemeList&&(this.isShowSchemeList=!1)}}},f=(s(890),s(3)),v=Object(f.a)(h,u,[],!1,null,"c61f83dc",null);v.options.__file="src/components/Authorization-scheme/scheme-float-ball.vue";var m=v.exports,_={name:"scheme-manage",components:{ReleaseDependItem:p.a,SchemeFloatBall:m,ContractDetail:r.a},props:{type:{type:String,default:"create"},release:Object,releasesTreeData:Array,depReleasesList:{type:Array,default:function(){return[]}},depReleasesDetailList:{type:Array,default:function(){return[]}},baseUpcastReleases:{type:Array,default:function(){return[]}},contracts:{type:Array,default:function(){return[]}}},data:function(){return{isLoading:!1,activeSelectedIndex:0,isSelectedReleaesUpcast:!1,releasesMap:{},releaseIdNameMap:{},upcastDepReleasesMap:null,contractsMap:null,targetReleases:[],tmpSelectedPolicies:[],tmpSignedPolicies:[],tmpNoSignedPolicies:[],selectedAuthSchemes:[],contractIds:[],selectedRelease:{},releasesContractRecordsMap:{},selectedReleaseContractRecords:[],releaseScheme:null}},computed:{baseUpcastReleasesIDs:function(){return this.baseUpcastReleases.map(function(e){return e.releaseId})},projection:function(){return["releaseId","resourceType","releaseName","latestVersion","baseUpcastReleases","policies","updateDate"].join(",")}},watch:{releaseScheme:function(){this.getTargetReleases()},depReleasesDetailList:function(){this.getTargetReleases()},depReleasesList:function(e,t){this.initData()},contracts:function(){this.getContractsMap(this.contracts),this.getTargetReleases()},isSelectedReleaesUpcast:function(){this.upcastHandler()}},methods:{initData:function(){this.depReleasesList.length>0&&(this.isLoading=!0,this.release&&this.release.releaseId&&(this.releaseIdNameMap[this.release.releaseId]=this.release.releaseName),this.fetchDepReleases(),this.fetchReleaseScheme())},fetchDepReleases:function(){var e=this,t=this.depReleasesList.map(function(e){return e.releaseId}).join(",");this.fetchReleases(t).then(function(t){if(0===t.errcode){e.$emit("update:depReleasesDetailList",t.data||[]),e.selectedRelease=t.data[0]||{};var s=[];t.data.forEach(function(t){e.releasesMap[t.releaseId]=t,e.releaseIdNameMap[t.releaseId]=t.releaseName,t.baseUpcastReleases&&(s=[].concat(l()(s),l()(t.baseUpcastReleases.map(function(e){return e.releaseId}))))}),s.length>0?e.fetchUpcastDepReleases(s.join(",")):e.upcastDepReleasesMap={}}}).catch(function(t){console.log("e --",t),e.isLoading=!1})},fetchReleases:function(e){return this.$services.ReleaseService.get("list?releaseIds=".concat(e,"&projection=").concat(this.projection)).then(function(e){return e.data})},fetchUpcastDepReleases:function(e){var t=this;this.fetchReleases(e).then(function(e){if(0===e.errcode){var s=e.data||[];t.upcastDepReleasesMap={};for(var a=0;a<s.length;a++){var c=s[a].releaseId;t.upcastDepReleasesMap[c]=s[a],t.releaseIdNameMap[c]=s[a].releaseName,t.releasesMap[c]||(t.releasesMap[c]=s[a])}t.getTargetReleases()}}).catch(function(e){return t.isLoading=!1})},fetchReleaseScheme:function(){var e=this;if(this.release){var t=this.release,s=t.releaseId,a=t.latestVersion.version;a=this.release.selectedVersion||a,this.$services.ReleaseService.get("".concat(s,"/versions/").concat(a)).then(function(e){return e.data}).then(function(t){0===t.errcode&&(e.releaseScheme=t.data,e.fetchContractsDetail())}).catch(function(t){return e.$error.showErrorMessage("授权方案获取失败！")})}},fetchContractsDetail:function(){for(var e=this,t=this.releaseScheme.resolveReleases,s=t.map(function(e){return e.releaseId}).join(","),a=new Set([]),c=0;c<t.length;c++){t[c].contracts.forEach(function(e){e.contractId&&a.add(e.contractId)})}s.length>0?this.$services.ContractRecords.get({params:{targetIds:s,partyTwo:this.release.releaseId}}).then(function(e){return e.data}).then(function(t){if(0===t.errcode){var s=t.data;s.forEach(function(e){e.isEnbledContract=a.has(e.contractId)}),e.getContractsMap(s),e.$emit("update:contracts",s)}}):this.$emit("update:contracts",[])},getContractsMap:function(e){var t=this,s=this.contractsMap||{};e.forEach(function(e){e.partyOne=t.releaseIdNameMap[e.partyOne]||e.partyOne,e.partyTwo=t.releaseIdNameMap[e.partyTwo]||e.partyTwo,e.statusTip=d.CONTRACT_STATUS_TIPS[e.status],s[e.contractId]=e}),this.contractsMap=s},getTargetReleases:function(){var e=this;this.resolveReleaseScheme();for(var t=this.depReleasesDetailList.filter(function(e){return e.policies}),s=0;s<t.length;s++){var a=this.depReleasesDetailList[s];(a=this.formatRelease(a)).baseUpcastReleases=a.baseUpcastReleases.map(function(t){var s=e.releasesMap[t.releaseId];return s&&(t=e.formatRelease(s)),t})}this.resetData(),this.isLoading=!1},resolveReleaseScheme:function(){var e=this;if(this.releaseScheme)for(var t=this.releaseScheme.resolveReleases,s=function(s){var a=t[s],c=a.contracts,i=a.releaseId,n=e.releasesMap[i],l={};c.forEach(function(e){return l[e.policyId]=e.contractId}),e.contracts.forEach(function(e){var t=e.contractId;e.targetId===i&&(l[e.policyId]=t)}),n&&(n.contracts=c,n.resolveStatus="resolved",n.selectedPolicies=[],n.policies.forEach(function(t){var s=l[t.policyId];void 0!==s?(t.isSelected=!0,t.isEnbledContract=e.contractsMap&&e.contractsMap[s].isEnbledContract,t.contractId=s,t.hasContract=1,n.selectedPolicies.push(t)):t.hasContract=-1}))},a=0;a<t.length;a++)s(a)},getReleaseSelectedPolicies:function(e){},formatRelease:function(e){return-1!==this.baseUpcastReleasesIDs.indexOf(e.releaseId)?e.isUpcasted=!0:e.isUpcasted=!1,this.initReleaseResolveStatus(e),e.selectedPolicies=e.selectedPolicies||[],e.policies=e.policies.map(function(e){return e.isSelected=void 0!==e.isSelected&&e.isSelected,e}),e},initReleaseResolveStatus:function(e){switch(this.type){case"create":e.resolveStatus="no-resolve";break;case"add":case"edit":e.resolveStatus=e.resolveStatus?e.resolveStatus:e.isUpcasted?"upcast":"no-resolve"}},resetData:function(){this.tmpSelectedPolicies=this.selectedRelease.policies;var e=this.tmpSelectedPolicies&&this.tmpSelectedPolicies.length;if(e){for(var t=[],s=[],a=0;a<e;a++){var c=this.tmpSelectedPolicies[a];1===c.hasContract?t.push(c):s.push(c)}this.tmpSignedPolicies=t,this.tmpNoSignedPolicies=s}this.isSelectedReleaesUpcast=this.selectedRelease.isUpcasted,this.selectedRelease.resolveStatus=this.getReleaseResolveStatus(),this.resolveSelectedAuthSchemes()},getReleaseResolveStatus:function(){return this.selectedRelease.isUpcasted?"upcast":this.selectedRelease.selectedPolicies&&this.selectedRelease.selectedPolicies.length>0?"resolved":"no-resolve"},resolveSelectedAuthSchemes:function(){for(var e=[],t=this.depReleasesDetailList,s={},a=0;a<t.length;a++){var c=t[a];"resolved"===c.resolveStatus&&1!==s[c.releaseId]&&(s[c.releaseId]=1,e.push(c)),c.baseUpcastReleases&&c.baseUpcastReleases.forEach(function(t){"resolved"===t.resolveStatus&&1!==s[t.releaseId]&&(s[t.releaseId]=1,e.push(t))})}this.selectedAuthSchemes=e;var i=this.selectedAuthSchemes.map(function(e){return{releaseId:e.releaseId,contracts:e.policies.filter(function(e){return null==e.isEnbledContract?e.isSelected||e.isSigned:e.isEnbledContract}).map(function(e){return{policyId:e.policyId}})}});this.$emit("update-resolved-releases",i)},updateContractAfterEvent:function(){},fmtPolicyTextList:function(e){return Object(o.a)(e.policyText)},upcastHandler:function(){this.selectedRelease.isUpcasted=this.isSelectedReleaesUpcast,this.resetData(),this.selectedRelease.isUpcasted?this.toggleBaseUpcastReleases(this.selectedRelease,"add"):this.toggleBaseUpcastReleases(this.selectedRelease,"delete"),this.$emit("update:baseUpcastReleases",this.baseUpcastReleases)},exchangeSelectedRelease:function(e){this.selectedRelease=e,this.resetData()},toggleEnabledContract:function(e){var t=e.split("-"),s=i()(t,2),a=s[0],c=s[1],n=this.tmpSignedPolicies[a];if(0==+c){if(!n.isEnbledContract)return;n.isEnbledContract=!1;for(var l=this.selectedRelease.policies,o=l.length,r=0,d=0;d<o;d++)l[d].isEnbledContract&&(r+=1);if(0===r)return this.$message({type:"warning",message:"至少须应用一个合同！"}),void(n.isEnbledContract=!0)}else{if(n.isEnbledContract)return;n.isEnbledContract=!0}this.resetData(),this.$emit("update-release-scheme",n.isEnbledContract?"合同应用成功！":"合同搁置成功！")},policySignImmediately:function(e){e.isSigned=!0,this.resetData(),this.$emit("policy-sign-immediately")},selectPolicy:function(e,t,s){"edit"!==this.type&&(t.isSelected=!t.isSelected,t.isSelected?this.togglePolicy(this.selectedRelease.selectedPolicies,t,"add"):this.togglePolicy(this.selectedRelease.selectedPolicies,t,"delete"),this.resetData())},togglePolicy:function(e,t,s){this.toggleArrayItem(s,e,t,function(e,t){return e.policyId===t.policyId})},toggleArrayItem:function(e,t,s,a){for(var c=-1,i=0;i<t.length;i++)if(a(s,t[i])){c=i;break}switch(e){case"add":-1===c&&t.push(s);break;case"delete":-1!==c&&t.splice(c,1)}},toggleBaseUpcastReleases:function(e,t){var s=this.baseUpcastReleases;this.toggleArrayItem(t,s,e,function(e,t){return e.releaseId===t.releaseId})}},created:function(){this.initData()}},g=(s(891),s(892),s(893)),S=Object(f.a)(_,a,[],!1,null,"333d340a",null);"function"==typeof g.default&&Object(g.default)(S),S.options.__file="src/views/release/scheme/index.vue";t.a=S.exports},656:function(e,t,s){},657:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"upcast":"上抛","signContractBtnText":"签约","applyBtnText":"应用","layAsideBtnText":"搁置","offline":"已下线","signedContracts":"历史合约","contractID":"合同ID","signingDate":"签约时间","detail":"详情","partyA":"授权方","partyB":"被授权方","policyStatus":["已应用","已搁置"],"signStatus":["已签约"],"contractStatus":["执行中","生效中","合同终止","上抛"],"tips":["该发行已上抛","以下策略可进行新的签约","此发行存在历史签约，可直接使用"],"messages":[""]},"en":{"upcast":"Upcast","signContractBtnText":"Sign contract","applyBtnText":"apply","layAsideBtnText":"lay aside","offline":"Already offline","signedContracts":"Signed contracts","contractID":"Contract ID","signingDate":"Signing Date","detail":"detail","partyA":"Party A","partyB":"Party B","policyStatus":["Already applied","Already lay aside"],"signStatus":["Already signed"],"contractStatus":["Executing","In effect","Termination of contract","Upcast"],"tips":["The release has been upcasted","The following policies are available for new signings","This issue has a historical contract and can be used directly."],"messages":[""]}}'),delete e.options._Ctor}},658:function(e,t,s){},659:function(e,t,s){},660:function(e,t,s){},661:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-CN":{"upcast":"上抛","signContractBtnText":"签约","applyBtnText":"应用","layAsideBtnText":"搁置","offline":"已下线","signedContracts":"历史合约","contractID":"合同ID","signingDate":"签约时间","detail":"详情","partyA":"授权方","partyB":"被授权方","policyStatus":["已应用","已搁置"],"signStatus":["已签约"],"contractStatus":["执行中","生效中","合同终止","上抛"],"tips":["该发行已上抛","以下策略可进行新的签约","此发行存在历史签约，可直接使用"],"messages":[""]},"en":{"upcast":"Upcast","signContractBtnText":"Sign contract","applyBtnText":"apply","layAsideBtnText":"lay aside","offline":"Already offline","signedContracts":"Signed contracts","contractID":"Contract ID","signingDate":"Signing Date","detail":"detail","partyA":"Party A","partyB":"Party B","policyStatus":["Already applied","Already lay aside"],"signStatus":["Already signed"],"contractStatus":["Executing","In effect","Termination of contract","Upcast"],"tips":["The release has been upcasted","The following policies are available for new signings","This issue has a historical contract and can be used directly."],"messages":[""]}}'),delete e.options._Ctor}},744:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"r-dependencies-item",class:{"second-level":e.isScondLevel,active:e.isActive},on:{click:function(t){return e.exchangeSelectedRelease(e.release)}}},[s("div",{staticClass:"r-item-cont"},[s("p",{staticClass:"r-name",class:[e.resolveStatus]},[e.hideUpcastIcon?e._e():s("i",{staticClass:"el-icon-top"}),e._v("\n      "+e._s(e.release.releaseName)+"\n      "),e.release&&e.release.latestVersion?s("router-link",{attrs:{to:"/release/detail/"+e.release.releaseId+"?version="+e.release.latestVersion.version,target:"_blank"}},[e._v("\n        "+e._s(e.$t("detail"))+"\n      ")]):e._e()],1),e._v(" "),s("div",{staticClass:"r-info"},[s("span",[e._v(e._s(e._f("pageBuildFilter")(e.release.resourceType)))]),e._v(" "),s("span",[e._v(e._s(e.release.latestVersion&&e.release.latestVersion.version))]),e._v(" "),s("span",[e._v(e._s(e._f("fmtDate")(e.release.updateDate)))])]),e._v(" "),s("div",{staticClass:"r-policies"},[e.release.isUpcasted?e._e():e._l(e.selectedPolicies,function(t,a){return s("div",{key:"s-policy-"+a,staticClass:"r-p-item",class:{disabled:t.contractId&&!1===t.isEnbledContract,isHasContract:!!t.contractId}},[e._v("\n          "+e._s(t.policyName)+"\n          "),e.contractsMap&&e.contractsMap[t.contractId]?s("span",{class:["contract-status","status-"+e.contractsMap[t.contractId].status]}):e._e()])})],2)])])};a._withStripped=!0;var c={name:"depend-item",props:{contractsMap:Object,release:Object,resolveStatus:String,isScondLevel:Boolean,isActive:Boolean,hideUpcastIcon:{type:Boolean,default:!1}},data:function(){return{selectedPolicies:this.release.selectedPolicies}},updated:function(){this.selectedPolicies=this.release.selectedPolicies},methods:{exchangeSelectedRelease:function(e){this.$emit("exchange-item",e)}}},i=(s(888),s(3)),n=s(889),l=Object(i.a)(c,a,[],!1,null,"820327e8",null);"function"==typeof n.default&&Object(n.default)(l),l.options.__file="src/views/release/scheme/depend-item.vue";t.a=l.exports},888:function(e,t,s){"use strict";var a=s(656);s.n(a).a},889:function(e,t,s){"use strict";var a=s(657),c=s.n(a);t.default=c.a},890:function(e,t,s){"use strict";var a=s(658);s.n(a).a},891:function(e,t,s){"use strict";var a=s(659);s.n(a).a},892:function(e,t,s){"use strict";var a=s(660);s.n(a).a},893:function(e,t,s){"use strict";var a=s(661),c=s.n(a);t.default=c.a}}]);