(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["freelog-waterfall-app"]=t():e["freelog-waterfall-app"]=t()})(window,(function(){return function(e){function t(t){for(var o,a,s=t[0],c=t[1],u=t[2],f=0,p=[];f<s.length;f++)a=s[f],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&p.push(r[a][0]),r[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);l&&l(t);while(p.length)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(o=!1)}o&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={app:0},i=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var s=window["webpackJsonp_freelog-waterfall"]=window["webpackJsonp_freelog-waterfall"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;return i.push([0,"chunk-vendors"]),n()}({0:function(e,t,n){e.exports=n("56d7")},"029b":function(e,t,n){"use strict";n("a257")},"03c7":function(e,t,n){},2395:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t),n.d(t,"bootstrap",(function(){return F})),n.d(t,"mount",(function(){return N})),n.d(t,"unmount",(function(){return W}));var o=n("1da1"),r=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("96cf"),n("b0c0"),n("2b0e")),i=n("9483");Object(i["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var a=n("8c4f"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"water-picture"},[n("div",{staticClass:"water-picture-container"},e._l(Array(e.columns),(function(t,o){return n("div",{key:o,ref:"ref"+o,refInFor:!0,staticClass:"water-picture-container__column"},e._l(e.dataSource[o],(function(t){return n("Card",{key:t.index,attrs:{title:t.title,src:t.src},on:{onload:e.pushData,preview:function(n){return e.openLightBox(t.title)}}})})),1)})),0),e.showLightBox?n("LightBox",{attrs:{images:e.images,startAt:e.startAt}}):e._e(),n("div",{ref:"loadingRef",staticClass:"water-picture__loading"},[e._v(" "+e._s(2===e.loading&&0===this.bufferList.length?"别扯了，我也是有底线的~":"正在加载中...")+" ")])],1)},c=[],u=n("2909"),l=(n("d81d"),n("cb29"),n("99af"),n("c740"),n("d3b7"),n("159b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card"},[n("div",[n("img",{staticStyle:{"min-height":"170px"},attrs:{src:e.src},on:{load:function(t){return e.$emit("onload")}}}),n("div",{staticStyle:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},[e._v(e._s(e.title))])]),n("div",{on:{click:function(t){return e.$emit("preview")}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showCopyDone,expression:"showCopyDone"}],staticStyle:{"line-height":"40px",padding:"0 15px","background-color":"rgba(103,194,58,.8)",color:"#fff","border-radius":"8px"}},[e._v("复制成功 ")]),n("button",{staticStyle:{display:"inline-block","line-height":"28px",padding:"0 10px","border-radius":"14px",position:"absolute",bottom:"45px",right:"10px","background-color":"#4497ec","font-size":"12px",color:"#fff",cursor:"pointer",border:"none",outline:"none"},on:{click:e.doCopy}},[e._v("复制发行名称 ")])])])}),f=[],p={name:"Card",props:{title:{type:String,default:""},src:{type:String,default:""},resourceID:{type:String,default:""}},data:function(){return{showCopyDone:!1}},mounted:function(){},methods:{doCopy:function(e){var t=this;e.stopPropagation(),this.$copyText(this.title).then((function(){t.showCopyDone=!0,setTimeout((function(){return t.showCopyDone=!1}),1e3)}),(function(e){alert("Can not copy"),console.log(e)}))}}},d=p,h=(n("89bc"),n("2877")),g=Object(h["a"])(d,l,f,!1,null,"330ea85c",null),m=g.exports,w=n("1c09"),v=n.n(w),b={name:"home-page",components:{Card:m,LightBox:v.a},data:function(){return{page:0,bufferList:[],columns:Math.floor(window.innerWidth/250),dataSource:[],loading:0,images:[],showLightBox:!1,startAt:0}},mounted:function(){var e=this;this.init(),window.onscroll=function(){e.$refs.loadingRef.getBoundingClientRect().top<=1.5*window.innerHeight&&e.fillBufferList()}},methods:{init:function(){var e=this;this.dataSource=Array(this.columns).fill(null).map((function(){return[]})),setTimeout((function(){e.fillBufferList()}))},fillBufferList:function(){var e=this;1!==this.loading&&2!==this.loading&&(this.page++,this.loading=1,y(this.page).then((function(t){console.log("result ---",t),e.bufferList=t.dataList,e.images=[].concat(Object(u["a"])(e.images),Object(u["a"])(t.dataList.map((function(e){return{thumb:e.src,src:e.src,caption:e.title,srcset:e.src}})))),console.log(t,e.images),t.done&&(e.loading=2),e.pushData()})))},pushData:function(){if(0===this.bufferList.length){if(2===this.loading)return;return this.loading=0,void(this.$refs.loadingRef.getBoundingClientRect().top<=1.5*window.innerHeight&&this.fillBufferList())}var e=this.bufferList.shift();this.dataSource[this.getMinHeightColumnsIndex()].push(e)},getMinHeightColumnsIndex:function(){var e=this,t=Array(this.columns).fill(-1).map((function(t,n){return e.$refs["ref"+n][0].getBoundingClientRect().height}));return t.indexOf(Math.min.apply(Math,t))},openLightBox:function(e){var t=this;this.showLightBox=!1,this.startAt=this.images.findIndex((function(t){return t.caption===e})),setTimeout((function(){return t.showLightBox=!0}))},closeLightBox:function(){this.showLightBox=!1}},computed:{}};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=10;return new Promise((function(n){window.freelogApp.getPresentables({skip:(e-1)*t,limit:t,resourceType:"image"}).then(function(){var r=Object(o["a"])(regeneratorRuntime.mark((function r(i){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:console.log(i),a=[],i.data.data.dataList.forEach(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,n){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,window.freelogApp.getFileStreamById(t.presentableId,!0);case 2:o=e.sent,console.log(o,{title:t.presentableName,src:o,index:n}),a.push({title:t.presentableName,src:o,index:n});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),n({dataList:a,done:(e-1)*t+t>i.data.data.totalItem});case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}))}var x=b,_=(n("029b"),Object(h["a"])(x,s,c,!1,null,"0dad3596",null)),L=_.exports;r["a"].use(a["a"]);var O=[{path:"/",name:"Home",component:L}],C=new a["a"]({mode:"history",base:"/",routes:O}),S=C,j=n("2f62");r["a"].use(j["a"]);var B=new j["a"].Store({state:{},mutations:{},actions:{},modules:{}}),k=n("caf9"),R=n("4eb5"),E=n.n(R),P=(n("83f4"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view"),n("div",{attrs:{id:"freelog-60534c84328c040039779206"}}),n("div",{attrs:{id:"freelog-60535428328c040039779209"}}),n("div",{attrs:{id:"freelog-60535628328c04003977920b"}})],1)}),A=[],D=(n("7c55"),{}),T=Object(h["a"])(D,P,A,!1,null,null,null),$=T.exports;r["a"].config.productionTip=!1,n("6e25"),r["a"].use(k["a"]),r["a"].use(E.a),r["a"].config.productionTip=!1;var I=null;function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.container;I=new r["a"]({router:S,store:B,render:function(e){return e($)}}).$mount(t?t.querySelector("#app"):"#app")}function G(e){e.onGlobalStateChange&&e.onGlobalStateChange((function(t,n){return console.log("[onGlobalStateChange - ".concat(e.name,"]:"),t,n)}),!0),e.setGlobalState&&e.setGlobalState({ignore:e.name,user:{name:e.name}})}function F(){return H.apply(this,arguments)}function H(){return H=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("[vue] vue app bootstraped");case 1:case"end":return e.stop()}}),e)}))),H.apply(this,arguments)}function N(e){return J.apply(this,arguments)}function J(){return J=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("[vue] props from main framework",t),G(t),M(t);case 3:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}function W(){return Y.apply(this,arguments)}function Y(){return Y=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:I.$destroy(),I.$el.innerHTML="",I=null,router=null;case 4:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}window.__POWERED_BY_FREELOG__||M()},"7c55":function(e,t,n){"use strict";n("2395")},"83f4":function(e,t,n){window.__POWERED_BY_FREELOG__&&(n.p=window.__INJECTED_PUBLIC_PATH_BY_FREELOG__)},"89bc":function(e,t,n){"use strict";n("03c7")},a257:function(e,t,n){}})}));
//# sourceMappingURL=app.d6c95d1f.js.map